<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>RNA-Seq_A-to-I</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">RNA-Seq_A-to-I</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(VeloRM)</span></code></pre></div>
<div id="rna-seq-a-to-i-velocity-pipeline" class="section level2">
<h2>RNA-seq A-to-I velocity pipeline</h2>
<div id="data-download" class="section level3">
<h3>data download</h3>
<p><a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE99933" class="uri">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE99933</a>
### alignment</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">### trim</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># Extract SRR numbers into an array (skip the header line)</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="va">srr_list</span><span class="op">=</span><span class="va">($(</span><span class="fu">find</span> /gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR <span class="at">-maxdepth</span> 1 <span class="at">-type</span> d <span class="at">-name</span> <span class="st">&quot;*SRR*&quot;</span> <span class="at">-exec</span> basename {} <span class="dt">\;</span><span class="va">))</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># Check the extraction results</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Found </span><span class="va">${</span><span class="op">#</span><span class="va">srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st"> SRR samples:&quot;</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="bu">printf</span> <span class="st">&quot;%s\n&quot;</span> <span class="st">&quot;</span><span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co"># alignment</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co"># Base directories</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="va">input_base</span><span class="op">=</span><span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR&quot;</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="va">output_base</span><span class="op">=</span><span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR&quot;</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co"># Run trim_galore for each SRR sample</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>    <span class="co"># Input FASTQ file (assuming it&#39;s in ${input_base}/${srr}/${srr}.fastq)</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>    <span class="co"># Run trim_galore (single-end mode)</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>    <span class="ex">trim_galore</span> <span class="dt">\</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>        <span class="at">--output_dir</span> <span class="st">&quot;</span><span class="va">${output_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>        <span class="at">--basename</span> <span class="st">&quot;</span><span class="va">${srr}</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>        <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">.fastq&quot;</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">### STAR build index</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co">### STAR align</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span> </span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a>    <span class="ex">STAR</span> <span class="at">--runThreadN</span> 1 <span class="at">--outSAMtype</span> BAM Unsorted<span class="dt">\</span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>    <span class="at">--readFilesIn</span> <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_trimmed.fq&quot;</span><span class="dt">\</span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a>    <span class="at">--genomeDir</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39/star_indx<span class="dt">\</span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a>    <span class="at">--sjdbGTFfile</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39/mm39.knownGene.gtf<span class="dt">\</span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a>    <span class="at">--outFileNamePrefix</span> <span class="st">&quot;</span><span class="va">${output_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">&quot;</span><span class="dt">\</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a>    <span class="at">--outSAMattributes</span> All <span class="at">--outSAMunmapped</span> Within<span class="dt">\</span></span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a>    <span class="at">--sjdbOverhang</span> 150 <span class="op">&gt;</span> <span class="st">&quot;</span><span class="va">${output_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">.log&quot;</span></span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a></span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a><span class="co">###  sort</span></span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a></span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a><span class="co"># Base directories</span></span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a><span class="va">input_base</span><span class="op">=</span><span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR&quot;</span></span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a><span class="va">output_base</span><span class="op">=</span><span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR&quot;</span></span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a></span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a></span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb2-55"><a href="#cb2-55" tabindex="-1"></a>    <span class="ex">samtools</span> sort <span class="at">-@</span> 1 <span class="at">-o</span> <span class="st">&quot;</span><span class="va">${output_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_sorted.bam&quot;</span> <span class="st">&quot;</span><span class="va">${output_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">Aligned.out.bam&quot;</span></span>
<span id="cb2-56"><a href="#cb2-56" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb2-57"><a href="#cb2-57" tabindex="-1"></a></span>
<span id="cb2-58"><a href="#cb2-58" tabindex="-1"></a></span>
<span id="cb2-59"><a href="#cb2-59" tabindex="-1"></a></span>
<span id="cb2-60"><a href="#cb2-60" tabindex="-1"></a><span class="co">### filter above mapQ30</span></span>
<span id="cb2-61"><a href="#cb2-61" tabindex="-1"></a></span>
<span id="cb2-62"><a href="#cb2-62" tabindex="-1"></a></span>
<span id="cb2-63"><a href="#cb2-63" tabindex="-1"></a></span>
<span id="cb2-64"><a href="#cb2-64" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb2-65"><a href="#cb2-65" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb2-66"><a href="#cb2-66" tabindex="-1"></a>    <span class="ex">samtools</span> view <span class="at">-h</span> <span class="at">-b</span> <span class="at">-q</span> 30 <span class="dt">\</span></span>
<span id="cb2-67"><a href="#cb2-67" tabindex="-1"></a>    <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_sorted.bam&quot;</span> <span class="dt">\</span></span>
<span id="cb2-68"><a href="#cb2-68" tabindex="-1"></a>        <span class="at">-o</span> <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_above.mapQ30.bam&quot;</span></span>
<span id="cb2-69"><a href="#cb2-69" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
</div>
<div id="divide-bam" class="section level3">
<h3>divide bam</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">############ bedtools to divide the bam file</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">###### File prepare</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">## get exon-no-ambiguity bed by substract (exon.bed - intron.bed = exon-na.bed)</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="ex">bedtools</span> subtract <span class="at">-a</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39_bed/UCSC_Exons_mm39.bed <span class="at">-b</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39_bed/UCSC_Introns_mm39.bed <span class="op">&gt;</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39_bed/exon-na.bed</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">## get intron-no-ambituity bed by subtract (inton.bed - exon.bed = inron-na.bed)</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="ex">bedtools</span> subtract <span class="at">-a</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39_bed/UCSC_Introns_mm39.bed <span class="at">-b</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39_bed/UCSC_Exons_mm39.bed <span class="op">&gt;</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39_bed/intron-na.bed</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co"># Extract SRR numbers into an array (skip the header line)</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="va">srr_list</span><span class="op">=</span><span class="va">($(</span><span class="fu">find</span> /gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR <span class="at">-maxdepth</span> 1 <span class="at">-type</span> d <span class="at">-name</span> <span class="st">&quot;SRR*&quot;</span> ! <span class="at">-name</span> <span class="st">&quot;SRR&quot;</span> <span class="at">-exec</span> basename {} <span class="dt">\;</span><span class="va">))</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co"># Check the extraction results</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Found </span><span class="va">${</span><span class="op">#</span><span class="va">srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st"> SRR samples:&quot;</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="bu">printf</span> <span class="st">&quot;%s\n&quot;</span> <span class="st">&quot;</span><span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="co"># Base directories</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="va">input_base</span><span class="op">=</span><span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR&quot;</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="va">output_base</span><span class="op">=</span><span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR&quot;</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="co">#### mRNA.bam</span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a>    <span class="ex">bedtools</span> intersect <span class="at">-a</span> <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_above.mapQ30.bam&quot;</span><span class="dt">\</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a>    <span class="at">-b</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39_bed/UCSC_Introns.bed<span class="dt">\</span></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a>    <span class="at">-v</span> <span class="at">-wa</span> <span class="at">-split</span> <span class="op">&gt;</span> <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_mRNA_temp.bam&quot;</span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a>    <span class="ex">bedtools</span> intersect <span class="at">-a</span> <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_mRNA_temp.bam&quot;</span><span class="dt">\</span></span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a>    <span class="at">-b</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39_bed/UCSC_Exons.bed<span class="dt">\</span></span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a>    <span class="at">-wa</span> <span class="at">-split</span> <span class="op">&gt;</span> <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_mRNA.bam&quot;</span></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a>    <span class="ex">samtools</span> index <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_mRNA.bam&quot;</span></span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a>  </span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a> <span class="co">#### mRNA_spliced.bam</span></span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a></span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a>    <span class="ex">samtools</span> view <span class="at">-h</span> <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_mRNA.bam&quot;</span><span class="dt">\</span></span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a>    <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;$0 ~ /^@/ || $6 ~ /N/&#39;</span> <span class="kw">|</span> <span class="ex">samtools</span> view <span class="at">-b</span> <span class="op">&gt;</span><span class="dt">\</span></span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a>    <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_mRNA_spliced.bam&quot;</span></span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a>    <span class="ex">samtools</span> index <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_mRNA_spliced.bam&quot;</span></span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a></span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a>  </span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a>  <span class="co">#### pre-mRNA.bam</span></span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a></span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a>    <span class="ex">bedtools</span> intersect <span class="at">-a</span> <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_above.mapQ30.bam&quot;</span><span class="dt">\</span></span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a>    <span class="at">-b</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39_bed/intron-na.bed<span class="dt">\</span></span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a>    <span class="at">-wa</span> <span class="at">-split</span> <span class="op">&gt;</span> <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_pre-mRNA.bam&quot;</span></span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a>    <span class="ex">samtools</span> index <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_pre-mRNA.bam&quot;</span></span>
<span id="cb3-62"><a href="#cb3-62" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb3-63"><a href="#cb3-63" tabindex="-1"></a></span>
<span id="cb3-64"><a href="#cb3-64" tabindex="-1"></a>  </span>
<span id="cb3-65"><a href="#cb3-65" tabindex="-1"></a>  <span class="co">#### isoform-a.bam</span></span>
<span id="cb3-66"><a href="#cb3-66" tabindex="-1"></a></span>
<span id="cb3-67"><a href="#cb3-67" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb3-68"><a href="#cb3-68" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb3-69"><a href="#cb3-69" tabindex="-1"></a>    <span class="ex">bedtools</span> intersect <span class="at">-a</span> <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_above.mapQ30.bam&quot;</span><span class="dt">\</span></span>
<span id="cb3-70"><a href="#cb3-70" tabindex="-1"></a>    <span class="at">-b</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39_bed/UCSC_Introns.bed<span class="dt">\</span></span>
<span id="cb3-71"><a href="#cb3-71" tabindex="-1"></a>    <span class="at">-wa</span> <span class="at">-split</span> <span class="op">&gt;</span> <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_maybe_pre_mRNA.bam&quot;</span></span>
<span id="cb3-72"><a href="#cb3-72" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb3-73"><a href="#cb3-73" tabindex="-1"></a></span>
<span id="cb3-74"><a href="#cb3-74" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb3-75"><a href="#cb3-75" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb3-76"><a href="#cb3-76" tabindex="-1"></a>    <span class="ex">bedtools</span> intersect <span class="at">-a</span> <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_maybe_pre_mRNA.bam&quot;</span><span class="dt">\</span></span>
<span id="cb3-77"><a href="#cb3-77" tabindex="-1"></a>    <span class="at">-b</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39_bed/intron-na.bed<span class="dt">\</span></span>
<span id="cb3-78"><a href="#cb3-78" tabindex="-1"></a>    <span class="at">-v</span> <span class="at">-wa</span> <span class="at">-split</span> <span class="op">&gt;</span> <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_isoform-a.bam&quot;</span></span>
<span id="cb3-79"><a href="#cb3-79" tabindex="-1"></a>    <span class="ex">samtools</span> index <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_isoform-a.bam&quot;</span></span>
<span id="cb3-80"><a href="#cb3-80" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb3-81"><a href="#cb3-81" tabindex="-1"></a></span>
<span id="cb3-82"><a href="#cb3-82" tabindex="-1"></a></span>
<span id="cb3-83"><a href="#cb3-83" tabindex="-1"></a><span class="co">#### we can also do further to clean the splicing reads missing classify to ambiguous and pre-mRNA, and merge the splicing reads to mRNA.</span></span>
<span id="cb3-84"><a href="#cb3-84" tabindex="-1"></a>  </span>
<span id="cb3-85"><a href="#cb3-85" tabindex="-1"></a>  </span>
<span id="cb3-86"><a href="#cb3-86" tabindex="-1"></a><span class="co">#  for srr in &quot;${srr_list[@]}&quot;; do</span></span>
<span id="cb3-87"><a href="#cb3-87" tabindex="-1"></a><span class="co">#    echo &quot;Processing sample: $srr&quot;</span></span>
<span id="cb3-88"><a href="#cb3-88" tabindex="-1"></a><span class="co">#    samtools view -h &quot;${input_base}/${srr}/${srr}_pre-mRNA.bam&quot;\</span></span>
<span id="cb3-89"><a href="#cb3-89" tabindex="-1"></a><span class="co">#    | awk &#39;$0 ~ /^@/ || $6 ~ /N/&#39; | samtools view -b &gt;\</span></span>
<span id="cb3-90"><a href="#cb3-90" tabindex="-1"></a><span class="co">#    &quot;${input_base}/${srr}/${srr}_pre-mRNA_spliced.bam&quot;</span></span>
<span id="cb3-91"><a href="#cb3-91" tabindex="-1"></a><span class="co">#    samtools index &quot;${input_base}/${srr}/${srr}_pre-mRNA_spliced.bam&quot;</span></span>
<span id="cb3-92"><a href="#cb3-92" tabindex="-1"></a><span class="co">#  done</span></span>
<span id="cb3-93"><a href="#cb3-93" tabindex="-1"></a>  </span>
<span id="cb3-94"><a href="#cb3-94" tabindex="-1"></a><span class="co">#  for srr in &quot;${srr_list[@]}&quot;; do</span></span>
<span id="cb3-95"><a href="#cb3-95" tabindex="-1"></a><span class="co">#    echo &quot;Processing sample: $srr&quot;</span></span>
<span id="cb3-96"><a href="#cb3-96" tabindex="-1"></a><span class="co">#    samtools view -h &quot;${input_base}/${srr}/${srr}_isoform-a.bam&quot;\</span></span>
<span id="cb3-97"><a href="#cb3-97" tabindex="-1"></a><span class="co">#    | awk &#39;$0 ~ /^@/ || $6 ~ /N/&#39; | samtools view -b &gt;\</span></span>
<span id="cb3-98"><a href="#cb3-98" tabindex="-1"></a><span class="co">#    &quot;${input_base}/${srr}/${srr}_isoform-a_spliced.bam&quot;</span></span>
<span id="cb3-99"><a href="#cb3-99" tabindex="-1"></a><span class="co">#    samtools index &quot;${input_base}/${srr}/${srr}_isoform-a_spliced.bam&quot;</span></span>
<span id="cb3-100"><a href="#cb3-100" tabindex="-1"></a><span class="co">#  done</span></span>
<span id="cb3-101"><a href="#cb3-101" tabindex="-1"></a>  </span>
<span id="cb3-102"><a href="#cb3-102" tabindex="-1"></a>  </span>
<span id="cb3-103"><a href="#cb3-103" tabindex="-1"></a><span class="co">#  for srr in &quot;${srr_list[@]}&quot;; do</span></span>
<span id="cb3-104"><a href="#cb3-104" tabindex="-1"></a><span class="co">#    echo &quot;Processing sample: $srr&quot;</span></span>
<span id="cb3-105"><a href="#cb3-105" tabindex="-1"></a><span class="co">#    bedtools subtract -a &quot;${input_base}/${srr}/${srr}_pre-mRNA.bam&quot;\</span></span>
<span id="cb3-106"><a href="#cb3-106" tabindex="-1"></a><span class="co">#     -b &quot;${input_base}/${srr}/${srr}_pre-mRNA_spliced.bam&quot;\</span></span>
<span id="cb3-107"><a href="#cb3-107" tabindex="-1"></a><span class="co">#      &gt; &quot;${input_base}/${srr}/${srr}_pre-mRNA_clean.bam&quot;</span></span>
<span id="cb3-108"><a href="#cb3-108" tabindex="-1"></a><span class="co">#  done</span></span>
<span id="cb3-109"><a href="#cb3-109" tabindex="-1"></a>  </span>
<span id="cb3-110"><a href="#cb3-110" tabindex="-1"></a><span class="co">#  for srr in &quot;${srr_list[@]}&quot;; do</span></span>
<span id="cb3-111"><a href="#cb3-111" tabindex="-1"></a><span class="co">#    echo &quot;Processing sample: $srr&quot;</span></span>
<span id="cb3-112"><a href="#cb3-112" tabindex="-1"></a><span class="co">#    bedtools subtract -a &quot;${input_base}/${srr}/${srr}_isoform-a.bam&quot;\</span></span>
<span id="cb3-113"><a href="#cb3-113" tabindex="-1"></a><span class="co">#     -b &quot;${input_base}/${srr}/${srr}_isoform-a_spliced.bam&quot;\</span></span>
<span id="cb3-114"><a href="#cb3-114" tabindex="-1"></a><span class="co">#      &gt; &quot;${input_base}/${srr}/${srr}_isoform-a_clean.bam&quot;</span></span>
<span id="cb3-115"><a href="#cb3-115" tabindex="-1"></a><span class="co">#  done</span></span>
<span id="cb3-116"><a href="#cb3-116" tabindex="-1"></a>  </span>
<span id="cb3-117"><a href="#cb3-117" tabindex="-1"></a><span class="co">#  for srr in &quot;${srr_list[@]}&quot;; do</span></span>
<span id="cb3-118"><a href="#cb3-118" tabindex="-1"></a><span class="co">#    echo &quot;Processing sample: $srr&quot;</span></span>
<span id="cb3-119"><a href="#cb3-119" tabindex="-1"></a><span class="co">#    samtools merge &quot;${input_base}/${srr}/${srr}_mRNA_spliced_combine.bam&quot;\</span></span>
<span id="cb3-120"><a href="#cb3-120" tabindex="-1"></a><span class="co">#     &quot;${input_base}/${srr}/${srr}_pre-mRNA_spliced.bam&quot;\</span></span>
<span id="cb3-121"><a href="#cb3-121" tabindex="-1"></a><span class="co">#     &quot;${input_base}/${srr}/${srr}_isoform-a_spliced.bam&quot;\</span></span>
<span id="cb3-122"><a href="#cb3-122" tabindex="-1"></a><span class="co">#     &quot;${input_base}/${srr}/${srr}_mRNA_spliced.bam&quot;</span></span>
<span id="cb3-123"><a href="#cb3-123" tabindex="-1"></a><span class="co">#  done</span></span></code></pre></div>
</div>
<div id="variance-calling" class="section level3">
<h3>variance calling</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">#### call variance</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>    <span class="ex">bcftools</span> mpileup <span class="at">-f</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39/mm39.fa<span class="dt">\</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>    <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_sorted.bam&quot;</span> <span class="kw">|</span> <span class="dt">\</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>    <span class="ex">bcftools</span> call <span class="at">-mv</span> <span class="at">-Oz</span> <span class="at">-o</span> <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_calls.vcf&quot;</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
</div>
<div id="find-relevant-mutation" class="section level3">
<h3>find relevant mutation</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Extract SRR sample folder names into a character vector (skip the header line)</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>srr_info <span class="ot">&lt;-</span> <span class="fu">list.dirs</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR/&quot;</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>, <span class="at">full.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>srr_info <span class="ot">&lt;-</span> srr_info[<span class="fu">grepl</span>(<span class="st">&quot;SRR&quot;</span>, srr_info)]  <span class="co"># Keep only directories containing &quot;SRR&quot;</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="fu">library</span>(GenomicRanges)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="fu">library</span>(vcfR)</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="fu">library</span>(Biostrings)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="fu">library</span>(TxDb.Mmusculus.UCSC.mm39.knownGene)  <span class="co"># Changed to mouse mm39</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="fu">library</span>(BSgenome.Mmusculus.UCSC.mm39)        <span class="co"># Changed to mouse mm39</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co"># Loop over each SRR sample</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="cf">for</span> (srr <span class="cf">in</span> srr_info) {</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>  <span class="co"># Load VCF file</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">read.vcfR</span>(<span class="fu">paste0</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR/&quot;</span>, srr, <span class="st">&quot;/&quot;</span>, srr, <span class="st">&quot;_calls.vcf&quot;</span>))</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>  data2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data<span class="sc">@</span>fix)</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>  <span class="co"># Keep entries with valid nucleotide bases</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>  data2 <span class="ot">&lt;-</span> data2[data2<span class="sc">$</span>REF <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;G&#39;</span>, <span class="st">&#39;T&#39;</span>) <span class="sc">&amp;</span> data2<span class="sc">$</span>ALT <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;G&#39;</span>, <span class="st">&#39;T&#39;</span>), ]</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(data2) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>    <span class="co"># If no valid SNPs, save empty object</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>    <span class="fu">saveRDS</span>(<span class="cn">NULL</span>, <span class="fu">paste0</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR/&quot;</span>, srr, <span class="st">&quot;/&quot;</span>, srr, <span class="st">&quot;SNP.rds&quot;</span>))</span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>    <span class="co"># Create GRanges object for SNPs</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>    gr <span class="ot">&lt;-</span> <span class="fu">GRanges</span>(<span class="at">seqnames =</span> <span class="fu">paste0</span>(data2<span class="sc">$</span>CHROM),</span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>                  <span class="at">ranges =</span> <span class="fu">IRanges</span>(<span class="at">start =</span> <span class="fu">as.numeric</span>(data2<span class="sc">$</span>POS), <span class="at">width =</span> <span class="dv">1</span>),</span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>                  <span class="at">strand =</span> <span class="st">&#39;+&#39;</span>,</span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>                  <span class="at">ref =</span> data2<span class="sc">$</span>REF,</span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>                  <span class="at">alt =</span> data2<span class="sc">$</span>ALT,</span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a>                  <span class="at">quality =</span> <span class="fu">as.numeric</span>(data2<span class="sc">$</span>QUAL),</span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a>                  <span class="at">info =</span> data2<span class="sc">$</span>INFO)</span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a>    <span class="co"># Keep only standard chromosomes</span></span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a>    gr <span class="ot">&lt;-</span> <span class="fu">keepStandardChromosomes</span>(gr, <span class="at">pruning.mode =</span> <span class="st">&quot;coarse&quot;</span>)</span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a>    <span class="co"># Validate reference bases with genome</span></span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a>    ref <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">DNAStringSet</span>(<span class="fu">Views</span>(Mmusculus, gr)))</span>
<span id="cb5-39"><a href="#cb5-39" tabindex="-1"></a>    gr <span class="ot">&lt;-</span> gr[gr<span class="sc">$</span>ref <span class="sc">==</span> ref]</span>
<span id="cb5-40"><a href="#cb5-40" tabindex="-1"></a></span>
<span id="cb5-41"><a href="#cb5-41" tabindex="-1"></a>    <span class="fu">saveRDS</span>(gr, <span class="fu">paste0</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR/&quot;</span>, srr, <span class="st">&quot;/&quot;</span>, srr, <span class="st">&quot;SNP.rds&quot;</span>))</span>
<span id="cb5-42"><a href="#cb5-42" tabindex="-1"></a></span>
<span id="cb5-43"><a href="#cb5-43" tabindex="-1"></a>    <span class="co"># Load transcript annotation</span></span>
<span id="cb5-44"><a href="#cb5-44" tabindex="-1"></a>    transcript <span class="ot">&lt;-</span> <span class="fu">transcripts</span>(TxDb.Mmusculus.UCSC.mm39.knownGene)</span>
<span id="cb5-45"><a href="#cb5-45" tabindex="-1"></a>    transcript_plus <span class="ot">&lt;-</span> transcript[<span class="fu">strand</span>(transcript) <span class="sc">==</span> <span class="st">&quot;+&quot;</span>]</span>
<span id="cb5-46"><a href="#cb5-46" tabindex="-1"></a>    transcript_minus <span class="ot">&lt;-</span> transcript[<span class="fu">strand</span>(transcript) <span class="sc">==</span> <span class="st">&quot;-&quot;</span>]</span>
<span id="cb5-47"><a href="#cb5-47" tabindex="-1"></a></span>
<span id="cb5-48"><a href="#cb5-48" tabindex="-1"></a>    <span class="co"># Filter A&gt;G mutations on the + strand</span></span>
<span id="cb5-49"><a href="#cb5-49" tabindex="-1"></a>    gr_plus <span class="ot">&lt;-</span> gr</span>
<span id="cb5-50"><a href="#cb5-50" tabindex="-1"></a>    olp <span class="ot">&lt;-</span> <span class="fu">findOverlaps</span>(gr_plus, transcript_plus)</span>
<span id="cb5-51"><a href="#cb5-51" tabindex="-1"></a>    gr_plus <span class="ot">&lt;-</span> gr_plus[<span class="fu">queryHits</span>(olp)]</span>
<span id="cb5-52"><a href="#cb5-52" tabindex="-1"></a>    gr_plus<span class="sc">$</span>transcript_overlapped <span class="ot">&lt;-</span> transcript_plus[<span class="fu">subjectHits</span>(olp)]<span class="sc">$</span>tx_name</span>
<span id="cb5-53"><a href="#cb5-53" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(gr_plus) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb5-54"><a href="#cb5-54" tabindex="-1"></a>      gr_plus<span class="sc">$</span>transcript_strand <span class="ot">&lt;-</span> <span class="st">&#39;+&#39;</span></span>
<span id="cb5-55"><a href="#cb5-55" tabindex="-1"></a>      gr_plus <span class="ot">&lt;-</span> <span class="fu">unique</span>(gr_plus)</span>
<span id="cb5-56"><a href="#cb5-56" tabindex="-1"></a>      gr_plus <span class="ot">&lt;-</span> gr_plus[gr_plus<span class="sc">$</span>ref <span class="sc">==</span> <span class="st">&quot;A&quot;</span> <span class="sc">&amp;</span> gr_plus<span class="sc">$</span>alt <span class="sc">==</span> <span class="st">&quot;G&quot;</span>]</span>
<span id="cb5-57"><a href="#cb5-57" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb5-58"><a href="#cb5-58" tabindex="-1"></a>      gr_plus <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb5-59"><a href="#cb5-59" tabindex="-1"></a>    }</span>
<span id="cb5-60"><a href="#cb5-60" tabindex="-1"></a></span>
<span id="cb5-61"><a href="#cb5-61" tabindex="-1"></a>    <span class="co"># Filter T&gt;C mutations on the - strand (reverse-complement)</span></span>
<span id="cb5-62"><a href="#cb5-62" tabindex="-1"></a>    gr_minus <span class="ot">&lt;-</span> gr</span>
<span id="cb5-63"><a href="#cb5-63" tabindex="-1"></a>    <span class="fu">strand</span>(gr_minus) <span class="ot">&lt;-</span> <span class="st">&#39;-&#39;</span></span>
<span id="cb5-64"><a href="#cb5-64" tabindex="-1"></a>    olp <span class="ot">&lt;-</span> <span class="fu">findOverlaps</span>(gr_minus, transcript_minus)</span>
<span id="cb5-65"><a href="#cb5-65" tabindex="-1"></a>    gr_minus <span class="ot">&lt;-</span> gr_minus[<span class="fu">queryHits</span>(olp)]</span>
<span id="cb5-66"><a href="#cb5-66" tabindex="-1"></a>    gr_minus<span class="sc">$</span>transcript_overlapped <span class="ot">&lt;-</span> transcript_minus[<span class="fu">subjectHits</span>(olp)]<span class="sc">$</span>tx_name</span>
<span id="cb5-67"><a href="#cb5-67" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(gr_minus) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb5-68"><a href="#cb5-68" tabindex="-1"></a>      gr_minus<span class="sc">$</span>transcript_strand <span class="ot">&lt;-</span> <span class="st">&#39;-&#39;</span></span>
<span id="cb5-69"><a href="#cb5-69" tabindex="-1"></a>      gr_minus <span class="ot">&lt;-</span> <span class="fu">unique</span>(gr_minus)</span>
<span id="cb5-70"><a href="#cb5-70" tabindex="-1"></a>      <span class="fu">strand</span>(gr_minus) <span class="ot">&lt;-</span> <span class="st">&#39;+&#39;</span></span>
<span id="cb5-71"><a href="#cb5-71" tabindex="-1"></a>      gr_minus <span class="ot">&lt;-</span> gr_minus[gr_minus<span class="sc">$</span>ref <span class="sc">==</span> <span class="st">&quot;T&quot;</span> <span class="sc">&amp;</span> gr_minus<span class="sc">$</span>alt <span class="sc">==</span> <span class="st">&quot;C&quot;</span>]</span>
<span id="cb5-72"><a href="#cb5-72" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb5-73"><a href="#cb5-73" tabindex="-1"></a>      gr_minus <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb5-74"><a href="#cb5-74" tabindex="-1"></a>    }</span>
<span id="cb5-75"><a href="#cb5-75" tabindex="-1"></a></span>
<span id="cb5-76"><a href="#cb5-76" tabindex="-1"></a>    <span class="co"># Combine both strand results and save</span></span>
<span id="cb5-77"><a href="#cb5-77" tabindex="-1"></a>    gr_filtered <span class="ot">&lt;-</span> <span class="fu">c</span>(gr_plus, gr_minus)</span>
<span id="cb5-78"><a href="#cb5-78" tabindex="-1"></a>    <span class="fu">saveRDS</span>(gr_filtered, <span class="fu">paste0</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR/&quot;</span>, srr, <span class="st">&quot;/&quot;</span>, srr, <span class="st">&quot;SNP_filtered.rds&quot;</span>))</span>
<span id="cb5-79"><a href="#cb5-79" tabindex="-1"></a>  }</span>
<span id="cb5-80"><a href="#cb5-80" tabindex="-1"></a></span>
<span id="cb5-81"><a href="#cb5-81" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Finished processing &quot;</span>, srr))</span>
<span id="cb5-82"><a href="#cb5-82" tabindex="-1"></a>}</span>
<span id="cb5-83"><a href="#cb5-83" tabindex="-1"></a></span>
<span id="cb5-84"><a href="#cb5-84" tabindex="-1"></a><span class="co"># Combine all filtered SNPs across samples</span></span>
<span id="cb5-85"><a href="#cb5-85" tabindex="-1"></a>gr_all <span class="ot">&lt;-</span> <span class="fu">GRanges</span>()</span>
<span id="cb5-86"><a href="#cb5-86" tabindex="-1"></a><span class="cf">for</span> (srr <span class="cf">in</span> srr_info) {</span>
<span id="cb5-87"><a href="#cb5-87" tabindex="-1"></a>  gr <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR/&quot;</span>, srr, <span class="st">&quot;/&quot;</span>, srr, <span class="st">&quot;SNP_filtered.rds&quot;</span>))</span>
<span id="cb5-88"><a href="#cb5-88" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(gr)) {</span>
<span id="cb5-89"><a href="#cb5-89" tabindex="-1"></a>    gr_all <span class="ot">&lt;-</span> <span class="fu">c</span>(gr_all, gr)</span>
<span id="cb5-90"><a href="#cb5-90" tabindex="-1"></a>  }</span>
<span id="cb5-91"><a href="#cb5-91" tabindex="-1"></a>}</span>
<span id="cb5-92"><a href="#cb5-92" tabindex="-1"></a>gr_all <span class="ot">&lt;-</span> <span class="fu">unique</span>(gr_all)</span>
<span id="cb5-93"><a href="#cb5-93" tabindex="-1"></a></span>
<span id="cb5-94"><a href="#cb5-94" tabindex="-1"></a><span class="co"># Save combined SNP results</span></span>
<span id="cb5-95"><a href="#cb5-95" tabindex="-1"></a><span class="fu">saveRDS</span>(gr_all, <span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR/SNP_all.rds&quot;</span>)</span></code></pre></div>
</div>
<div id="base-counting" class="section level3">
<h3>base counting</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Extract SRR sample folder names into a character vector (skip the header line)</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>srr_info <span class="ot">&lt;-</span> <span class="fu">list.dirs</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR&quot;</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>, <span class="at">full.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>srr_info <span class="ot">&lt;-</span> srr_info[<span class="fu">grepl</span>(<span class="st">&quot;SRR&quot;</span>, srr_info)]  <span class="co"># Keep only directories containing &quot;SRR&quot;</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">library</span>(GenomicRanges)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="fu">library</span>(Biostrings)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="fu">library</span>(GenomicAlignments)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="fu">library</span>(Rsamtools)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>gr_all<span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&#39;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR/SNP_all.rds&#39;</span>)</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>gr_all <span class="ot">&lt;-</span>gr_all[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)]</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="do">## base counting</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>j <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="cf">for</span> (srr <span class="cf">in</span> srr_info) {</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>  </span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>  time_0 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>  j <span class="ot">&lt;-</span> j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>  name <span class="ot">&lt;-</span> srr</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR/&quot;</span>,srr,<span class="st">&quot;/&quot;</span>)</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>  </span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>  <span class="do">################################## mRNA_spliced.bam</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>  <span class="do">##################################</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>  bamfilePath <span class="ot">&lt;-</span> <span class="fu">paste0</span>(path,srr,<span class="st">&#39;_mRNA_spliced.bam&#39;</span>)</span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a>  flag <span class="ot">&lt;-</span> <span class="fu">scanBamFlag</span>(<span class="at">isNotPassingQualityControls=</span><span class="cn">FALSE</span>,</span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a>                      <span class="at">isDuplicate=</span><span class="cn">FALSE</span>)</span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a>  param <span class="ot">&lt;-</span> <span class="fu">ScanBamParam</span>(<span class="at">flag=</span>flag, <span class="at">what=</span><span class="fu">c</span>(<span class="st">&quot;seq&quot;</span>,<span class="st">&quot;qual&quot;</span>),<span class="at">which=</span>gr_all)</span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a>  alns <span class="ot">&lt;-</span> <span class="fu">readGAlignments</span>(bamfilePath, <span class="at">param=</span>param)</span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a>  alns <span class="ot">&lt;-</span> <span class="fu">keepStandardChromosomes</span>(alns,<span class="at">pruning.mode =</span> <span class="st">&quot;coarse&quot;</span>)</span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a>  qseq <span class="ot">&lt;-</span> <span class="fu">mcols</span>(alns)<span class="sc">$</span>seq</span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a>  qual <span class="ot">&lt;-</span> <span class="fu">mcols</span>(alns)<span class="sc">$</span>qual</span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a>  <span class="fu">seqlevels</span>(alns) <span class="ot">&lt;-</span> <span class="fu">seqlevels</span>(gr_all)</span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a>  </span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a>  nucl_piles <span class="ot">&lt;-</span> <span class="fu">pileLettersAt</span>(qseq, <span class="fu">seqnames</span>(alns), <span class="fu">start</span>(alns),</span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a>                              <span class="fu">cigar</span>(alns), gr_all)</span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a>  frequency <span class="ot">&lt;-</span> <span class="fu">alphabetFrequency</span>(nucl_piles, <span class="at">baseOnly=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a>  </span>
<span id="cb6-42"><a href="#cb6-42" tabindex="-1"></a>  <span class="fu">saveRDS</span>(nucl_piles,<span class="fu">paste0</span>(bamfilePath,<span class="st">&#39;_nucl_piles_all.rds&#39;</span>))</span>
<span id="cb6-43"><a href="#cb6-43" tabindex="-1"></a>  <span class="fu">saveRDS</span>(frequency,<span class="fu">paste0</span>(bamfilePath,<span class="st">&#39;_frequency_all.rds&#39;</span>))</span>
<span id="cb6-44"><a href="#cb6-44" tabindex="-1"></a>  <span class="fu">rm</span>(param,alns,qseq,qual,nucl_piles,frequency,flag)</span>
<span id="cb6-45"><a href="#cb6-45" tabindex="-1"></a>  </span>
<span id="cb6-46"><a href="#cb6-46" tabindex="-1"></a>  time_1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb6-47"><a href="#cb6-47" tabindex="-1"></a>  <span class="do">################################## pre-mRNA.bam</span></span>
<span id="cb6-48"><a href="#cb6-48" tabindex="-1"></a>  <span class="do">##################################</span></span>
<span id="cb6-49"><a href="#cb6-49" tabindex="-1"></a>  bamfilePath <span class="ot">&lt;-</span> <span class="fu">paste0</span>(path,srr,<span class="st">&#39;_pre-mRNA.bam&#39;</span>)</span>
<span id="cb6-50"><a href="#cb6-50" tabindex="-1"></a>  flag <span class="ot">&lt;-</span> <span class="fu">scanBamFlag</span>(<span class="at">isNotPassingQualityControls=</span><span class="cn">FALSE</span>,</span>
<span id="cb6-51"><a href="#cb6-51" tabindex="-1"></a>                      <span class="at">isDuplicate=</span><span class="cn">FALSE</span>)</span>
<span id="cb6-52"><a href="#cb6-52" tabindex="-1"></a>  param <span class="ot">&lt;-</span> <span class="fu">ScanBamParam</span>(<span class="at">flag=</span>flag, <span class="at">what=</span><span class="fu">c</span>(<span class="st">&quot;seq&quot;</span>,<span class="st">&quot;qual&quot;</span>),<span class="at">which=</span>gr_all)</span>
<span id="cb6-53"><a href="#cb6-53" tabindex="-1"></a>  alns <span class="ot">&lt;-</span> <span class="fu">readGAlignments</span>(bamfilePath, <span class="at">param=</span>param)</span>
<span id="cb6-54"><a href="#cb6-54" tabindex="-1"></a>  alns <span class="ot">&lt;-</span> <span class="fu">keepStandardChromosomes</span>(alns,<span class="at">pruning.mode =</span> <span class="st">&quot;coarse&quot;</span>)</span>
<span id="cb6-55"><a href="#cb6-55" tabindex="-1"></a>  qseq <span class="ot">&lt;-</span> <span class="fu">mcols</span>(alns)<span class="sc">$</span>seq</span>
<span id="cb6-56"><a href="#cb6-56" tabindex="-1"></a>  qual <span class="ot">&lt;-</span> <span class="fu">mcols</span>(alns)<span class="sc">$</span>qual</span>
<span id="cb6-57"><a href="#cb6-57" tabindex="-1"></a>  <span class="fu">seqlevels</span>(alns) <span class="ot">&lt;-</span> <span class="fu">seqlevels</span>(gr_all)</span>
<span id="cb6-58"><a href="#cb6-58" tabindex="-1"></a>  </span>
<span id="cb6-59"><a href="#cb6-59" tabindex="-1"></a>  nucl_piles <span class="ot">&lt;-</span> <span class="fu">pileLettersAt</span>(qseq, <span class="fu">seqnames</span>(alns), <span class="fu">start</span>(alns),</span>
<span id="cb6-60"><a href="#cb6-60" tabindex="-1"></a>                              <span class="fu">cigar</span>(alns), gr_all)</span>
<span id="cb6-61"><a href="#cb6-61" tabindex="-1"></a>  frequency <span class="ot">&lt;-</span> <span class="fu">alphabetFrequency</span>(nucl_piles, <span class="at">baseOnly=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-62"><a href="#cb6-62" tabindex="-1"></a>  </span>
<span id="cb6-63"><a href="#cb6-63" tabindex="-1"></a>  <span class="fu">saveRDS</span>(nucl_piles,<span class="fu">paste0</span>(bamfilePath,<span class="st">&#39;_nucl_piles_all.rds&#39;</span>))</span>
<span id="cb6-64"><a href="#cb6-64" tabindex="-1"></a>  <span class="fu">saveRDS</span>(frequency,<span class="fu">paste0</span>(bamfilePath,<span class="st">&#39;_frequency_all.rds&#39;</span>))</span>
<span id="cb6-65"><a href="#cb6-65" tabindex="-1"></a>  <span class="fu">rm</span>(param,alns,qseq,qual,nucl_piles,frequency,flag)</span>
<span id="cb6-66"><a href="#cb6-66" tabindex="-1"></a>  </span>
<span id="cb6-67"><a href="#cb6-67" tabindex="-1"></a>  time_2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb6-68"><a href="#cb6-68" tabindex="-1"></a>  <span class="do">################################## isoform.bam</span></span>
<span id="cb6-69"><a href="#cb6-69" tabindex="-1"></a>  <span class="do">##################################</span></span>
<span id="cb6-70"><a href="#cb6-70" tabindex="-1"></a>  bamfilePath <span class="ot">&lt;-</span> <span class="fu">paste0</span>(path,srr,<span class="st">&#39;_isoform-a.bam&#39;</span>)</span>
<span id="cb6-71"><a href="#cb6-71" tabindex="-1"></a>  flag <span class="ot">&lt;-</span> <span class="fu">scanBamFlag</span>(<span class="at">isNotPassingQualityControls=</span><span class="cn">FALSE</span>,</span>
<span id="cb6-72"><a href="#cb6-72" tabindex="-1"></a>                      <span class="at">isDuplicate=</span><span class="cn">FALSE</span>)</span>
<span id="cb6-73"><a href="#cb6-73" tabindex="-1"></a>  param <span class="ot">&lt;-</span> <span class="fu">ScanBamParam</span>(<span class="at">flag=</span>flag, <span class="at">what=</span><span class="fu">c</span>(<span class="st">&quot;seq&quot;</span>,<span class="st">&quot;qual&quot;</span>),<span class="at">which=</span>gr_all)</span>
<span id="cb6-74"><a href="#cb6-74" tabindex="-1"></a>  alns <span class="ot">&lt;-</span> <span class="fu">readGAlignments</span>(bamfilePath, <span class="at">param=</span>param)</span>
<span id="cb6-75"><a href="#cb6-75" tabindex="-1"></a>  alns <span class="ot">&lt;-</span> <span class="fu">keepStandardChromosomes</span>(alns,<span class="at">pruning.mode =</span> <span class="st">&quot;coarse&quot;</span>)</span>
<span id="cb6-76"><a href="#cb6-76" tabindex="-1"></a>  qseq <span class="ot">&lt;-</span> <span class="fu">mcols</span>(alns)<span class="sc">$</span>seq</span>
<span id="cb6-77"><a href="#cb6-77" tabindex="-1"></a>  qual <span class="ot">&lt;-</span> <span class="fu">mcols</span>(alns)<span class="sc">$</span>qual</span>
<span id="cb6-78"><a href="#cb6-78" tabindex="-1"></a>  <span class="fu">seqlevels</span>(alns) <span class="ot">&lt;-</span> <span class="fu">seqlevels</span>(gr_all)</span>
<span id="cb6-79"><a href="#cb6-79" tabindex="-1"></a>  </span>
<span id="cb6-80"><a href="#cb6-80" tabindex="-1"></a>  nucl_piles <span class="ot">&lt;-</span> <span class="fu">pileLettersAt</span>(qseq, <span class="fu">seqnames</span>(alns), <span class="fu">start</span>(alns),</span>
<span id="cb6-81"><a href="#cb6-81" tabindex="-1"></a>                              <span class="fu">cigar</span>(alns), gr_all)</span>
<span id="cb6-82"><a href="#cb6-82" tabindex="-1"></a>  frequency <span class="ot">&lt;-</span> <span class="fu">alphabetFrequency</span>(nucl_piles, <span class="at">baseOnly=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-83"><a href="#cb6-83" tabindex="-1"></a>  </span>
<span id="cb6-84"><a href="#cb6-84" tabindex="-1"></a>  <span class="fu">saveRDS</span>(nucl_piles,<span class="fu">paste0</span>(bamfilePath,<span class="st">&#39;_nucl_piles_all.rds&#39;</span>))</span>
<span id="cb6-85"><a href="#cb6-85" tabindex="-1"></a>  <span class="fu">saveRDS</span>(frequency,<span class="fu">paste0</span>(bamfilePath,<span class="st">&#39;_frequency_all.rds&#39;</span>))</span>
<span id="cb6-86"><a href="#cb6-86" tabindex="-1"></a>  <span class="fu">rm</span>(param,alns,qseq,qual,nucl_piles,frequency,flag)</span>
<span id="cb6-87"><a href="#cb6-87" tabindex="-1"></a>    time_3 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb6-88"><a href="#cb6-88" tabindex="-1"></a>  </span>
<span id="cb6-89"><a href="#cb6-89" tabindex="-1"></a>  <span class="fu">print</span>(j)</span>
<span id="cb6-90"><a href="#cb6-90" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;spliced mRNA runing time&quot;</span>, time_1<span class="sc">-</span>time_0))</span>
<span id="cb6-91"><a href="#cb6-91" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;pre-mRNA runing time&quot;</span>, time_2<span class="sc">-</span>time_1))</span>
<span id="cb6-92"><a href="#cb6-92" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;isoform-mRNA runing time&quot;</span>, time_3<span class="sc">-</span>time_2))</span>
<span id="cb6-93"><a href="#cb6-93" tabindex="-1"></a>}</span>
<span id="cb6-94"><a href="#cb6-94" tabindex="-1"></a></span>
<span id="cb6-95"><a href="#cb6-95" tabindex="-1"></a></span>
<span id="cb6-96"><a href="#cb6-96" tabindex="-1"></a><span class="co"># combine:</span></span>
<span id="cb6-97"><a href="#cb6-97" tabindex="-1"></a><span class="co"># Extract SRR sample folder names into a character vector (skip the header line)</span></span>
<span id="cb6-98"><a href="#cb6-98" tabindex="-1"></a>srr_info <span class="ot">&lt;-</span> <span class="fu">list.dirs</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR&quot;</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>, <span class="at">full.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-99"><a href="#cb6-99" tabindex="-1"></a>srr_info <span class="ot">&lt;-</span> srr_info[<span class="fu">grepl</span>(<span class="st">&quot;SRR&quot;</span>, srr_info)]  <span class="co"># Keep only directories containing &quot;SRR&quot;</span></span>
<span id="cb6-100"><a href="#cb6-100" tabindex="-1"></a></span>
<span id="cb6-101"><a href="#cb6-101" tabindex="-1"></a></span>
<span id="cb6-102"><a href="#cb6-102" tabindex="-1"></a></span>
<span id="cb6-103"><a href="#cb6-103" tabindex="-1"></a><span class="co"># Initialize the spliced_list</span></span>
<span id="cb6-104"><a href="#cb6-104" tabindex="-1"></a>spliced_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb6-105"><a href="#cb6-105" tabindex="-1"></a>j <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb6-106"><a href="#cb6-106" tabindex="-1"></a><span class="cf">for</span> (srr <span class="cf">in</span> srr_info) {</span>
<span id="cb6-107"><a href="#cb6-107" tabindex="-1"></a>  name <span class="ot">&lt;-</span> srr</span>
<span id="cb6-108"><a href="#cb6-108" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR/&#39;</span>, srr,<span class="st">&quot;/&quot;</span>)</span>
<span id="cb6-109"><a href="#cb6-109" tabindex="-1"></a>  spliced_list[[j]] <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(path, srr, <span class="st">&quot;_mRNA_spliced.bam_frequency_all.rds&quot;</span>))</span>
<span id="cb6-110"><a href="#cb6-110" tabindex="-1"></a>  j <span class="ot">=</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-111"><a href="#cb6-111" tabindex="-1"></a>}</span>
<span id="cb6-112"><a href="#cb6-112" tabindex="-1"></a></span>
<span id="cb6-113"><a href="#cb6-113" tabindex="-1"></a><span class="co"># Name the elements of spliced_list</span></span>
<span id="cb6-114"><a href="#cb6-114" tabindex="-1"></a><span class="fu">names</span>(spliced_list) <span class="ot">&lt;-</span> srr_info</span>
<span id="cb6-115"><a href="#cb6-115" tabindex="-1"></a><span class="fu">saveRDS</span>(spliced_list, <span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR/spliced_A_to_I.rds&quot;</span>)</span>
<span id="cb6-116"><a href="#cb6-116" tabindex="-1"></a></span>
<span id="cb6-117"><a href="#cb6-117" tabindex="-1"></a><span class="co"># Initialize the pre_list</span></span>
<span id="cb6-118"><a href="#cb6-118" tabindex="-1"></a>pre_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb6-119"><a href="#cb6-119" tabindex="-1"></a>j <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb6-120"><a href="#cb6-120" tabindex="-1"></a><span class="cf">for</span> (srr <span class="cf">in</span> srr_info) {</span>
<span id="cb6-121"><a href="#cb6-121" tabindex="-1"></a>  name <span class="ot">&lt;-</span> srr</span>
<span id="cb6-122"><a href="#cb6-122" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR/&#39;</span>, srr,<span class="st">&quot;/&quot;</span>)</span>
<span id="cb6-123"><a href="#cb6-123" tabindex="-1"></a>  pre_list[[j]] <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(path, srr, <span class="st">&quot;_pre-mRNA.bam_frequency_all.rds&quot;</span>))</span>
<span id="cb6-124"><a href="#cb6-124" tabindex="-1"></a>  j <span class="ot">=</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-125"><a href="#cb6-125" tabindex="-1"></a>}</span>
<span id="cb6-126"><a href="#cb6-126" tabindex="-1"></a></span>
<span id="cb6-127"><a href="#cb6-127" tabindex="-1"></a><span class="co"># Name the elements of isoform_list</span></span>
<span id="cb6-128"><a href="#cb6-128" tabindex="-1"></a><span class="fu">names</span>(pre_list) <span class="ot">&lt;-</span> srr_info</span>
<span id="cb6-129"><a href="#cb6-129" tabindex="-1"></a><span class="fu">saveRDS</span>(pre_list, <span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR/pre_A_to_I.rds&quot;</span>)</span>
<span id="cb6-130"><a href="#cb6-130" tabindex="-1"></a></span>
<span id="cb6-131"><a href="#cb6-131" tabindex="-1"></a></span>
<span id="cb6-132"><a href="#cb6-132" tabindex="-1"></a><span class="co"># Initialize the isoform_list</span></span>
<span id="cb6-133"><a href="#cb6-133" tabindex="-1"></a>isoform_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb6-134"><a href="#cb6-134" tabindex="-1"></a>j <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb6-135"><a href="#cb6-135" tabindex="-1"></a><span class="cf">for</span> (srr <span class="cf">in</span> srr_info) {</span>
<span id="cb6-136"><a href="#cb6-136" tabindex="-1"></a>  name <span class="ot">&lt;-</span> srr</span>
<span id="cb6-137"><a href="#cb6-137" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR/&#39;</span>, srr,<span class="st">&quot;/&quot;</span>)</span>
<span id="cb6-138"><a href="#cb6-138" tabindex="-1"></a>  isoform_list[[j]] <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(path, srr, <span class="st">&quot;_isoform-a.bam_frequency_all.rds&quot;</span>))</span>
<span id="cb6-139"><a href="#cb6-139" tabindex="-1"></a>  j <span class="ot">=</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-140"><a href="#cb6-140" tabindex="-1"></a>}</span>
<span id="cb6-141"><a href="#cb6-141" tabindex="-1"></a></span>
<span id="cb6-142"><a href="#cb6-142" tabindex="-1"></a><span class="co"># Name the elements of pre_list</span></span>
<span id="cb6-143"><a href="#cb6-143" tabindex="-1"></a><span class="fu">names</span>(isoform_list) <span class="ot">&lt;-</span> srr_info</span>
<span id="cb6-144"><a href="#cb6-144" tabindex="-1"></a><span class="fu">saveRDS</span>(isoform_list, <span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR/isoform_A_to_I.rds&quot;</span>)</span></code></pre></div>
</div>
<div id="summary-the-count" class="section level3">
<h3>summary the count</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="ex">module</span> load samtools/1.16.1-gcc-8.5.0-teyetiz </span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="va">root_dir</span><span class="op">=</span><span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR&quot;</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="va">output_file</span><span class="op">=</span><span class="st">&quot;bam_read_counts.csv&quot;</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Folder,isoform-a.bam,mRNA_spliced.bam,pre-mRNA.bam&quot;</span> <span class="op">&gt;</span> <span class="st">&quot;</span><span class="va">$output_file</span><span class="st">&quot;</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="cf">for</span> folder <span class="kw">in</span> <span class="st">&quot;</span><span class="va">$root_dir</span><span class="st">&quot;</span>/SRR<span class="pp">*</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">[</span> <span class="ot">-d</span> <span class="st">&quot;</span><span class="va">$folder</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>        <span class="va">folder_name</span><span class="op">=</span><span class="va">$(</span><span class="fu">basename</span> <span class="st">&quot;</span><span class="va">$folder</span><span class="st">&quot;</span><span class="va">)</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;Processing folder: </span><span class="va">$folder_name</span><span class="st">&quot;</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>        </span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a>        </span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a>        <span class="va">isoform_a_count</span><span class="op">=</span><span class="st">&quot;Not found&quot;</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>        <span class="va">mrna_spliced_count</span><span class="op">=</span><span class="st">&quot;Not found&quot;</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a>        <span class="va">pre_mrna_count</span><span class="op">=</span><span class="st">&quot;Not found&quot;</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a>        </span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a>        <span class="co">#isoform-a.bam</span></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a>        <span class="va">isoform_a_file</span><span class="op">=</span><span class="va">$(</span><span class="fu">find</span> <span class="st">&quot;</span><span class="va">$folder</span><span class="st">&quot;</span> <span class="at">-name</span> <span class="st">&quot;*_isoform-a.bam&quot;</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 1<span class="va">)</span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">[</span> <span class="ot">-n</span> <span class="st">&quot;</span><span class="va">$isoform_a_file</span><span class="st">&quot;</span> <span class="bu">]</span> <span class="kw">&amp;&amp;</span> <span class="bu">[</span> <span class="ot">-f</span> <span class="st">&quot;</span><span class="va">$isoform_a_file</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a>            <span class="va">isoform_a_count</span><span class="op">=</span><span class="va">$(</span><span class="ex">samtools</span> view <span class="at">-c</span> <span class="st">&quot;</span><span class="va">$isoform_a_file</span><span class="st">&quot;</span><span class="va">)</span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a>        <span class="cf">fi</span></span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a>        </span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a>        <span class="co">#mRNA_spliced.bam</span></span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a>        <span class="va">mrna_spliced_file</span><span class="op">=</span><span class="va">$(</span><span class="fu">find</span> <span class="st">&quot;</span><span class="va">$folder</span><span class="st">&quot;</span> <span class="at">-name</span> <span class="st">&quot;*_mRNA_spliced.bam&quot;</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 1<span class="va">)</span></span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">[</span> <span class="ot">-n</span> <span class="st">&quot;</span><span class="va">$mrna_spliced_file</span><span class="st">&quot;</span> <span class="bu">]</span> <span class="kw">&amp;&amp;</span> <span class="bu">[</span> <span class="ot">-f</span> <span class="st">&quot;</span><span class="va">$mrna_spliced_file</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a>            <span class="va">mrna_spliced_count</span><span class="op">=</span><span class="va">$(</span><span class="ex">samtools</span> view <span class="at">-c</span> <span class="st">&quot;</span><span class="va">$mrna_spliced_file</span><span class="st">&quot;</span><span class="va">)</span></span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a>        <span class="cf">fi</span></span>
<span id="cb7-38"><a href="#cb7-38" tabindex="-1"></a>        </span>
<span id="cb7-39"><a href="#cb7-39" tabindex="-1"></a>        <span class="co">#pre-mRNA.bam</span></span>
<span id="cb7-40"><a href="#cb7-40" tabindex="-1"></a>        <span class="va">pre_mrna_file</span><span class="op">=</span><span class="va">$(</span><span class="fu">find</span> <span class="st">&quot;</span><span class="va">$folder</span><span class="st">&quot;</span> <span class="at">-name</span> <span class="st">&quot;*_pre-mRNA.bam&quot;</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 1<span class="va">)</span></span>
<span id="cb7-41"><a href="#cb7-41" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">[</span> <span class="ot">-n</span> <span class="st">&quot;</span><span class="va">$pre_mrna_file</span><span class="st">&quot;</span> <span class="bu">]</span> <span class="kw">&amp;&amp;</span> <span class="bu">[</span> <span class="ot">-f</span> <span class="st">&quot;</span><span class="va">$pre_mrna_file</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb7-42"><a href="#cb7-42" tabindex="-1"></a>            <span class="va">pre_mrna_count</span><span class="op">=</span><span class="va">$(</span><span class="ex">samtools</span> view <span class="at">-c</span> <span class="st">&quot;</span><span class="va">$pre_mrna_file</span><span class="st">&quot;</span><span class="va">)</span></span>
<span id="cb7-43"><a href="#cb7-43" tabindex="-1"></a>        <span class="cf">fi</span></span>
<span id="cb7-44"><a href="#cb7-44" tabindex="-1"></a>        </span>
<span id="cb7-45"><a href="#cb7-45" tabindex="-1"></a>        <span class="co">#</span></span>
<span id="cb7-46"><a href="#cb7-46" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$folder_name</span><span class="st">,</span><span class="va">$isoform_a_count</span><span class="st">,</span><span class="va">$mrna_spliced_count</span><span class="st">,</span><span class="va">$pre_mrna_count</span><span class="st">&quot;</span> <span class="op">&gt;&gt;</span> <span class="st">&quot;</span><span class="va">$output_file</span><span class="st">&quot;</span></span>
<span id="cb7-47"><a href="#cb7-47" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb7-48"><a href="#cb7-48" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb7-49"><a href="#cb7-49" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Processing complete. Results saved to </span><span class="va">$output_file</span><span class="st">&quot;</span></span></code></pre></div>
</div>
<div id="feature-counts" class="section level3">
<h3>feature counts</h3>
<p>extract expression for scVelo</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="ex">module</span> load subread/2.0.2-gcc-8.5.0-gcsb2x2</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="va">input_base</span><span class="op">=</span><span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR&quot;</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="va">gtf_file</span><span class="op">=</span><span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_2/mm39/mm39.knownGene.gtf&quot;</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="va">srr_list</span><span class="op">=</span><span class="va">($(</span><span class="fu">find</span> <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">&quot;</span> <span class="at">-maxdepth</span> 1 <span class="at">-type</span> d <span class="at">-name</span> <span class="st">&quot;SRR*&quot;</span> ! <span class="at">-name</span> <span class="st">&quot;SRR&quot;</span> <span class="at">-exec</span> basename {} <span class="dt">\;</span><span class="va">))</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>    <span class="va">output_dir</span><span class="op">=</span><span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/counts&quot;</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>    <span class="fu">mkdir</span> <span class="at">-p</span> <span class="st">&quot;</span><span class="va">$output_dir</span><span class="st">&quot;</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>    <span class="va">bam_files</span><span class="op">=</span><span class="va">(</span><span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/&quot;</span><span class="pp">*</span>_mRNA_spliced.bam <span class="dt">\</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>               <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/&quot;</span><span class="pp">*</span>_pre-mRNA.bam <span class="dt">\</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>               <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/&quot;</span><span class="pp">*</span>_isoform-a.bam<span class="va">)</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>    <span class="cf">for</span> bamfile <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${bam_files</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>        <span class="bu">[</span> <span class="ot">-f</span> <span class="st">&quot;</span><span class="va">$bamfile</span><span class="st">&quot;</span> <span class="bu">]</span> <span class="kw">||</span> <span class="cf">continue</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>        <span class="va">bam_name</span><span class="op">=</span><span class="va">$(</span><span class="fu">basename</span> <span class="st">&quot;</span><span class="va">$bamfile</span><span class="st">&quot;</span> .bam<span class="va">)</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;  Counting reads in </span><span class="va">$bam_name</span><span class="st">&quot;</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>        <span class="ex">featureCounts</span> <span class="at">-T</span> 4 <span class="at">-a</span> <span class="st">&quot;</span><span class="va">$gtf_file</span><span class="st">&quot;</span> <span class="at">-o</span> <span class="st">&quot;</span><span class="va">${output_dir}</span><span class="st">/</span><span class="va">${bam_name}</span><span class="st">_counts.txt&quot;</span> <span class="st">&quot;</span><span class="va">$bamfile</span><span class="st">&quot;</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>    <span class="cf">done</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;All read counts generated.&quot;</span></span></code></pre></div>
</div>
<div id="combine-the-gene-counts" class="section level3">
<h3>combine the gene counts</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="im">from</span> glob <span class="im">import</span> glob</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>base_dir <span class="op">=</span> <span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE99933/SRR&quot;</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>types <span class="op">=</span> [<span class="st">&quot;mRNA_spliced&quot;</span>, <span class="st">&quot;pre-mRNA&quot;</span>, <span class="st">&quot;isoform-a&quot;</span>]</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> types:</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>    count_files <span class="op">=</span> glob(os.path.join(base_dir, <span class="st">&quot;SRR*&quot;</span>, <span class="st">&quot;counts&quot;</span>, <span class="ss">f&quot;*_</span><span class="sc">{</span>t<span class="sc">}</span><span class="ss">_counts.txt&quot;</span>))</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;[</span><span class="sc">{</span>t<span class="sc">}</span><span class="ss">] Found </span><span class="sc">{</span><span class="bu">len</span>(count_files)<span class="sc">}</span><span class="ss"> count files.&quot;</span>)</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>    dfs_counts <span class="op">=</span> []</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>    dfs_tpm <span class="op">=</span> []</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>    <span class="cf">for</span> f <span class="kw">in</span> count_files:</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>        df <span class="op">=</span> pd.read_csv(f, sep<span class="op">=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, comment<span class="op">=</span><span class="st">&quot;#&quot;</span>, header<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>        <span class="co"># Get key columns</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a>        gene_col <span class="op">=</span> <span class="st">&#39;Geneid&#39;</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a>        length_col <span class="op">=</span> <span class="st">&#39;Length&#39;</span>  <span class="co"># featureCounts output must include Length</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a>        count_col <span class="op">=</span> df.columns[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a>        df <span class="op">=</span> df[[gene_col, length_col, count_col]].copy()</span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a>        df.rename(columns<span class="op">=</span>{count_col: <span class="st">&#39;counts&#39;</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a>        <span class="co"># Calculate TPM</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a>        df[<span class="st">&quot;length_kb&quot;</span>] <span class="op">=</span> df[length_col] <span class="op">/</span> <span class="dv">1000</span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a>        df[<span class="st">&quot;RPK&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;counts&quot;</span>] <span class="op">/</span> df[<span class="st">&quot;length_kb&quot;</span>]</span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a>        scaling_factor <span class="op">=</span> df[<span class="st">&quot;RPK&quot;</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="fl">1e6</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a>        df[<span class="st">&quot;TPM&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;RPK&quot;</span>] <span class="op">/</span> scaling_factor</span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a>        <span class="co"># Sample name</span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a>        sample_name <span class="op">=</span> os.path.basename(f).replace(<span class="st">&quot;_counts.txt&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a>        <span class="co"># Add to lists</span></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a>        dfs_counts.append(df[[gene_col, <span class="st">&quot;counts&quot;</span>]].set_index(gene_col).rename(columns<span class="op">=</span>{<span class="st">&quot;counts&quot;</span>: sample_name}))</span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a>        dfs_tpm.append(df[[gene_col, <span class="st">&quot;TPM&quot;</span>]].set_index(gene_col).rename(columns<span class="op">=</span>{<span class="st">&quot;TPM&quot;</span>: sample_name}))</span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a></span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a>    <span class="cf">if</span> dfs_counts:</span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a>        <span class="co"># Merge all samples</span></span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a>        counts_matrix <span class="op">=</span> pd.concat(dfs_counts, axis<span class="op">=</span><span class="dv">1</span>).fillna(<span class="dv">0</span>)</span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a>        tpm_matrix <span class="op">=</span> pd.concat(dfs_tpm, axis<span class="op">=</span><span class="dv">1</span>).fillna(<span class="dv">0</span>)</span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a></span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a>        <span class="co"># Output files</span></span>
<span id="cb9-45"><a href="#cb9-45" tabindex="-1"></a>        counts_out <span class="op">=</span> os.path.join(base_dir, <span class="ss">f&quot;all_samples_counts_matrix_</span><span class="sc">{</span>t<span class="sc">}</span><span class="ss">.txt&quot;</span>)</span>
<span id="cb9-46"><a href="#cb9-46" tabindex="-1"></a>        tpm_out <span class="op">=</span> os.path.join(base_dir, <span class="ss">f&quot;all_samples_TPM_matrix_</span><span class="sc">{</span>t<span class="sc">}</span><span class="ss">.txt&quot;</span>)</span>
<span id="cb9-47"><a href="#cb9-47" tabindex="-1"></a></span>
<span id="cb9-48"><a href="#cb9-48" tabindex="-1"></a>        counts_matrix.to_csv(counts_out, sep<span class="op">=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</span>
<span id="cb9-49"><a href="#cb9-49" tabindex="-1"></a>        tpm_matrix.to_csv(tpm_out, sep<span class="op">=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</span>
<span id="cb9-50"><a href="#cb9-50" tabindex="-1"></a></span>
<span id="cb9-51"><a href="#cb9-51" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;[</span><span class="sc">{</span>t<span class="sc">}</span><span class="ss">] Saved merged counts matrix: </span><span class="sc">{</span>counts_out<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb9-52"><a href="#cb9-52" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;[</span><span class="sc">{</span>t<span class="sc">}</span><span class="ss">] Saved merged TPM matrix: </span><span class="sc">{</span>tpm_out<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb9-53"><a href="#cb9-53" tabindex="-1"></a></span>
<span id="cb9-54"><a href="#cb9-54" tabindex="-1"></a></span>
<span id="cb9-55"><a href="#cb9-55" tabindex="-1"></a></span>
<span id="cb9-56"><a href="#cb9-56" tabindex="-1"></a><span class="co"># Read a tab-separated file (common for .txt exports)</span></span>
<span id="cb9-57"><a href="#cb9-57" tabindex="-1"></a>isoform_TPM <span class="op">&lt;-</span> read.table(<span class="st">&quot;C:/Users/Haozhe Wang/OneDrive//all_samples_TPM_matrix_isoform-a.txt&quot;</span>, </span>
<span id="cb9-58"><a href="#cb9-58" tabindex="-1"></a>                      header <span class="op">=</span> TRUE,        <span class="co"># First row contains column names</span></span>
<span id="cb9-59"><a href="#cb9-59" tabindex="-1"></a>                      row.names <span class="op">=</span> <span class="dv">1</span>,</span>
<span id="cb9-60"><a href="#cb9-60" tabindex="-1"></a>                      sep <span class="op">=</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)           <span class="co"># Separator is a tab</span></span>
<span id="cb9-61"><a href="#cb9-61" tabindex="-1"></a></span>
<span id="cb9-62"><a href="#cb9-62" tabindex="-1"></a><span class="co"># Read a tab-separated file (common for .txt exports)</span></span>
<span id="cb9-63"><a href="#cb9-63" tabindex="-1"></a>spliced_TPM <span class="op">&lt;-</span> read.table(<span class="st">&quot;C:/Users/Haozhe Wang/OneDrive//all_samples_TPM_matrix_mRNA_spliced.txt&quot;</span>, </span>
<span id="cb9-64"><a href="#cb9-64" tabindex="-1"></a>                          header <span class="op">=</span> TRUE,        <span class="co"># First row contains column names</span></span>
<span id="cb9-65"><a href="#cb9-65" tabindex="-1"></a>                          row.names <span class="op">=</span> <span class="dv">1</span>,</span>
<span id="cb9-66"><a href="#cb9-66" tabindex="-1"></a>                          sep <span class="op">=</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)           <span class="co"># Separator is a tab</span></span>
<span id="cb9-67"><a href="#cb9-67" tabindex="-1"></a></span>
<span id="cb9-68"><a href="#cb9-68" tabindex="-1"></a><span class="co"># Read a tab-separated file (common for .txt exports)</span></span>
<span id="cb9-69"><a href="#cb9-69" tabindex="-1"></a>pre_TPM <span class="op">&lt;-</span> read.table(<span class="st">&quot;C:/Users/Haozhe Wang/OneDrive//all_samples_TPM_matrix_pre-mRNA.txt&quot;</span>, </span>
<span id="cb9-70"><a href="#cb9-70" tabindex="-1"></a>                          header <span class="op">=</span> TRUE,        <span class="co"># First row contains column names</span></span>
<span id="cb9-71"><a href="#cb9-71" tabindex="-1"></a>                          row.names <span class="op">=</span> <span class="dv">1</span>,</span>
<span id="cb9-72"><a href="#cb9-72" tabindex="-1"></a>                          sep <span class="op">=</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)           <span class="co"># Separator is a tab</span></span>
<span id="cb9-73"><a href="#cb9-73" tabindex="-1"></a></span>
<span id="cb9-74"><a href="#cb9-74" tabindex="-1"></a>colnames(isoform_TPM) <span class="op">&lt;-</span> gsub(<span class="st">&quot;_isoform</span><span class="ch">\\</span><span class="st">.a&quot;</span>, <span class="st">&quot;&quot;</span>, colnames(isoform_TPM))</span>
<span id="cb9-75"><a href="#cb9-75" tabindex="-1"></a>colnames(spliced_TPM) <span class="op">&lt;-</span> gsub(<span class="st">&quot;_mRNA_spliced&quot;</span>, <span class="st">&quot;&quot;</span>, colnames(spliced_TPM))</span>
<span id="cb9-76"><a href="#cb9-76" tabindex="-1"></a>colnames(pre_TPM) <span class="op">&lt;-</span> gsub(<span class="st">&quot;_pre</span><span class="ch">\\</span><span class="st">.mRNA&quot;</span>, <span class="st">&quot;&quot;</span>, colnames(pre_TPM))</span>
<span id="cb9-77"><a href="#cb9-77" tabindex="-1"></a></span>
<span id="cb9-78"><a href="#cb9-78" tabindex="-1"></a>index_isoform <span class="op">&lt;-</span> which(rowSums(isoform_TPM)<span class="op">!=</span><span class="dv">0</span>)</span>
<span id="cb9-79"><a href="#cb9-79" tabindex="-1"></a>index_spliced <span class="op">&lt;-</span> which(rowSums(spliced_TPM)<span class="op">!=</span><span class="dv">0</span>)</span>
<span id="cb9-80"><a href="#cb9-80" tabindex="-1"></a>index_pre <span class="op">&lt;-</span> which(rowSums(pre_TPM)<span class="op">!=</span><span class="dv">0</span>)</span>
<span id="cb9-81"><a href="#cb9-81" tabindex="-1"></a></span>
<span id="cb9-82"><a href="#cb9-82" tabindex="-1"></a>index_pre_spliced <span class="op">&lt;-</span> intersect(index_pre,index_spliced)</span>
<span id="cb9-83"><a href="#cb9-83" tabindex="-1"></a></span>
<span id="cb9-84"><a href="#cb9-84" tabindex="-1"></a>isoform_TPM_index_pre_spliced <span class="op">&lt;-</span> isoform_TPM[index_pre_spliced ,]</span>
<span id="cb9-85"><a href="#cb9-85" tabindex="-1"></a>pre_TPM_index_pre_spliced <span class="op">&lt;-</span> pre_TPM[index_pre_spliced ,]</span>
<span id="cb9-86"><a href="#cb9-86" tabindex="-1"></a>spliced_TPM_index_pre_spliced <span class="op">&lt;-</span> spliced_TPM[index_pre_spliced ,]</span>
<span id="cb9-87"><a href="#cb9-87" tabindex="-1"></a></span>
<span id="cb9-88"><a href="#cb9-88" tabindex="-1"></a>write.csv(isoform_TPM_index_pre_spliced, <span class="st">&quot;isoform_TPM_index_pre_spliced.csv&quot;</span>, row.names <span class="op">=</span> TRUE, quote <span class="op">=</span> FALSE)</span>
<span id="cb9-89"><a href="#cb9-89" tabindex="-1"></a></span>
<span id="cb9-90"><a href="#cb9-90" tabindex="-1"></a>write.csv(pre_TPM_index_pre_spliced, <span class="st">&quot;pre_TPM_index_pre_spliced.csv&quot;</span>, row.names <span class="op">=</span> TRUE, quote <span class="op">=</span> FALSE)</span>
<span id="cb9-91"><a href="#cb9-91" tabindex="-1"></a></span>
<span id="cb9-92"><a href="#cb9-92" tabindex="-1"></a>write.csv(spliced_TPM_index_pre_spliced, <span class="st">&quot;spliced_TPM_index_pre_spliced.csv&quot;</span>, row.names <span class="op">=</span> TRUE, quote <span class="op">=</span> FALSE)</span></code></pre></div>
</div>
<div id="extract-both-have-reads" class="section level3">
<h3>extract both have reads</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co"># Read a tab-separated file (common for .txt exports)</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>isoform_TPM <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;C:/Users/Haozhe Wang/OneDrive/desktop/all_samples_TPM_matrix_isoform-a.txt&quot;</span>, </span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                      <span class="at">header =</span> <span class="cn">TRUE</span>,        <span class="co"># First row contains column names</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>                      <span class="at">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>                      <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)           <span class="co"># Separator is a tab</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co"># Read a tab-separated file (common for .txt exports)</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>spliced_TPM <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;C:/Users/Haozhe Wang/OneDrive/desktop/all_samples_TPM_matrix_mRNA_spliced.txt&quot;</span>, </span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>                          <span class="at">header =</span> <span class="cn">TRUE</span>,        <span class="co"># First row contains column names</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>                          <span class="at">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>                          <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)           <span class="co"># Separator is a tab</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co"># Read a tab-separated file (common for .txt exports)</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>pre_TPM <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;C:/Users/Haozhe Wang/OneDrive/desktop/all_samples_TPM_matrix_pre-mRNA.txt&quot;</span>, </span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>                          <span class="at">header =</span> <span class="cn">TRUE</span>,        <span class="co"># First row contains column names</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>                          <span class="at">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>                          <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)           <span class="co"># Separator is a tab</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="fu">colnames</span>(isoform_TPM) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;_isoform</span><span class="sc">\\</span><span class="st">.a&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">colnames</span>(isoform_TPM))</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="fu">colnames</span>(spliced_TPM) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;_mRNA_spliced&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">colnames</span>(spliced_TPM))</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="fu">colnames</span>(pre_TPM) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;_pre</span><span class="sc">\\</span><span class="st">.mRNA&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">colnames</span>(pre_TPM))</span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>index_isoform <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">rowSums</span>(isoform_TPM)<span class="sc">!=</span><span class="dv">0</span>)</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>index_spliced <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">rowSums</span>(spliced_TPM)<span class="sc">!=</span><span class="dv">0</span>)</span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>index_pre <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">rowSums</span>(pre_TPM)<span class="sc">!=</span><span class="dv">0</span>)</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>index_pre_spliced <span class="ot">&lt;-</span> <span class="fu">intersect</span>(index_pre,index_spliced)</span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a>isoform_TPM_index_pre_spliced <span class="ot">&lt;-</span> isoform_TPM[index_pre_spliced ,]</span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a>pre_TPM_index_pre_spliced <span class="ot">&lt;-</span> pre_TPM[index_pre_spliced ,]</span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a>spliced_TPM_index_pre_spliced <span class="ot">&lt;-</span> spliced_TPM[index_pre_spliced ,]</span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;C:/Users/Haozhe Wang/OneDrive/desktop&quot;</span>)</span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a><span class="fu">write.csv</span>(isoform_TPM_index_pre_spliced, <span class="st">&quot;isoform_TPM_index_pre_spliced.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a></span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a><span class="fu">write.csv</span>(pre_TPM_index_pre_spliced, <span class="st">&quot;pre_TPM_index_pre_spliced.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a></span>
<span id="cb10-40"><a href="#cb10-40" tabindex="-1"></a><span class="fu">write.csv</span>(spliced_TPM_index_pre_spliced, <span class="st">&quot;spliced_TPM_index_pre_spliced.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>We will get the following data in
VeloRM_data/RNA-Seq_A-to-I/origin</p>
<p>Download Data</p>
<p>The following raw data files are required:</p>
<p>cell.colors.rds and cell_colors_data.csv</p>
<p>classification.csv</p>
<p>embedding.rds and embedding_data.csv</p>
<p>SraRunTable_E12.5.csv</p>
<p>Processed Data</p>
<p>The following datasets are generated after preprocessing:</p>
<p>SNP_all.rds</p>
<p>bam_read_counts.csv</p>
<p>Frequency Data</p>
<p>Frequency matrices used for downstream analysis:</p>
<p>isoform_A_to_I.rds</p>
<p>pre_A_to_I.rds</p>
<p>spliced_A_to_I.rds</p>
<p>isoform_TPM_index_pre_spliced.csv</p>
<p>pre_TPM_index_pre_spliced.csv</p>
<p>spliced_TPM_index_pre_spliced.csv</p>
</div>
</div>
<div id="pre-process" class="section level2">
<h2>pre-process</h2>
<div id="extract-the-modification-read-counts-and-un-modification-read-counts" class="section level3">
<h3>extract the modification read counts and un-modification read
counts</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="do">##  pre</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>frequency_all <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_data/RNA-Seq_A-to-I/origin/pre_A_to_I.rds&quot;</span>)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>testSNP_all <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_data/RNA-Seq_A-to-I/origin/SNP_all.rds&quot;</span>)</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="fu">head</span>(frequency_all[[<span class="dv">1</span>]])</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>testSNP_all</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co"># get the number of cell number of sites</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>num_cell <span class="ot">&lt;-</span> <span class="fu">length</span>(frequency_all)</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>num_sites <span class="ot">&lt;-</span> <span class="fu">length</span>(testSNP_all)</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co"># get the index of the + - STAND </span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>strand <span class="ot">&lt;-</span> testSNP_all<span class="sc">$</span>transcript_strand</span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>strand_plus <span class="ot">&lt;-</span> <span class="fu">which</span>(strand<span class="sc">==</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>strand_minus <span class="ot">&lt;-</span> <span class="fu">which</span>(strand<span class="sc">==</span><span class="st">&quot;-&quot;</span>)</span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a>error_rate_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a>error_reads_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a>methylation_rate <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a>site_length_nomatch <span class="ot">&lt;-</span>  <span class="fu">which</span>(<span class="fu">lapply</span>(frequency_all, <span class="cf">function</span>(x) <span class="fu">dim</span>(x)[<span class="dv">1</span>])<span class="sc">!=</span><span class="fu">length</span>(testSNP_all))</span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_cell){</span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a>  </span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a>  <span class="co"># change to data frame and add strand column</span></span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a>  </span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a>  frequency_all[[i]] <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(frequency_all[[i]])</span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a>  </span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a>  <span class="co"># get methylated reads </span></span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a>  </span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a>  methylated_reads <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, num_sites)</span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a>  methylated_reads[strand_plus] <span class="ot">&lt;-</span> frequency_all[[i]][strand_plus,<span class="dv">3</span>]</span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a>  methylated_reads[strand_minus] <span class="ot">&lt;-</span>frequency_all[[i]][strand_minus,<span class="dv">4</span>]</span>
<span id="cb11-47"><a href="#cb11-47" tabindex="-1"></a>  </span>
<span id="cb11-48"><a href="#cb11-48" tabindex="-1"></a>  <span class="co"># get unmethylated reads </span></span>
<span id="cb11-49"><a href="#cb11-49" tabindex="-1"></a>  </span>
<span id="cb11-50"><a href="#cb11-50" tabindex="-1"></a>  unmethylated_reads <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, num_sites)</span>
<span id="cb11-51"><a href="#cb11-51" tabindex="-1"></a>  unmethylated_reads[strand_plus] <span class="ot">&lt;-</span> frequency_all[[i]][strand_plus,<span class="dv">1</span>]</span>
<span id="cb11-52"><a href="#cb11-52" tabindex="-1"></a>  unmethylated_reads[strand_minus] <span class="ot">&lt;-</span> frequency_all[[i]][strand_minus,<span class="dv">2</span>]</span>
<span id="cb11-53"><a href="#cb11-53" tabindex="-1"></a>  </span>
<span id="cb11-54"><a href="#cb11-54" tabindex="-1"></a>  </span>
<span id="cb11-55"><a href="#cb11-55" tabindex="-1"></a>  </span>
<span id="cb11-56"><a href="#cb11-56" tabindex="-1"></a>  <span class="co"># get error reads </span></span>
<span id="cb11-57"><a href="#cb11-57" tabindex="-1"></a>  </span>
<span id="cb11-58"><a href="#cb11-58" tabindex="-1"></a>  error_reads <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, num_sites)</span>
<span id="cb11-59"><a href="#cb11-59" tabindex="-1"></a>  error_reads[strand_plus] <span class="ot">&lt;-</span> frequency_all[[i]][strand_plus,<span class="dv">2</span>]<span class="sc">+</span>frequency_all[[i]][strand_plus,<span class="dv">4</span>]<span class="sc">+</span></span>
<span id="cb11-60"><a href="#cb11-60" tabindex="-1"></a>    frequency_all[[i]][strand_plus,<span class="dv">5</span>]</span>
<span id="cb11-61"><a href="#cb11-61" tabindex="-1"></a>  error_reads[strand_minus] <span class="ot">&lt;-</span> frequency_all[[i]][strand_minus,<span class="dv">1</span>]<span class="sc">+</span>frequency_all[[i]][strand_minus,<span class="dv">3</span>]<span class="sc">+</span></span>
<span id="cb11-62"><a href="#cb11-62" tabindex="-1"></a>    frequency_all[[i]][strand_minus,<span class="dv">5</span>]</span>
<span id="cb11-63"><a href="#cb11-63" tabindex="-1"></a>  </span>
<span id="cb11-64"><a href="#cb11-64" tabindex="-1"></a>  </span>
<span id="cb11-65"><a href="#cb11-65" tabindex="-1"></a>  </span>
<span id="cb11-66"><a href="#cb11-66" tabindex="-1"></a>  frequency_all[[i]] <span class="ot">&lt;-</span> frequency_all[[i]] <span class="sc">%&gt;%</span> </span>
<span id="cb11-67"><a href="#cb11-67" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">methylated_reads=</span>methylated_reads)<span class="sc">%&gt;%</span> </span>
<span id="cb11-68"><a href="#cb11-68" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">unmethylated_reads=</span>unmethylated_reads)<span class="sc">%&gt;%</span></span>
<span id="cb11-69"><a href="#cb11-69" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">error_reads=</span>error_reads)<span class="sc">%&gt;%</span> </span>
<span id="cb11-70"><a href="#cb11-70" tabindex="-1"></a>    <span class="fu">select</span>(methylated_reads,unmethylated_reads,error_reads)</span>
<span id="cb11-71"><a href="#cb11-71" tabindex="-1"></a>  </span>
<span id="cb11-72"><a href="#cb11-72" tabindex="-1"></a>  error_reads_list[[i]] <span class="ot">&lt;-</span>  frequency_all[[i]]<span class="sc">$</span>error_reads</span>
<span id="cb11-73"><a href="#cb11-73" tabindex="-1"></a>  </span>
<span id="cb11-74"><a href="#cb11-74" tabindex="-1"></a>  frequency_all[[i]] <span class="ot">&lt;-</span> frequency_all[[i]] <span class="sc">%&gt;%</span></span>
<span id="cb11-75"><a href="#cb11-75" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">methylated_reads=</span>methylated_reads)<span class="sc">%&gt;%</span></span>
<span id="cb11-76"><a href="#cb11-76" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">unmethylated_reads=</span>unmethylated_reads)<span class="sc">%&gt;%</span></span>
<span id="cb11-77"><a href="#cb11-77" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">error_rate=</span>error_reads<span class="sc">/</span>(methylated_reads<span class="sc">+</span>unmethylated_reads<span class="sc">+</span>error_reads))<span class="sc">%&gt;%</span></span>
<span id="cb11-78"><a href="#cb11-78" tabindex="-1"></a>    <span class="fu">select</span>(methylated_reads,unmethylated_reads,error_rate)</span>
<span id="cb11-79"><a href="#cb11-79" tabindex="-1"></a>  </span>
<span id="cb11-80"><a href="#cb11-80" tabindex="-1"></a>  error_rate_list[[i]] <span class="ot">&lt;-</span>  frequency_all[[i]]<span class="sc">$</span>error_rate</span>
<span id="cb11-81"><a href="#cb11-81" tabindex="-1"></a>  frequency_all[[i]] <span class="ot">&lt;-</span> frequency_all[[i]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(methylated_reads,unmethylated_reads)</span>
<span id="cb11-82"><a href="#cb11-82" tabindex="-1"></a>  </span>
<span id="cb11-83"><a href="#cb11-83" tabindex="-1"></a>  methylation_rate[[i]] <span class="ot">&lt;-</span> frequency_all[[i]]<span class="sc">$</span>methylated_reads<span class="sc">/</span>(frequency_all[[i]]<span class="sc">$</span>methylated_reads<span class="sc">+</span>frequency_all[[i]]<span class="sc">$</span>unmethylated_reads)</span>
<span id="cb11-84"><a href="#cb11-84" tabindex="-1"></a>}</span>
<span id="cb11-85"><a href="#cb11-85" tabindex="-1"></a></span>
<span id="cb11-86"><a href="#cb11-86" tabindex="-1"></a></span>
<span id="cb11-87"><a href="#cb11-87" tabindex="-1"></a></span>
<span id="cb11-88"><a href="#cb11-88" tabindex="-1"></a></span>
<span id="cb11-89"><a href="#cb11-89" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_data/RNA-Seq_A-to-I/pre_process&quot;</span>)</span>
<span id="cb11-90"><a href="#cb11-90" tabindex="-1"></a><span class="fu">saveRDS</span>(error_rate_list,<span class="st">&quot;error_rate_list_pre.rds&quot;</span>)</span>
<span id="cb11-91"><a href="#cb11-91" tabindex="-1"></a><span class="fu">saveRDS</span>(frequency_all,<span class="st">&quot;reads_counts_pre.rds&quot;</span>)</span>
<span id="cb11-92"><a href="#cb11-92" tabindex="-1"></a><span class="fu">saveRDS</span>(error_reads_list,<span class="st">&quot;error_reads_list_pre.rds&quot;</span>)</span>
<span id="cb11-93"><a href="#cb11-93" tabindex="-1"></a><span class="fu">saveRDS</span>(methylation_rate,<span class="st">&quot;methylation_rate_pre.rds&quot;</span>)</span>
<span id="cb11-94"><a href="#cb11-94" tabindex="-1"></a></span>
<span id="cb11-95"><a href="#cb11-95" tabindex="-1"></a></span>
<span id="cb11-96"><a href="#cb11-96" tabindex="-1"></a></span>
<span id="cb11-97"><a href="#cb11-97" tabindex="-1"></a><span class="do">##  spliced</span></span>
<span id="cb11-98"><a href="#cb11-98" tabindex="-1"></a></span>
<span id="cb11-99"><a href="#cb11-99" tabindex="-1"></a></span>
<span id="cb11-100"><a href="#cb11-100" tabindex="-1"></a></span>
<span id="cb11-101"><a href="#cb11-101" tabindex="-1"></a>frequency_all <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_data/RNA-Seq_A-to-I/origin/spliced_A_to_I.rds&quot;</span>)</span>
<span id="cb11-102"><a href="#cb11-102" tabindex="-1"></a></span>
<span id="cb11-103"><a href="#cb11-103" tabindex="-1"></a></span>
<span id="cb11-104"><a href="#cb11-104" tabindex="-1"></a></span>
<span id="cb11-105"><a href="#cb11-105" tabindex="-1"></a>testSNP_all <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_data/RNA-Seq_A-to-I/origin/SNP_all.rds&quot;</span>)</span>
<span id="cb11-106"><a href="#cb11-106" tabindex="-1"></a></span>
<span id="cb11-107"><a href="#cb11-107" tabindex="-1"></a></span>
<span id="cb11-108"><a href="#cb11-108" tabindex="-1"></a><span class="fu">head</span>(frequency_all[[<span class="dv">1</span>]])</span>
<span id="cb11-109"><a href="#cb11-109" tabindex="-1"></a>testSNP_all</span>
<span id="cb11-110"><a href="#cb11-110" tabindex="-1"></a></span>
<span id="cb11-111"><a href="#cb11-111" tabindex="-1"></a></span>
<span id="cb11-112"><a href="#cb11-112" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb11-113"><a href="#cb11-113" tabindex="-1"></a><span class="co"># get the number of cell number of sites</span></span>
<span id="cb11-114"><a href="#cb11-114" tabindex="-1"></a></span>
<span id="cb11-115"><a href="#cb11-115" tabindex="-1"></a>num_cell <span class="ot">&lt;-</span> <span class="fu">length</span>(frequency_all)</span>
<span id="cb11-116"><a href="#cb11-116" tabindex="-1"></a>num_sites <span class="ot">&lt;-</span> <span class="fu">length</span>(testSNP_all)</span>
<span id="cb11-117"><a href="#cb11-117" tabindex="-1"></a></span>
<span id="cb11-118"><a href="#cb11-118" tabindex="-1"></a><span class="co"># get the index of the + - STAND </span></span>
<span id="cb11-119"><a href="#cb11-119" tabindex="-1"></a></span>
<span id="cb11-120"><a href="#cb11-120" tabindex="-1"></a>strand <span class="ot">&lt;-</span> testSNP_all<span class="sc">$</span>transcript_strand</span>
<span id="cb11-121"><a href="#cb11-121" tabindex="-1"></a>strand_plus <span class="ot">&lt;-</span> <span class="fu">which</span>(strand<span class="sc">==</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb11-122"><a href="#cb11-122" tabindex="-1"></a>strand_minus <span class="ot">&lt;-</span> <span class="fu">which</span>(strand<span class="sc">==</span><span class="st">&quot;-&quot;</span>)</span>
<span id="cb11-123"><a href="#cb11-123" tabindex="-1"></a></span>
<span id="cb11-124"><a href="#cb11-124" tabindex="-1"></a>error_rate_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-125"><a href="#cb11-125" tabindex="-1"></a></span>
<span id="cb11-126"><a href="#cb11-126" tabindex="-1"></a>error_reads_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-127"><a href="#cb11-127" tabindex="-1"></a>methylation_rate <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-128"><a href="#cb11-128" tabindex="-1"></a></span>
<span id="cb11-129"><a href="#cb11-129" tabindex="-1"></a>site_length_nomatch <span class="ot">&lt;-</span>  <span class="fu">which</span>(<span class="fu">lapply</span>(frequency_all, <span class="cf">function</span>(x) <span class="fu">dim</span>(x)[<span class="dv">1</span>])<span class="sc">!=</span><span class="fu">length</span>(testSNP_all))</span>
<span id="cb11-130"><a href="#cb11-130" tabindex="-1"></a></span>
<span id="cb11-131"><a href="#cb11-131" tabindex="-1"></a></span>
<span id="cb11-132"><a href="#cb11-132" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_cell){</span>
<span id="cb11-133"><a href="#cb11-133" tabindex="-1"></a>  </span>
<span id="cb11-134"><a href="#cb11-134" tabindex="-1"></a>  <span class="co"># change to data frame and add strand column</span></span>
<span id="cb11-135"><a href="#cb11-135" tabindex="-1"></a>  </span>
<span id="cb11-136"><a href="#cb11-136" tabindex="-1"></a>  frequency_all[[i]] <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(frequency_all[[i]])</span>
<span id="cb11-137"><a href="#cb11-137" tabindex="-1"></a>  </span>
<span id="cb11-138"><a href="#cb11-138" tabindex="-1"></a>  <span class="co"># get methylated reads </span></span>
<span id="cb11-139"><a href="#cb11-139" tabindex="-1"></a>  </span>
<span id="cb11-140"><a href="#cb11-140" tabindex="-1"></a>  methylated_reads <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, num_sites)</span>
<span id="cb11-141"><a href="#cb11-141" tabindex="-1"></a>  methylated_reads[strand_plus] <span class="ot">&lt;-</span> frequency_all[[i]][strand_plus,<span class="dv">3</span>]</span>
<span id="cb11-142"><a href="#cb11-142" tabindex="-1"></a>  methylated_reads[strand_minus] <span class="ot">&lt;-</span>frequency_all[[i]][strand_minus,<span class="dv">4</span>]</span>
<span id="cb11-143"><a href="#cb11-143" tabindex="-1"></a>  </span>
<span id="cb11-144"><a href="#cb11-144" tabindex="-1"></a>  <span class="co"># get unmethylated reads </span></span>
<span id="cb11-145"><a href="#cb11-145" tabindex="-1"></a>  </span>
<span id="cb11-146"><a href="#cb11-146" tabindex="-1"></a>  unmethylated_reads <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, num_sites)</span>
<span id="cb11-147"><a href="#cb11-147" tabindex="-1"></a>  unmethylated_reads[strand_plus] <span class="ot">&lt;-</span> frequency_all[[i]][strand_plus,<span class="dv">1</span>]</span>
<span id="cb11-148"><a href="#cb11-148" tabindex="-1"></a>  unmethylated_reads[strand_minus] <span class="ot">&lt;-</span> frequency_all[[i]][strand_minus,<span class="dv">2</span>]</span>
<span id="cb11-149"><a href="#cb11-149" tabindex="-1"></a>  </span>
<span id="cb11-150"><a href="#cb11-150" tabindex="-1"></a>  </span>
<span id="cb11-151"><a href="#cb11-151" tabindex="-1"></a>  </span>
<span id="cb11-152"><a href="#cb11-152" tabindex="-1"></a>  <span class="co"># get error reads </span></span>
<span id="cb11-153"><a href="#cb11-153" tabindex="-1"></a>  </span>
<span id="cb11-154"><a href="#cb11-154" tabindex="-1"></a>  error_reads <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, num_sites)</span>
<span id="cb11-155"><a href="#cb11-155" tabindex="-1"></a>  error_reads[strand_plus] <span class="ot">&lt;-</span> frequency_all[[i]][strand_plus,<span class="dv">2</span>]<span class="sc">+</span>frequency_all[[i]][strand_plus,<span class="dv">4</span>]<span class="sc">+</span></span>
<span id="cb11-156"><a href="#cb11-156" tabindex="-1"></a>    frequency_all[[i]][strand_plus,<span class="dv">5</span>]</span>
<span id="cb11-157"><a href="#cb11-157" tabindex="-1"></a>  error_reads[strand_minus] <span class="ot">&lt;-</span> frequency_all[[i]][strand_minus,<span class="dv">1</span>]<span class="sc">+</span>frequency_all[[i]][strand_minus,<span class="dv">3</span>]<span class="sc">+</span></span>
<span id="cb11-158"><a href="#cb11-158" tabindex="-1"></a>    frequency_all[[i]][strand_minus,<span class="dv">5</span>]</span>
<span id="cb11-159"><a href="#cb11-159" tabindex="-1"></a>  </span>
<span id="cb11-160"><a href="#cb11-160" tabindex="-1"></a>  </span>
<span id="cb11-161"><a href="#cb11-161" tabindex="-1"></a>  </span>
<span id="cb11-162"><a href="#cb11-162" tabindex="-1"></a>  frequency_all[[i]] <span class="ot">&lt;-</span> frequency_all[[i]] <span class="sc">%&gt;%</span> </span>
<span id="cb11-163"><a href="#cb11-163" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">methylated_reads=</span>methylated_reads)<span class="sc">%&gt;%</span> </span>
<span id="cb11-164"><a href="#cb11-164" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">unmethylated_reads=</span>unmethylated_reads)<span class="sc">%&gt;%</span></span>
<span id="cb11-165"><a href="#cb11-165" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">error_reads=</span>error_reads)<span class="sc">%&gt;%</span> </span>
<span id="cb11-166"><a href="#cb11-166" tabindex="-1"></a>    <span class="fu">select</span>(methylated_reads,unmethylated_reads,error_reads)</span>
<span id="cb11-167"><a href="#cb11-167" tabindex="-1"></a>  </span>
<span id="cb11-168"><a href="#cb11-168" tabindex="-1"></a>  error_reads_list[[i]] <span class="ot">&lt;-</span>  frequency_all[[i]]<span class="sc">$</span>error_reads</span>
<span id="cb11-169"><a href="#cb11-169" tabindex="-1"></a>  </span>
<span id="cb11-170"><a href="#cb11-170" tabindex="-1"></a>  frequency_all[[i]] <span class="ot">&lt;-</span> frequency_all[[i]] <span class="sc">%&gt;%</span></span>
<span id="cb11-171"><a href="#cb11-171" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">methylated_reads=</span>methylated_reads)<span class="sc">%&gt;%</span></span>
<span id="cb11-172"><a href="#cb11-172" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">unmethylated_reads=</span>unmethylated_reads)<span class="sc">%&gt;%</span></span>
<span id="cb11-173"><a href="#cb11-173" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">error_rate=</span>error_reads<span class="sc">/</span>(methylated_reads<span class="sc">+</span>unmethylated_reads<span class="sc">+</span>error_reads))<span class="sc">%&gt;%</span></span>
<span id="cb11-174"><a href="#cb11-174" tabindex="-1"></a>    <span class="fu">select</span>(methylated_reads,unmethylated_reads,error_rate)</span>
<span id="cb11-175"><a href="#cb11-175" tabindex="-1"></a>  </span>
<span id="cb11-176"><a href="#cb11-176" tabindex="-1"></a>  error_rate_list[[i]] <span class="ot">&lt;-</span>  frequency_all[[i]]<span class="sc">$</span>error_rate</span>
<span id="cb11-177"><a href="#cb11-177" tabindex="-1"></a>  frequency_all[[i]] <span class="ot">&lt;-</span> frequency_all[[i]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(methylated_reads,unmethylated_reads)</span>
<span id="cb11-178"><a href="#cb11-178" tabindex="-1"></a>  </span>
<span id="cb11-179"><a href="#cb11-179" tabindex="-1"></a>  methylation_rate[[i]] <span class="ot">&lt;-</span> frequency_all[[i]]<span class="sc">$</span>methylated_reads<span class="sc">/</span>(frequency_all[[i]]<span class="sc">$</span>methylated_reads<span class="sc">+</span>frequency_all[[i]]<span class="sc">$</span>unmethylated_reads)</span>
<span id="cb11-180"><a href="#cb11-180" tabindex="-1"></a>}</span>
<span id="cb11-181"><a href="#cb11-181" tabindex="-1"></a></span>
<span id="cb11-182"><a href="#cb11-182" tabindex="-1"></a></span>
<span id="cb11-183"><a href="#cb11-183" tabindex="-1"></a></span>
<span id="cb11-184"><a href="#cb11-184" tabindex="-1"></a></span>
<span id="cb11-185"><a href="#cb11-185" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_data/RNA-Seq_A-to-I/pre_process&quot;</span>)</span>
<span id="cb11-186"><a href="#cb11-186" tabindex="-1"></a><span class="fu">saveRDS</span>(error_rate_list,<span class="st">&quot;error_rate_list_spliced.rds&quot;</span>)</span>
<span id="cb11-187"><a href="#cb11-187" tabindex="-1"></a><span class="fu">saveRDS</span>(frequency_all,<span class="st">&quot;reads_counts_spliced.rds&quot;</span>)</span>
<span id="cb11-188"><a href="#cb11-188" tabindex="-1"></a><span class="fu">saveRDS</span>(error_reads_list,<span class="st">&quot;error_reads_list_spliced.rds&quot;</span>)</span>
<span id="cb11-189"><a href="#cb11-189" tabindex="-1"></a><span class="fu">saveRDS</span>(methylation_rate,<span class="st">&quot;methylation_rate_spliced.rds&quot;</span>)</span>
<span id="cb11-190"><a href="#cb11-190" tabindex="-1"></a></span>
<span id="cb11-191"><a href="#cb11-191" tabindex="-1"></a></span>
<span id="cb11-192"><a href="#cb11-192" tabindex="-1"></a><span class="do">##  isoform</span></span>
<span id="cb11-193"><a href="#cb11-193" tabindex="-1"></a></span>
<span id="cb11-194"><a href="#cb11-194" tabindex="-1"></a></span>
<span id="cb11-195"><a href="#cb11-195" tabindex="-1"></a></span>
<span id="cb11-196"><a href="#cb11-196" tabindex="-1"></a>frequency_all <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_data/RNA-Seq_A-to-I/origin/isoform_A_to_I.rds&quot;</span>)</span>
<span id="cb11-197"><a href="#cb11-197" tabindex="-1"></a></span>
<span id="cb11-198"><a href="#cb11-198" tabindex="-1"></a></span>
<span id="cb11-199"><a href="#cb11-199" tabindex="-1"></a>testSNP_all <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_data/RNA-Seq_A-to-I/origin/SNP_all.rds&quot;</span>)</span>
<span id="cb11-200"><a href="#cb11-200" tabindex="-1"></a></span>
<span id="cb11-201"><a href="#cb11-201" tabindex="-1"></a></span>
<span id="cb11-202"><a href="#cb11-202" tabindex="-1"></a><span class="fu">head</span>(frequency_all[[<span class="dv">1</span>]])</span>
<span id="cb11-203"><a href="#cb11-203" tabindex="-1"></a>testSNP_all</span>
<span id="cb11-204"><a href="#cb11-204" tabindex="-1"></a></span>
<span id="cb11-205"><a href="#cb11-205" tabindex="-1"></a></span>
<span id="cb11-206"><a href="#cb11-206" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb11-207"><a href="#cb11-207" tabindex="-1"></a><span class="co"># get the number of cell number of sites</span></span>
<span id="cb11-208"><a href="#cb11-208" tabindex="-1"></a></span>
<span id="cb11-209"><a href="#cb11-209" tabindex="-1"></a>num_cell <span class="ot">&lt;-</span> <span class="fu">length</span>(frequency_all)</span>
<span id="cb11-210"><a href="#cb11-210" tabindex="-1"></a>num_sites <span class="ot">&lt;-</span> <span class="fu">length</span>(testSNP_all)</span>
<span id="cb11-211"><a href="#cb11-211" tabindex="-1"></a></span>
<span id="cb11-212"><a href="#cb11-212" tabindex="-1"></a><span class="co"># get the index of the + - STAND </span></span>
<span id="cb11-213"><a href="#cb11-213" tabindex="-1"></a></span>
<span id="cb11-214"><a href="#cb11-214" tabindex="-1"></a>strand <span class="ot">&lt;-</span> testSNP_all<span class="sc">$</span>transcript_strand</span>
<span id="cb11-215"><a href="#cb11-215" tabindex="-1"></a>strand_plus <span class="ot">&lt;-</span> <span class="fu">which</span>(strand<span class="sc">==</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb11-216"><a href="#cb11-216" tabindex="-1"></a>strand_minus <span class="ot">&lt;-</span> <span class="fu">which</span>(strand<span class="sc">==</span><span class="st">&quot;-&quot;</span>)</span>
<span id="cb11-217"><a href="#cb11-217" tabindex="-1"></a></span>
<span id="cb11-218"><a href="#cb11-218" tabindex="-1"></a>error_rate_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-219"><a href="#cb11-219" tabindex="-1"></a></span>
<span id="cb11-220"><a href="#cb11-220" tabindex="-1"></a>error_reads_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-221"><a href="#cb11-221" tabindex="-1"></a>methylation_rate <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-222"><a href="#cb11-222" tabindex="-1"></a></span>
<span id="cb11-223"><a href="#cb11-223" tabindex="-1"></a>site_length_nomatch <span class="ot">&lt;-</span>  <span class="fu">which</span>(<span class="fu">lapply</span>(frequency_all, <span class="cf">function</span>(x) <span class="fu">dim</span>(x)[<span class="dv">1</span>])<span class="sc">!=</span><span class="fu">length</span>(testSNP_all))</span>
<span id="cb11-224"><a href="#cb11-224" tabindex="-1"></a></span>
<span id="cb11-225"><a href="#cb11-225" tabindex="-1"></a></span>
<span id="cb11-226"><a href="#cb11-226" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_cell){</span>
<span id="cb11-227"><a href="#cb11-227" tabindex="-1"></a>  </span>
<span id="cb11-228"><a href="#cb11-228" tabindex="-1"></a>  <span class="co"># change to data frame and add strand column</span></span>
<span id="cb11-229"><a href="#cb11-229" tabindex="-1"></a>  </span>
<span id="cb11-230"><a href="#cb11-230" tabindex="-1"></a>  frequency_all[[i]] <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(frequency_all[[i]])</span>
<span id="cb11-231"><a href="#cb11-231" tabindex="-1"></a>  </span>
<span id="cb11-232"><a href="#cb11-232" tabindex="-1"></a>  <span class="co"># get methylated reads </span></span>
<span id="cb11-233"><a href="#cb11-233" tabindex="-1"></a>  </span>
<span id="cb11-234"><a href="#cb11-234" tabindex="-1"></a>  methylated_reads <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, num_sites)</span>
<span id="cb11-235"><a href="#cb11-235" tabindex="-1"></a>  methylated_reads[strand_plus] <span class="ot">&lt;-</span> frequency_all[[i]][strand_plus,<span class="dv">3</span>]</span>
<span id="cb11-236"><a href="#cb11-236" tabindex="-1"></a>  methylated_reads[strand_minus] <span class="ot">&lt;-</span>frequency_all[[i]][strand_minus,<span class="dv">4</span>]</span>
<span id="cb11-237"><a href="#cb11-237" tabindex="-1"></a>  </span>
<span id="cb11-238"><a href="#cb11-238" tabindex="-1"></a>  <span class="co"># get unmethylated reads </span></span>
<span id="cb11-239"><a href="#cb11-239" tabindex="-1"></a>  </span>
<span id="cb11-240"><a href="#cb11-240" tabindex="-1"></a>  unmethylated_reads <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, num_sites)</span>
<span id="cb11-241"><a href="#cb11-241" tabindex="-1"></a>  unmethylated_reads[strand_plus] <span class="ot">&lt;-</span> frequency_all[[i]][strand_plus,<span class="dv">1</span>]</span>
<span id="cb11-242"><a href="#cb11-242" tabindex="-1"></a>  unmethylated_reads[strand_minus] <span class="ot">&lt;-</span> frequency_all[[i]][strand_minus,<span class="dv">2</span>]</span>
<span id="cb11-243"><a href="#cb11-243" tabindex="-1"></a>  </span>
<span id="cb11-244"><a href="#cb11-244" tabindex="-1"></a>  </span>
<span id="cb11-245"><a href="#cb11-245" tabindex="-1"></a>  </span>
<span id="cb11-246"><a href="#cb11-246" tabindex="-1"></a>  <span class="co"># get error reads </span></span>
<span id="cb11-247"><a href="#cb11-247" tabindex="-1"></a>  </span>
<span id="cb11-248"><a href="#cb11-248" tabindex="-1"></a>  error_reads <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, num_sites)</span>
<span id="cb11-249"><a href="#cb11-249" tabindex="-1"></a>  error_reads[strand_plus] <span class="ot">&lt;-</span> frequency_all[[i]][strand_plus,<span class="dv">2</span>]<span class="sc">+</span>frequency_all[[i]][strand_plus,<span class="dv">4</span>]<span class="sc">+</span></span>
<span id="cb11-250"><a href="#cb11-250" tabindex="-1"></a>    frequency_all[[i]][strand_plus,<span class="dv">5</span>]</span>
<span id="cb11-251"><a href="#cb11-251" tabindex="-1"></a>  error_reads[strand_minus] <span class="ot">&lt;-</span> frequency_all[[i]][strand_minus,<span class="dv">1</span>]<span class="sc">+</span>frequency_all[[i]][strand_minus,<span class="dv">3</span>]<span class="sc">+</span></span>
<span id="cb11-252"><a href="#cb11-252" tabindex="-1"></a>    frequency_all[[i]][strand_minus,<span class="dv">5</span>]</span>
<span id="cb11-253"><a href="#cb11-253" tabindex="-1"></a>  </span>
<span id="cb11-254"><a href="#cb11-254" tabindex="-1"></a>  </span>
<span id="cb11-255"><a href="#cb11-255" tabindex="-1"></a>  </span>
<span id="cb11-256"><a href="#cb11-256" tabindex="-1"></a>  frequency_all[[i]] <span class="ot">&lt;-</span> frequency_all[[i]] <span class="sc">%&gt;%</span> </span>
<span id="cb11-257"><a href="#cb11-257" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">methylated_reads=</span>methylated_reads)<span class="sc">%&gt;%</span> </span>
<span id="cb11-258"><a href="#cb11-258" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">unmethylated_reads=</span>unmethylated_reads)<span class="sc">%&gt;%</span></span>
<span id="cb11-259"><a href="#cb11-259" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">error_reads=</span>error_reads)<span class="sc">%&gt;%</span> </span>
<span id="cb11-260"><a href="#cb11-260" tabindex="-1"></a>    <span class="fu">select</span>(methylated_reads,unmethylated_reads,error_reads)</span>
<span id="cb11-261"><a href="#cb11-261" tabindex="-1"></a>  </span>
<span id="cb11-262"><a href="#cb11-262" tabindex="-1"></a>  error_reads_list[[i]] <span class="ot">&lt;-</span>  frequency_all[[i]]<span class="sc">$</span>error_reads</span>
<span id="cb11-263"><a href="#cb11-263" tabindex="-1"></a>  </span>
<span id="cb11-264"><a href="#cb11-264" tabindex="-1"></a>  frequency_all[[i]] <span class="ot">&lt;-</span> frequency_all[[i]] <span class="sc">%&gt;%</span></span>
<span id="cb11-265"><a href="#cb11-265" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">methylated_reads=</span>methylated_reads)<span class="sc">%&gt;%</span></span>
<span id="cb11-266"><a href="#cb11-266" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">unmethylated_reads=</span>unmethylated_reads)<span class="sc">%&gt;%</span></span>
<span id="cb11-267"><a href="#cb11-267" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">error_rate=</span>error_reads<span class="sc">/</span>(methylated_reads<span class="sc">+</span>unmethylated_reads<span class="sc">+</span>error_reads))<span class="sc">%&gt;%</span></span>
<span id="cb11-268"><a href="#cb11-268" tabindex="-1"></a>    <span class="fu">select</span>(methylated_reads,unmethylated_reads,error_rate)</span>
<span id="cb11-269"><a href="#cb11-269" tabindex="-1"></a>  </span>
<span id="cb11-270"><a href="#cb11-270" tabindex="-1"></a>  error_rate_list[[i]] <span class="ot">&lt;-</span>  frequency_all[[i]]<span class="sc">$</span>error_rate</span>
<span id="cb11-271"><a href="#cb11-271" tabindex="-1"></a>  frequency_all[[i]] <span class="ot">&lt;-</span> frequency_all[[i]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(methylated_reads,unmethylated_reads)</span>
<span id="cb11-272"><a href="#cb11-272" tabindex="-1"></a>  </span>
<span id="cb11-273"><a href="#cb11-273" tabindex="-1"></a>  methylation_rate[[i]] <span class="ot">&lt;-</span> frequency_all[[i]]<span class="sc">$</span>methylated_reads<span class="sc">/</span>(frequency_all[[i]]<span class="sc">$</span>methylated_reads<span class="sc">+</span>frequency_all[[i]]<span class="sc">$</span>unmethylated_reads)</span>
<span id="cb11-274"><a href="#cb11-274" tabindex="-1"></a>}</span>
<span id="cb11-275"><a href="#cb11-275" tabindex="-1"></a></span>
<span id="cb11-276"><a href="#cb11-276" tabindex="-1"></a></span>
<span id="cb11-277"><a href="#cb11-277" tabindex="-1"></a></span>
<span id="cb11-278"><a href="#cb11-278" tabindex="-1"></a></span>
<span id="cb11-279"><a href="#cb11-279" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_data/RNA-Seq_A-to-I/pre_process&quot;</span>)</span>
<span id="cb11-280"><a href="#cb11-280" tabindex="-1"></a><span class="fu">saveRDS</span>(error_rate_list,<span class="st">&quot;error_rate_list_isoform.rds&quot;</span>)</span>
<span id="cb11-281"><a href="#cb11-281" tabindex="-1"></a><span class="fu">saveRDS</span>(frequency_all,<span class="st">&quot;reads_counts_isoform.rds&quot;</span>)</span>
<span id="cb11-282"><a href="#cb11-282" tabindex="-1"></a><span class="fu">saveRDS</span>(error_reads_list,<span class="st">&quot;error_reads_list_isoform.rds&quot;</span>)</span>
<span id="cb11-283"><a href="#cb11-283" tabindex="-1"></a><span class="fu">saveRDS</span>(methylation_rate,<span class="st">&quot;methylation_rate_isoform.rds&quot;</span>)</span></code></pre></div>
</div>
<div id="calculate-the-error-rate-for-site" class="section level3">
<h3>calculate the error rate for site</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># calculate teh meta_error_rate for each site</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="do">## spliced</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>error_reads_list_spliced <span class="ot">&lt;-</span> </span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  <span class="fu">readRDS</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/error_reads_list_spliced.rds&quot;</span>)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>error_reads_list_spliced_sum <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="st">&quot;+&quot;</span>, error_reads_list_spliced)</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>reads_counts_spliced <span class="ot">&lt;-</span> </span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>  <span class="fu">readRDS</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/reads_counts_spliced.rds&quot;</span>)</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>summed_vectors_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(reads_counts_spliced, <span class="cf">function</span>(df) <span class="fu">rowSums</span>(df))</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>reads_counts_spliced_sum <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="st">&quot;+&quot;</span>, summed_vectors_list)</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>error_rate_meta_spliced <span class="ot">&lt;-</span> error_reads_list_spliced_sum<span class="sc">/</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>  (error_reads_list_spliced_sum<span class="sc">+</span>reads_counts_spliced_sum) </span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="fu">saveRDS</span>(error_rate_meta_spliced,<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/error_rate_meta_spliced.rds&quot;</span>)</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="do">## pre</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a>error_reads_list_pre <span class="ot">&lt;-</span> </span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a>  <span class="fu">readRDS</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/error_reads_list_pre.rds&quot;</span>)</span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a>error_reads_list_pre_sum <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="st">&quot;+&quot;</span>, error_reads_list_pre)</span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a></span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a>reads_counts_pre <span class="ot">&lt;-</span> </span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a>  <span class="fu">readRDS</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/reads_counts_pre.rds&quot;</span>)</span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a></span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a>summed_vectors_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(reads_counts_pre, <span class="cf">function</span>(df) <span class="fu">rowSums</span>(df))</span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a></span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a>reads_counts_pre_sum <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="st">&quot;+&quot;</span>, summed_vectors_list)</span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a></span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a>error_rate_meta_pre <span class="ot">&lt;-</span> error_reads_list_pre_sum<span class="sc">/</span></span>
<span id="cb12-41"><a href="#cb12-41" tabindex="-1"></a>  (error_reads_list_pre_sum<span class="sc">+</span>reads_counts_pre_sum) </span>
<span id="cb12-42"><a href="#cb12-42" tabindex="-1"></a></span>
<span id="cb12-43"><a href="#cb12-43" tabindex="-1"></a><span class="fu">saveRDS</span>(error_rate_meta_pre,<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/error_rate_meta_pre.rds&quot;</span>)</span></code></pre></div>
</div>
<div id="filter-the-site" class="section level3">
<h3>filter the site</h3>
<p>From the initial analysis of 1,152 cells, we identified 48,556
potential editing sites. After applying stringent quality filters that
excluded sites with error rates exceeding 1%, we retained 1,159
high-confidence A-to-I editing sites. To ensure data reliability, we
further filtered the dataset by removing cells with fewer than 200 reads
in either spliced or unspliced mRNA fractions, resulting in a final set
of 1,119 cells for downstream analysis.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">library</span>(VeloRM)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co"># Read metadata</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>error_rate_meta_spliced <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/error_rate_meta_spliced.rds&quot;</span>)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>error_rate_meta_pre <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/error_rate_meta_pre.rds&quot;</span>)</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>index_error <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">which</span>(error_rate_meta_spliced <span class="sc">&lt;=</span> <span class="fl">0.01</span>), <span class="fu">which</span>(error_rate_meta_pre <span class="sc">&lt;=</span> <span class="fl">0.01</span>))</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co"># Read counts</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>reads_counts_spliced<span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/reads_counts_spliced.rds&quot;</span>)</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="co"># Process spliced data</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>spliced_meth_test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(reads_counts_spliced, <span class="cf">function</span>(df) df[[<span class="st">&quot;methylated_reads&quot;</span>]]))</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>spliced_unmeth_test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(reads_counts_spliced, <span class="cf">function</span>(df) df[[<span class="st">&quot;unmethylated_reads&quot;</span>]]))</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>reads_counts_pre<span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/reads_counts_pre.rds&quot;</span>)</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="co"># Process spliced data</span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>pre_meth_test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(reads_counts_pre, <span class="cf">function</span>(df) df[[<span class="st">&quot;methylated_reads&quot;</span>]]))</span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a>pre_unmeth_test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(reads_counts_pre, <span class="cf">function</span>(df) df[[<span class="st">&quot;unmethylated_reads&quot;</span>]]))</span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="co"># Set row names</span></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="fu">rownames</span>(spliced_meth_test) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(spliced_unmeth_test) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;site_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(spliced_unmeth_test)[<span class="dv">1</span>])</span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a><span class="fu">rownames</span>(pre_meth_test) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(pre_unmeth_test)  <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;site_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(pre_unmeth_test)[<span class="dv">1</span>])</span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a></span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a><span class="co"># Calculate spliced and pre-mRNA test matrices</span></span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a>spliced_test <span class="ot">&lt;-</span> spliced_meth_test<span class="sc">+</span>spliced_unmeth_test</span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a></span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a></span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a>pre_test <span class="ot">&lt;-</span> pre_meth_test <span class="sc">+</span> pre_unmeth_test</span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a></span>
<span id="cb13-39"><a href="#cb13-39" tabindex="-1"></a><span class="co">#discard the cell have lower reads</span></span>
<span id="cb13-40"><a href="#cb13-40" tabindex="-1"></a>index_cell_discard_spliced <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colSums</span>(spliced_test)<span class="sc">&lt;=</span><span class="dv">200</span>)</span>
<span id="cb13-41"><a href="#cb13-41" tabindex="-1"></a>index_cell_discard_pre <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colSums</span>(pre_test)<span class="sc">&lt;=</span><span class="dv">200</span>)</span>
<span id="cb13-42"><a href="#cb13-42" tabindex="-1"></a></span>
<span id="cb13-43"><a href="#cb13-43" tabindex="-1"></a>spliced_test_discarded <span class="ot">&lt;-</span> spliced_test[,<span class="sc">-</span><span class="fu">union</span>(index_cell_discard_spliced,index_cell_discard_pre)]</span>
<span id="cb13-44"><a href="#cb13-44" tabindex="-1"></a>pre_test_discarded <span class="ot">&lt;-</span> pre_test[,<span class="sc">-</span><span class="fu">union</span>(index_cell_discard_spliced,index_cell_discard_pre)]</span>
<span id="cb13-45"><a href="#cb13-45" tabindex="-1"></a></span>
<span id="cb13-46"><a href="#cb13-46" tabindex="-1"></a></span>
<span id="cb13-47"><a href="#cb13-47" tabindex="-1"></a></span>
<span id="cb13-48"><a href="#cb13-48" tabindex="-1"></a></span>
<span id="cb13-49"><a href="#cb13-49" tabindex="-1"></a>index <span class="ot">&lt;-</span> index_error</span>
<span id="cb13-50"><a href="#cb13-50" tabindex="-1"></a></span>
<span id="cb13-51"><a href="#cb13-51" tabindex="-1"></a>spliced_meth_test_processed <span class="ot">&lt;-</span> spliced_meth_test[index,<span class="sc">-</span><span class="fu">union</span>(index_cell_discard_spliced,index_cell_discard_pre)]</span>
<span id="cb13-52"><a href="#cb13-52" tabindex="-1"></a>spliced_unmeth_test_processed <span class="ot">&lt;-</span> spliced_unmeth_test[index,<span class="sc">-</span><span class="fu">union</span>(index_cell_discard_spliced,index_cell_discard_pre)]</span>
<span id="cb13-53"><a href="#cb13-53" tabindex="-1"></a>pre_meth_test_processed <span class="ot">&lt;-</span> pre_meth_test[index,<span class="sc">-</span><span class="fu">union</span>(index_cell_discard_spliced,index_cell_discard_pre)]</span>
<span id="cb13-54"><a href="#cb13-54" tabindex="-1"></a>pre_unmeth_test_processed <span class="ot">&lt;-</span> pre_unmeth_test[index,<span class="sc">-</span><span class="fu">union</span>(index_cell_discard_spliced,index_cell_discard_pre)]</span>
<span id="cb13-55"><a href="#cb13-55" tabindex="-1"></a></span>
<span id="cb13-56"><a href="#cb13-56" tabindex="-1"></a></span>
<span id="cb13-57"><a href="#cb13-57" tabindex="-1"></a><span class="fu">saveRDS</span>(<span class="fu">union</span>(index_cell_discard_spliced,index_cell_discard_pre),<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/index_cell_discard.rds&quot;</span>)</span>
<span id="cb13-58"><a href="#cb13-58" tabindex="-1"></a><span class="fu">saveRDS</span>(index_error,<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/index_error.rds&quot;</span>)</span>
<span id="cb13-59"><a href="#cb13-59" tabindex="-1"></a><span class="fu">saveRDS</span>(index,<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/index.rds&quot;</span>)</span>
<span id="cb13-60"><a href="#cb13-60" tabindex="-1"></a></span>
<span id="cb13-61"><a href="#cb13-61" tabindex="-1"></a></span>
<span id="cb13-62"><a href="#cb13-62" tabindex="-1"></a>reads_counts_isoform <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/reads_counts_isoform.rds&quot;</span>)</span>
<span id="cb13-63"><a href="#cb13-63" tabindex="-1"></a>reads_counts_isoform <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/reads_counts_isoform.rds&quot;</span>)</span>
<span id="cb13-64"><a href="#cb13-64" tabindex="-1"></a></span>
<span id="cb13-65"><a href="#cb13-65" tabindex="-1"></a><span class="co"># Process pre-mRNA data</span></span>
<span id="cb13-66"><a href="#cb13-66" tabindex="-1"></a>isoform_meth_test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(reads_counts_isoform, <span class="cf">function</span>(df) df[[<span class="st">&quot;methylated_reads&quot;</span>]]))</span>
<span id="cb13-67"><a href="#cb13-67" tabindex="-1"></a>isoform_unmeth_test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(reads_counts_isoform, <span class="cf">function</span>(df) df[[<span class="st">&quot;unmethylated_reads&quot;</span>]]))</span>
<span id="cb13-68"><a href="#cb13-68" tabindex="-1"></a></span>
<span id="cb13-69"><a href="#cb13-69" tabindex="-1"></a></span>
<span id="cb13-70"><a href="#cb13-70" tabindex="-1"></a></span>
<span id="cb13-71"><a href="#cb13-71" tabindex="-1"></a><span class="fu">rownames</span>(isoform_meth_test) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(isoform_unmeth_test) <span class="ot">&lt;-</span>  <span class="fu">paste0</span>(<span class="st">&quot;site_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(isoform_unmeth_test)[<span class="dv">1</span>])</span>
<span id="cb13-72"><a href="#cb13-72" tabindex="-1"></a></span>
<span id="cb13-73"><a href="#cb13-73" tabindex="-1"></a>isoform_meth_test_processed <span class="ot">&lt;-</span> isoform_meth_test[index,<span class="sc">-</span><span class="fu">union</span>(index_cell_discard_spliced,index_cell_discard_pre)]</span>
<span id="cb13-74"><a href="#cb13-74" tabindex="-1"></a>isoform_unmeth_test_processed <span class="ot">&lt;-</span> isoform_unmeth_test[index,<span class="sc">-</span><span class="fu">union</span>(index_cell_discard_spliced,index_cell_discard_pre)]</span>
<span id="cb13-75"><a href="#cb13-75" tabindex="-1"></a></span>
<span id="cb13-76"><a href="#cb13-76" tabindex="-1"></a>test.list <span class="ot">&lt;-</span> <span class="fu">list</span>(spliced_meth_test_processed,spliced_unmeth_test_processed,pre_meth_test_processed,pre_unmeth_test_processed,</span>
<span id="cb13-77"><a href="#cb13-77" tabindex="-1"></a>                  isoform_meth_test_processed,isoform_unmeth_test_processed)</span>
<span id="cb13-78"><a href="#cb13-78" tabindex="-1"></a>control.list <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb13-79"><a href="#cb13-79" tabindex="-1"></a></span>
<span id="cb13-80"><a href="#cb13-80" tabindex="-1"></a>res_preprocess_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">methylation.sites.preprocess</span>(test.list,control.list,<span class="fl">0.5</span>)</span>
<span id="cb13-81"><a href="#cb13-81" tabindex="-1"></a>res_preprocess <span class="ot">&lt;-</span> <span class="fu">methylation.sites.preprocess</span>(test.list,control.list)</span>
<span id="cb13-82"><a href="#cb13-82" tabindex="-1"></a></span>
<span id="cb13-83"><a href="#cb13-83" tabindex="-1"></a><span class="fu">saveRDS</span>(test.list,<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/test.list.rds&quot;</span>)</span>
<span id="cb13-84"><a href="#cb13-84" tabindex="-1"></a><span class="fu">saveRDS</span>(control.list,<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/control.list.rds&quot;</span>)</span>
<span id="cb13-85"><a href="#cb13-85" tabindex="-1"></a><span class="fu">saveRDS</span>(res_preprocess_0<span class="fl">.5</span>,<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/res_preprocess_0.5.rds&quot;</span>)</span>
<span id="cb13-86"><a href="#cb13-86" tabindex="-1"></a><span class="fu">saveRDS</span>(res_preprocess,<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/res_preprocess.rds&quot;</span>)</span>
<span id="cb13-87"><a href="#cb13-87" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-88"><a href="#cb13-88" tabindex="-1"></a>SNP <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/origin/SNP_all.rds&quot;</span>)</span>
<span id="cb13-89"><a href="#cb13-89" tabindex="-1"></a>SNP_index <span class="ot">&lt;-</span> SNP[index]</span>
<span id="cb13-90"><a href="#cb13-90" tabindex="-1"></a><span class="fu">saveRDS</span>(SNP_index,<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/SNP_1159.rds&quot;</span>)</span></code></pre></div>
</div>
<div id="deseq2-to-test-the-differential-methylation-between-the-spliced-mrna-and-pre-mrna" class="section level3">
<h3>DESeq2 to test the differential methylation between the spliced mRNA
and pre-mRNA</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Load input data</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>test.list <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/test.list.rds&quot;</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co"># Extract different parts of the data</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>spliced.meth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">1</span>]]  <span class="co"># Methylated spliced data</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>spliced.unmeth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">2</span>]]  <span class="co"># Unmethylated spliced data</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>unspliced.meth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">3</span>]]  <span class="co"># Methylated unspliced data</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>unspliced.unmeth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">4</span>]]  <span class="co"># Unmethylated unspliced data</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co"># Record start time</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co"># Load DESeq2 package</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="fu">library</span>(DESeq2)</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co"># Define DESeq2 differential expression analysis function</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>DESeq2_test <span class="ot">&lt;-</span> <span class="cf">function</span>(meth_control, meth_test, unmeth_control, unmeth_test) {</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>  <span class="co"># Convert input data to data frames</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a>  meth_control <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(meth_control)</span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>  meth_test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(meth_test)</span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>  unmeth_control <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(unmeth_control)</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>  unmeth_test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(unmeth_test)</span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>  </span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a>  <span class="co"># Function to calculate size factor</span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a>  sizeFactor <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a>    <span class="co"># Ensure data is not less than 0</span></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data)</span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a>    </span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a>    <span class="co"># Log-transform the data</span></span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a>    log_data <span class="ot">&lt;-</span> <span class="fu">log</span>(data)</span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a>    log_data[<span class="fu">is.infinite</span>(log_data)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a>    log_mean <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(log_data, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a>    log_s <span class="ot">&lt;-</span> log_data <span class="sc">-</span> log_mean</span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a>    </span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a>    <span class="co"># Calculate size factor</span></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a>    s_size <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">apply</span>(log_s, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a>    <span class="fu">return</span>(s_size)</span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a>  }</span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a>  </span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a>  <span class="co"># Calculate size factors for spliced and unspliced data</span></span>
<span id="cb14-44"><a href="#cb14-44" tabindex="-1"></a>  spliced_total <span class="ot">&lt;-</span> meth_control <span class="sc">+</span> unmeth_control</span>
<span id="cb14-45"><a href="#cb14-45" tabindex="-1"></a>  unspliced_total <span class="ot">&lt;-</span> meth_test <span class="sc">+</span> unmeth_test</span>
<span id="cb14-46"><a href="#cb14-46" tabindex="-1"></a>  </span>
<span id="cb14-47"><a href="#cb14-47" tabindex="-1"></a>  spliced_size_factor <span class="ot">&lt;-</span> <span class="fu">sizeFactor</span>(spliced_total)</span>
<span id="cb14-48"><a href="#cb14-48" tabindex="-1"></a>  unspliced_size_factor <span class="ot">&lt;-</span> <span class="fu">sizeFactor</span>(unspliced_total)</span>
<span id="cb14-49"><a href="#cb14-49" tabindex="-1"></a>  </span>
<span id="cb14-50"><a href="#cb14-50" tabindex="-1"></a>  <span class="co"># Get the number of control and test samples</span></span>
<span id="cb14-51"><a href="#cb14-51" tabindex="-1"></a>  num_control <span class="ot">&lt;-</span> <span class="fu">dim</span>(unmeth_control)[<span class="dv">2</span>]</span>
<span id="cb14-52"><a href="#cb14-52" tabindex="-1"></a>  num_test <span class="ot">&lt;-</span> <span class="fu">dim</span>(unmeth_test)[<span class="dv">2</span>]</span>
<span id="cb14-53"><a href="#cb14-53" tabindex="-1"></a>  </span>
<span id="cb14-54"><a href="#cb14-54" tabindex="-1"></a>  <span class="co"># Combine all data</span></span>
<span id="cb14-55"><a href="#cb14-55" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(meth_control, meth_test, unmeth_control, unmeth_test)</span>
<span id="cb14-56"><a href="#cb14-56" tabindex="-1"></a>  </span>
<span id="cb14-57"><a href="#cb14-57" tabindex="-1"></a>  <span class="co"># Design the experiment matrix</span></span>
<span id="cb14-58"><a href="#cb14-58" tabindex="-1"></a>  design <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-59"><a href="#cb14-59" tabindex="-1"></a>    <span class="at">Trt =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;control&quot;</span>, num_control), <span class="fu">rep</span>(<span class="st">&quot;test&quot;</span>, num_test)), <span class="dv">2</span>), </span>
<span id="cb14-60"><a href="#cb14-60" tabindex="-1"></a>    <span class="at">Meth =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;meth&quot;</span>, (num_control <span class="sc">+</span> num_test)), <span class="fu">rep</span>(<span class="st">&quot;unmeth&quot;</span>, (num_control <span class="sc">+</span> num_test)))</span>
<span id="cb14-61"><a href="#cb14-61" tabindex="-1"></a>  )</span>
<span id="cb14-62"><a href="#cb14-62" tabindex="-1"></a>  </span>
<span id="cb14-63"><a href="#cb14-63" tabindex="-1"></a>  <span class="co"># Define the model</span></span>
<span id="cb14-64"><a href="#cb14-64" tabindex="-1"></a>  model <span class="ot">=</span> <span class="er">~</span> Meth <span class="sc">+</span> Trt <span class="sc">+</span> Meth<span class="sc">:</span>Trt</span>
<span id="cb14-65"><a href="#cb14-65" tabindex="-1"></a>  </span>
<span id="cb14-66"><a href="#cb14-66" tabindex="-1"></a>  <span class="co"># Create DESeqDataSet object</span></span>
<span id="cb14-67"><a href="#cb14-67" tabindex="-1"></a>  dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> counts,</span>
<span id="cb14-68"><a href="#cb14-68" tabindex="-1"></a>                                <span class="at">colData =</span> design,</span>
<span id="cb14-69"><a href="#cb14-69" tabindex="-1"></a>                                <span class="at">design =</span> model)</span>
<span id="cb14-70"><a href="#cb14-70" tabindex="-1"></a>  </span>
<span id="cb14-71"><a href="#cb14-71" tabindex="-1"></a>  <span class="co"># Set size factors</span></span>
<span id="cb14-72"><a href="#cb14-72" tabindex="-1"></a>  <span class="fu">sizeFactors</span>(dds) <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(spliced_size_factor, unspliced_size_factor), <span class="dv">2</span>)</span>
<span id="cb14-73"><a href="#cb14-73" tabindex="-1"></a>  </span>
<span id="cb14-74"><a href="#cb14-74" tabindex="-1"></a>  <span class="co"># Perform differential expression analysis</span></span>
<span id="cb14-75"><a href="#cb14-75" tabindex="-1"></a>  dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds, <span class="at">test =</span> <span class="st">&quot;Wald&quot;</span>)</span>
<span id="cb14-76"><a href="#cb14-76" tabindex="-1"></a>  </span>
<span id="cb14-77"><a href="#cb14-77" tabindex="-1"></a>  <span class="co"># Extract results</span></span>
<span id="cb14-78"><a href="#cb14-78" tabindex="-1"></a>  res <span class="ot">=</span> DESeq2<span class="sc">::</span><span class="fu">results</span>(dds, <span class="at">name =</span> <span class="st">&quot;Methunmeth.Trttest&quot;</span>, <span class="at">cooksCutoff =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-79"><a href="#cb14-79" tabindex="-1"></a>  </span>
<span id="cb14-80"><a href="#cb14-80" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb14-81"><a href="#cb14-81" tabindex="-1"></a>}</span>
<span id="cb14-82"><a href="#cb14-82" tabindex="-1"></a></span>
<span id="cb14-83"><a href="#cb14-83" tabindex="-1"></a><span class="co"># Call the function to perform differential expression analysis</span></span>
<span id="cb14-84"><a href="#cb14-84" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">DESeq2_test</span>(spliced.meth.test, unspliced.meth.test, spliced.unmeth.test, unspliced.unmeth.test)</span>
<span id="cb14-85"><a href="#cb14-85" tabindex="-1"></a></span>
<span id="cb14-86"><a href="#cb14-86" tabindex="-1"></a><span class="co"># Record end time</span></span>
<span id="cb14-87"><a href="#cb14-87" tabindex="-1"></a>end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb14-88"><a href="#cb14-88" tabindex="-1"></a></span>
<span id="cb14-89"><a href="#cb14-89" tabindex="-1"></a><span class="co"># Print the runtime</span></span>
<span id="cb14-90"><a href="#cb14-90" tabindex="-1"></a><span class="fu">print</span>(end_time <span class="sc">-</span> start_time)</span>
<span id="cb14-91"><a href="#cb14-91" tabindex="-1"></a></span>
<span id="cb14-92"><a href="#cb14-92" tabindex="-1"></a></span>
<span id="cb14-93"><a href="#cb14-93" tabindex="-1"></a><span class="co"># Save the results</span></span>
<span id="cb14-94"><a href="#cb14-94" tabindex="-1"></a><span class="fu">saveRDS</span>(result, <span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/res_DESeq2.rds&quot;</span>)</span></code></pre></div>
<p>We will get the following data in
VeloRM_data/RNA-Seq_A-to-I/pre_process</p>
<p>Processed data:</p>
<p>SNP_1159: the SNP information for the A-to-I site for further
analysis.</p>
<p>test_list: the test cell reads counts
(spliced_meth_test,spliced_unmeth_test,pre_meth_test,pre_unmeth_test,
isoform_meth_test,isoform_unmeth_test)</p>
<p>control_list: NULL</p>
<p>res_preprocess: the list processed by VeloRM</p>
<p>res_DESeq2: the DESeq2 results</p>
</div>
</div>
<div id="analysis" class="section level2">
<h2>analysis</h2>
<div id="overall-reads-counts" class="section level3">
<h3>Overall reads counts</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>counts_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/origin/bam_read_counts.csv&quot;</span>, </span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>                       <span class="at">header =</span> <span class="cn">TRUE</span>,  <span class="co"># Assumes first row contains column names</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>                       <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)  <span class="co"># Prevents automatic conversion to factors</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co"># View the first few rows</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>counts_data_sum <span class="ot">&lt;-</span> <span class="fu">apply</span>(counts_data,<span class="dv">1</span>,<span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">as.numeric</span>(x[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])))</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>isoform_prop <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(counts_data[,<span class="dv">2</span>])<span class="sc">/</span>counts_data_sum</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>spliced_prop <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(counts_data[,<span class="dv">3</span>])<span class="sc">/</span>counts_data_sum</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>pre_prop <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(counts_data[,<span class="dv">4</span>])<span class="sc">/</span>counts_data_sum</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>  <span class="st">`</span><span class="at">mature RNA</span><span class="st">`</span> <span class="ot">=</span> spliced_prop,</span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>  <span class="st">`</span><span class="at">pre RNA</span><span class="st">`</span> <span class="ot">=</span> pre_prop,</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a>  <span class="st">`</span><span class="at">ambiguous</span><span class="st">`</span> <span class="ot">=</span> isoform_prop,</span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a>)</span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(df, <span class="at">cols =</span> <span class="fu">everything</span>(), </span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a>                       <span class="at">names_to =</span> <span class="st">&quot;Type&quot;</span>, </span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a>                       <span class="at">values_to =</span> <span class="st">&quot;Probability&quot;</span>)</span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> Probability, <span class="at">fill =</span> Type)) <span class="sc">+</span>  </span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a>    <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, </span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a>                 <span class="at">outlier.shape =</span> <span class="cn">NA</span>,</span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a>                 <span class="at">coef =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>Type, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span>  </span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a>        <span class="at">title =</span> <span class="cn">NULL</span>,</span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a>        <span class="at">x =</span> <span class="cn">NULL</span>,  </span>
<span id="cb15-35"><a href="#cb15-35" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;Probability&quot;</span></span>
<span id="cb15-36"><a href="#cb15-36" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb15-37"><a href="#cb15-37" tabindex="-1"></a>    <span class="co"># Use theme_gray() which is the default ggplot2 theme</span></span>
<span id="cb15-38"><a href="#cb15-38" tabindex="-1"></a>    <span class="fu">theme_gray</span>(<span class="at">base_size =</span> <span class="dv">14</span>)  <span class="sc">+</span></span>
<span id="cb15-39"><a href="#cb15-39" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(</span>
<span id="cb15-40"><a href="#cb15-40" tabindex="-1"></a>        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;mature RNA&quot;</span> <span class="ot">=</span> <span class="st">&quot;#FF9999&quot;</span>,  </span>
<span id="cb15-41"><a href="#cb15-41" tabindex="-1"></a>                   <span class="st">&quot;pre RNA&quot;</span> <span class="ot">=</span> <span class="st">&quot;#99CCFF&quot;</span>,     </span>
<span id="cb15-42"><a href="#cb15-42" tabindex="-1"></a>                   <span class="st">&quot;ambiguous&quot;</span> <span class="ot">=</span> <span class="st">&quot;#99CC99&quot;</span>),   </span>
<span id="cb15-43"><a href="#cb15-43" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;mature RNA&quot;</span>, <span class="st">&quot;pre RNA&quot;</span>, <span class="st">&quot;ambiguous&quot;</span>) </span>
<span id="cb15-44"><a href="#cb15-44" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb15-45"><a href="#cb15-45" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb15-46"><a href="#cb15-46" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb15-47"><a href="#cb15-47" tabindex="-1"></a>  )</span>
<span id="cb15-48"><a href="#cb15-48" tabindex="-1"></a></span>
<span id="cb15-49"><a href="#cb15-49" tabindex="-1"></a>box_plot</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co"># Assuming plot_data is defined as you provided</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  <span class="at">category =</span> <span class="fu">c</span>(<span class="st">&quot;Ambiguous&quot;</span>,<span class="st">&quot;Spliced&quot;</span>, <span class="st">&quot;Unspliced&quot;</span>),</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  <span class="at">proportion =</span> <span class="fu">c</span>(<span class="fu">sum</span>(counts_data[,<span class="dv">2</span>]),<span class="fu">sum</span>(counts_data[,<span class="dv">3</span>]), <span class="fu">sum</span>(counts_data[,<span class="dv">4</span>]))</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co"># Create pie chart</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>pie_chart <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> proportion, <span class="at">fill =</span> category)) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span> <span class="co"># white border between slices</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span> <span class="co"># convert barplot to pie</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(proportion <span class="sc">/</span> <span class="fu">sum</span>(proportion) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>)),</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="co"># add percentage labels</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="cn">NULL</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> <span class="co"># remove background, axes, grid</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>pie_chart</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>res_preprocess <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/res_preprocess.rds&quot;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>spliced_index <span class="ot">&lt;-</span> <span class="fu">which</span>(res_preprocess[[<span class="st">&quot;spliced_methylation_M_value_meta&quot;</span>]]<span class="sc">&gt;=</span><span class="dv">1</span>)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>unspliced_index <span class="ot">&lt;-</span> <span class="fu">which</span>(res_preprocess[[<span class="st">&quot;unspliced_methylation_M_value_meta&quot;</span>]]<span class="sc">&gt;=</span><span class="dv">1</span>)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>spliced_index_l <span class="ot">&lt;-</span> <span class="fu">length</span>(spliced_index)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>unspliced_index_l <span class="ot">&lt;-</span> <span class="fu">length</span>(unspliced_index)</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>intersect_l <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">intersect</span>(spliced_index,unspliced_index))</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="fu">library</span>(VennDiagram)</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="fu">grid.newpage</span>()</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>venn <span class="ot">&lt;-</span><span class="fu">draw.pairwise.venn</span>(</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>  <span class="at">area1 =</span> spliced_index_l,</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>  <span class="at">area2 =</span> unspliced_index_l,</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>  <span class="at">cross.area =</span> intersect_l,</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>  <span class="at">category =</span> <span class="fu">c</span>(<span class="st">&quot;Spliced&quot;</span>, <span class="st">&quot;Unspliced&quot;</span>),</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a>  <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;#E74C3C&quot;</span>,<span class="st">&quot;skyblue&quot;</span>),</span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>  <span class="at">lty =</span> <span class="st">&quot;blank&quot;</span>,</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>  <span class="at">cex =</span> <span class="dv">2</span>,</span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a>  <span class="at">cat.cex =</span> <span class="fl">1.5</span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAACH1BMVEUAAAAAACQAACwAADgAADoAAD8AAE4AAGIAAGYAJSQAJT8AJVkAKiwAKk4AKm4ANDgANGIANIoAOjoAOmYAOpAAQ3EASowAXK8AZrYrAAArACwrKgArKiwrKk4rSm4rSowraagsAAAsNAAsNGIsXIosXK8sgdI2AAA2AD82JQA2JT82JVk2Q1k2XXE2XYg6AAA6ADo6OgA6OmY6ZpA6kNtLAABLKgBLKixLaYxLaahLhahLhcROAABONABONDhOgWJOpdJOpfVhAABhJQBhXXFhXYhhdohhdp5mAABmOgBmOjpmOmZmZmZmkLZmkNtmtttmtv9qKgBqSixqhahqoMRuNABuNDhuXDhuXIpupdJuxvWHSgCHSiyHaSyHaU6HoMSHusSJJQCJQySJXT+JdoiJdp6Jj56LXACLXDiLxtKLxvWL59KL5/WQOgCQZjqQttuQtv+Q2/+iaSyihU6ihW6ioG6ioIyiusSogTiopWKopYqoxq+oxtKoxvWo5/WuQwCuQySuQz+uXSSuXT+uj4iuj56upp62ZgC2kGa2tma22/+2/9u2//+9hU69oG69oIy9oKi9uoy9uqi9usTDpWLDxorDxq/D56/D59LD5/XRXSTRXT/Rdj/RdlnRj3HRj4jRj57Rpp7bkDrbkGbbtmbbtpDb25Db///zdj/zdlnzj1nzj3HzpnHzpojzpp7/tmb/25D/27b//7b//9v////8AVv7AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAME0lEQVR4nO3djX8URxkH8EkIDbEvvkExtuWlrUQqEq1B1GKVhJqI1ibS2mJaKdU2rbYKKVpoFapCaZEEcoclF7FtEEwMySUN+wc6s293u7m9edl5dnbnnt/nQ3KbLGTnm2ee2V0+nz3iYJqGmD6AvAeBOEEgThCIEwTiBIE4QSBOEIgTBOIEgThBIE4QiBME4gSBOEEgThCIEwTiBIE4MQhUXZvgW5VIzB2iYwKogYufci2Vxsn8YDMGEpAp85WyZcoKSKRsZJQyOuxsgJRx8lBK4EBpcUwbgQKlLh0hJMgRgALp1TFVR1BAADpmjECANE8tQSOIkYAAAfM0IYIw0g4Er5MtkWagjHgyJNIKlCFPZkQagTLmyYhIG5ABnkyINAEZ4smASAtQEk8WPtBEOoDM8gALpQcyzgNLlBooFz7JQqmJUgLlhKcZkVGgHPlACaUByhUPFFEKoNz5gAgpAyXxmPSBIFIFyqmPfqEY0Ke//8Zxx7n9Rsdw879269c9u/PIU1YXShh6FGill3Swvc5zgBZ2EtIIyDSOG6Yx/Qxh2U9fnmQvPn+aJ5Q09FgFUcDjzf8hx5teZxoBmaYJwoj+uZ3s8EpneqzztwJFlDB0BaBqApBplrq4NbTul/7kOrlZZJppA6omAJlGiSQCdCUEaiakC6iaAGSaJJYEoCZCiUC3bx7c8I/3e8kXj4d7eQ2dfj5IyBeecve7+WPi7kEpbg2QtifiQKZB1iQGNP32452vn3qQfM4d2H96O5787zGhoRPnPCEdP73g3OztOO7v5Td0Z7njKfoF0kdfXt9wwfl0qGOYUsz3fH126d3YKmaaY21KUaCx7aTzB4dp6+68SEez8YJzo3dYaOiELXAbLjIDsnHOZ/Q+rvT2BV9ecVmXyZ2z1cX+TRRksT8CZFqjQUoj0SlGaV73OhMdnjuwYaGh14BWh+i36vc63+FVHt3rPP1Dd+xpe6U6QwbX9CDTGI1SGmlvCETPjW6/QeeDs3JMaOg1IFpRw/V70X/mYti/iJ/BpaMUKQZk2qJhKNDTCUCV64Q8eoENTGDoyUCrQ+Feq0OsglyMxf7178WATFM0TmmEPFauOw+qB6rc6CXkW3NCQydztb2ideb+raCC6B7M4n8vL/bHK8i0RFJGKZAndHJHHKhymxJtFBp6Dchli0xE4nYeZ/kYfdnnYvz1laWjsR5k2iEx42Rb2T+n3h8Fmn7udCVYtLhDd6eYt7KxRa1+r2VC6HLorP7kInu565Nq9drXZmmTpktZDcg0Q3Imu+94scyErjCZCNAvaPt2rrtA3KG7QGxrpZehrQyRnwUf6TLnhq14M+4rNrtoCd15rvovejn/1ffy7MNK6O4j5fLlV73l/hRhnz/cRy9h6Vp/uPLhkDvFuEP3mvQH9PzoSbdpsa96H+luN75J2/0f3OuLa1TkkXOsZpb+1kO6Xj7TdeCTXBcQzaW93YS0b/1LePtjs3vro/N3z73zLCFfmRMaem0Va5JqUkwTiCX5Fhp/6OmATI9cMOBABfdpIiQGdIM0v8VReJ9kId7QGdDqULBS2euTIHR1H2fofgU1T8EbdJDkPsSrIFUg0yOWDBiQJT7qQhwgSyYYi6KQIpDp0SoEBMgiH1WhpkBW+SgKIRBHqBmQZT5qJdQEyDofJSEEUgay0EdFKBEoyafYQPJC0kCmR5gy2oAsLSB5IVkg0+NLHU1A1vpICyGQEpDFPrJCCKQCZLWPpBACKQBZ7iMnhEDyQNb7SAkhkDRQko9NQBJC4kCmx6Q1KYBaooAkhISBTI9IcxCIE2WgFvERF0IgBGocRaCW8REWQiApoCQfG4EEhcSATI8FJAjECQJxogDUUi1IUEgIyPRIgIJAnEgDtdgMExMSATI9DrAgECcIxIkkUMu1ICEhASDTowAMAnGCQJwgECdSQC3Yo0WE+ECmxwAaBOIEgThBIE4kgFqyRwsIIVBaINMjAA4CcYJAnCAQJwjECQJxgkCcCAOxJ0S72V2H89FLO0n703BHd2IvIe1bjoTbl5/vJuSu70V38p+oCRX/QV0keA+FcLsvBuQ9a5N4z/p1szBAug58DHhsz3s/MvwVTHTfc6R8aYTc81bdTqURAgt00jsK93mmLP528Hi8ACgooE2hzwxpewJ0io3ffYgVDQlAJrvdF1Tk3vq9CCxQUDCbYwX0pdgUm3EfYVvL0hniPRcZ7Mgmt3ouo4Q919h/ADTLhP8Fb69uYKCT7E1b6hJsx3rQav9gtDcHPvBNmhK4HhMBRKlukpVG7h0FBZratz/iczXYjgFdJ22P/KbOZ4Zk9rzoqT0eQA1itFZC43e8CAs0TtY9dLi+gILtKJD3tMm2HwU+tCP5Uw7u0IJMdm9zP9cgaNvZFnzvsTIo0NQeNvB1P6wVULAdBfIfn0w2zQYTjAxmdRo0utX/HELQJuS16dLItjIs0Lg/8M2nI0sY3Y6fB33875dqixgtoPVn/76T1tSBt/g/JFVKL/g+dRMrBBpnvQh2ipX//Paz9YtYJdhec6JIF653iV8488R7uva1nug5ifaUTnybkC3ejwhZwik2+WV2hgQMRE2mX/XfisyPuz28FshtzW7rCVv0PImck+gOW8NJsIzTxcs/ZRz1gNwJlgWQO7Miqz3d9p76HwMKFvewBS0dBb3UoAhv3keCX8KlPaT9ULn8p73+yfW4V71ZAFXGSPhGN/528BzlKBBtPoORHj0TLihQKY2GZ4Ildil2/3f+2O1ObG+CZQREV6/I+RDdHm4ERGmiQAvdoHOMpTa1/HgtyJ9gGQHRkomeMI4lAUWnWHWhBxyIgkSA6KkJE5kg9YFbKwKQ6BSrjDWeYtUzbpOeD8+j6ZwDnmJr7mf4y33WQLFLsrHGTXqxf3f0RHqhB7ZJs0x21xfpRLzrZdSDdkR8ru7ra7TMLx31XWaCS9V5+BlWHq//HVCfrdFvZwE0/Uy0gOj2XD3Q6sFHz1KNjwaC22V0ed/kldJ6sIMb988Qp/bUKqb0Amn/bmw/SKCpvQ+8Rj3e+b5/u+zq4w8F25Ez6WU6y7t6CNkV3hNaHGDXZbcGPnMO6thYr2GnPSfuD2+xXv7Vfe7b8cT3gwNije6z2wl52K+fK+G2EwFy38mmbdfZuvsdS+xSrOvALNzVaunn7HbrA4eC9ksP9q4ta3iAp9ibD9Jr94dfC+fWqWA7BuTg/2rEgkB+EIgTBOIEgThJD2S5EAJxIg7UmnOM64NACNQ0CMSJDiCrhRCIExmgVpxjfB8EQqBm0QNksZAcUOuVkIAPAiFQk+gCslZIFqjVSkjEB4EQKDn6gCwVkgdqrRIS8kEgPUBWCqkAtVIJifkgkCYgC4XUgFqnhAR9EEgWqFWERH0QSBuQZULqQK1RQsI+CCQP1ApC4j4IpABkv5CEDwLpBLJGKC2Q7SUk4yMHZIlQeiC7S0jKRxLICiEdQDaXkJxPEpC9QpI+CKQKZKuQrA8CKQPZKSTtowBUaCGdQDaWkLxPMyD7hBR8lIAKK6QbyLYSUvFpDmSXkJKPIlAhhSCAbCohNR8ekD1Cij5cIFuEknzggAompOrDB7KjhJR9BIBsEFL3EQEqvlAKn1RAhRGCBiq6UBofMaBiT7JUPoJARRZK5yMKVFyhlD7CQEUVSusjDlRModQ+EkBFFErvIwNUPCENPlJARRPS4SMHVCwhLT6SQEUS0uMjC1QcIU0+0kBFEdLlIw9UDCFtPgpARRDS56MClH8hjT5KQHm/P6TTRw0o10WklUcZKL9Cmn2UgfI6zXT7qAPlsoi086QCyp8QgE8qoLxNMwifdEC5KiIQntRA+SkiIJ/UQDkpIigeHUB5KCIwHi1AxosIrnwcTUBGiUB5tAEZIwLm0QhkphVB8+gEMkAEXj6OXqCMiTLQcXQDOZn1oiyKx412oEyIMuMBAQKfaRnyAAE5gGWUqY4DBwRURhnrOJBAjnajrIvHDSiQo9HIBA4LNBBLaiMjpeMnCyAW5UoyicOSFRCLNJJhGzdZAnkRYsoDjZfsgcI0MPK/Y56lFoNAxQgCcYJAnCAQJwjECQJxgkCcIBAnCMQJAnGCQJwgECcIxAkCcYJAnCAQJwjECQJxgkCcIBAn/wdu4XbtAmtMhgAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="splicing-jucntion-distance" class="section level3">
<h3>splicing jucntion distance</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">library</span>(GenomicRanges)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">library</span>(rtracklayer)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>snp <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/SNP_1019.rds&quot;</span>)</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>snp_pos <span class="ot">&lt;-</span> snp<span class="sc">@</span>ranges<span class="sc">@</span>start</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>snp_chr_length <span class="ot">&lt;-</span> snp<span class="sc">@</span>seqnames<span class="sc">@</span>lengths</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>snp_chr_seq <span class="ot">&lt;-</span> snp<span class="sc">@</span>seqnames<span class="sc">@</span>values</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>snp_chr <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">rep</span>(snp_chr_seq,snp_chr_length)) </span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>snp_strand <span class="ot">&lt;-</span> snp<span class="sc">@</span>elementMetadata<span class="sc">@</span>listData[[<span class="st">&quot;transcript_strand&quot;</span>]]</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>snp_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(snp_chr,snp_pos,snp_strand))</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>snp_data<span class="sc">$</span>snp_pos <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(snp_data<span class="sc">$</span>snp_pos)</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co"># Read the GTF file from Ensembl</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>gtf_file <span class="ot">&lt;-</span> <span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/origin/gencode.vM33.annotation.gtf&quot;</span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>gtf_data <span class="ot">&lt;-</span> <span class="fu">import</span>(gtf_file)</span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="co"># Filter for exons</span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a>exons <span class="ot">&lt;-</span> gtf_data[gtf_data<span class="sc">$</span>type <span class="sc">==</span> <span class="st">&quot;exon&quot;</span>]</span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a><span class="co"># Convert to data frame</span></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a>exons_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a><span class="at">chr =</span> <span class="fu">as.character</span>(<span class="fu">seqnames</span>(exons)),</span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a><span class="at">start =</span> <span class="fu">start</span>(exons),</span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a><span class="at">end =</span> <span class="fu">end</span>(exons),</span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a><span class="at">strand =</span> <span class="fu">as.character</span>(<span class="fu">strand</span>(exons)),</span>
<span id="cb18-31"><a href="#cb18-31" tabindex="-1"></a><span class="at">gene_id =</span> <span class="fu">mcols</span>(exons)<span class="sc">$</span>gene_id,</span>
<span id="cb18-32"><a href="#cb18-32" tabindex="-1"></a><span class="at">transcript_id =</span> <span class="fu">mcols</span>(exons)<span class="sc">$</span>transcript_id</span>
<span id="cb18-33"><a href="#cb18-33" tabindex="-1"></a>)</span>
<span id="cb18-34"><a href="#cb18-34" tabindex="-1"></a></span>
<span id="cb18-35"><a href="#cb18-35" tabindex="-1"></a><span class="co"># Sort exons by transcript and position</span></span>
<span id="cb18-36"><a href="#cb18-36" tabindex="-1"></a>exons_df <span class="ot">&lt;-</span> exons_df <span class="sc">%&gt;%</span></span>
<span id="cb18-37"><a href="#cb18-37" tabindex="-1"></a><span class="fu">arrange</span>(transcript_id, chr, start)</span>
<span id="cb18-38"><a href="#cb18-38" tabindex="-1"></a></span>
<span id="cb18-39"><a href="#cb18-39" tabindex="-1"></a><span class="co"># Extract splicing junctions using intron boundaries</span></span>
<span id="cb18-40"><a href="#cb18-40" tabindex="-1"></a>junctions <span class="ot">&lt;-</span> exons_df <span class="sc">%&gt;%</span></span>
<span id="cb18-41"><a href="#cb18-41" tabindex="-1"></a><span class="fu">group_by</span>(transcript_id) <span class="sc">%&gt;%</span></span>
<span id="cb18-42"><a href="#cb18-42" tabindex="-1"></a><span class="fu">arrange</span>(<span class="fu">if_else</span>(strand <span class="sc">==</span> <span class="st">&quot;+&quot;</span>, start, <span class="sc">-</span>start)) <span class="sc">%&gt;%</span>  <span class="co"># Sort based on strand</span></span>
<span id="cb18-43"><a href="#cb18-43" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb18-44"><a href="#cb18-44" tabindex="-1"></a>  <span class="at">donor_site =</span> end,                <span class="co"># End of the upstream exon</span></span>
<span id="cb18-45"><a href="#cb18-45" tabindex="-1"></a>  <span class="at">acceptor_site =</span> <span class="fu">lead</span>(start)      <span class="co"># Start of the downstream exon</span></span>
<span id="cb18-46"><a href="#cb18-46" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb18-47"><a href="#cb18-47" tabindex="-1"></a><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(acceptor_site)) <span class="sc">%&gt;%</span>   <span class="co"># Remove the last exon (no downstream exon)</span></span>
<span id="cb18-48"><a href="#cb18-48" tabindex="-1"></a><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-49"><a href="#cb18-49" tabindex="-1"></a><span class="fu">select</span>(chr, donor_site, acceptor_site, gene_id, transcript_id, strand)</span>
<span id="cb18-50"><a href="#cb18-50" tabindex="-1"></a></span>
<span id="cb18-51"><a href="#cb18-51" tabindex="-1"></a></span>
<span id="cb18-52"><a href="#cb18-52" tabindex="-1"></a>junctions_unique <span class="ot">&lt;-</span> junctions <span class="sc">%&gt;%</span></span>
<span id="cb18-53"><a href="#cb18-53" tabindex="-1"></a> <span class="fu">distinct</span>(chr, donor_site, acceptor_site, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-54"><a href="#cb18-54" tabindex="-1"></a></span>
<span id="cb18-55"><a href="#cb18-55" tabindex="-1"></a></span>
<span id="cb18-56"><a href="#cb18-56" tabindex="-1"></a></span>
<span id="cb18-57"><a href="#cb18-57" tabindex="-1"></a>junctions_long <span class="ot">&lt;-</span> junctions_unique <span class="sc">%&gt;%</span></span>
<span id="cb18-58"><a href="#cb18-58" tabindex="-1"></a> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(donor_site, acceptor_site), </span>
<span id="cb18-59"><a href="#cb18-59" tabindex="-1"></a>              <span class="at">names_to =</span> <span class="st">&quot;site_type&quot;</span>, </span>
<span id="cb18-60"><a href="#cb18-60" tabindex="-1"></a>              <span class="at">values_to =</span> <span class="st">&quot;site_position&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-61"><a href="#cb18-61" tabindex="-1"></a> <span class="fu">select</span>(chr, site_position, site_type, gene_id, transcript_id, strand)</span>
<span id="cb18-62"><a href="#cb18-62" tabindex="-1"></a></span>
<span id="cb18-63"><a href="#cb18-63" tabindex="-1"></a></span>
<span id="cb18-64"><a href="#cb18-64" tabindex="-1"></a></span>
<span id="cb18-65"><a href="#cb18-65" tabindex="-1"></a><span class="co"># Calculate distance from each SNP to the nearest junction (matching chr and strand)</span></span>
<span id="cb18-66"><a href="#cb18-66" tabindex="-1"></a>snp_with_distance <span class="ot">&lt;-</span> snp_data <span class="sc">%&gt;%</span></span>
<span id="cb18-67"><a href="#cb18-67" tabindex="-1"></a> <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-68"><a href="#cb18-68" tabindex="-1"></a> <span class="fu">mutate</span>(</span>
<span id="cb18-69"><a href="#cb18-69" tabindex="-1"></a>   <span class="at">nearest_junction_distance =</span> <span class="fu">min</span>(</span>
<span id="cb18-70"><a href="#cb18-70" tabindex="-1"></a>     <span class="fu">abs</span>(junctions_long<span class="sc">$</span>site_position[junctions_long<span class="sc">$</span>chr <span class="sc">==</span> snp_chr <span class="sc">&amp;</span> junctions_long<span class="sc">$</span>strand <span class="sc">==</span> snp_strand] <span class="sc">-</span> snp_pos),</span>
<span id="cb18-71"><a href="#cb18-71" tabindex="-1"></a>     <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb18-72"><a href="#cb18-72" tabindex="-1"></a>   )</span>
<span id="cb18-73"><a href="#cb18-73" tabindex="-1"></a> )</span>
<span id="cb18-74"><a href="#cb18-74" tabindex="-1"></a></span>
<span id="cb18-75"><a href="#cb18-75" tabindex="-1"></a></span>
<span id="cb18-76"><a href="#cb18-76" tabindex="-1"></a><span class="co"># get normal chr</span></span>
<span id="cb18-77"><a href="#cb18-77" tabindex="-1"></a>standard_chromosomes <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;chr&quot;</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">22</span>, <span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>))</span>
<span id="cb18-78"><a href="#cb18-78" tabindex="-1"></a></span>
<span id="cb18-79"><a href="#cb18-79" tabindex="-1"></a><span class="co"># get the exon with the normal chr</span></span>
<span id="cb18-80"><a href="#cb18-80" tabindex="-1"></a>exons_filtered <span class="ot">&lt;-</span> exons[<span class="fu">seqnames</span>(exons) <span class="sc">%in%</span> standard_chromosomes]</span>
<span id="cb18-81"><a href="#cb18-81" tabindex="-1"></a></span>
<span id="cb18-82"><a href="#cb18-82" tabindex="-1"></a></span>
<span id="cb18-83"><a href="#cb18-83" tabindex="-1"></a></span>
<span id="cb18-84"><a href="#cb18-84" tabindex="-1"></a><span class="co"># calculate the distance </span></span>
<span id="cb18-85"><a href="#cb18-85" tabindex="-1"></a>exon_lengths <span class="ot">&lt;-</span> <span class="fu">width</span>(exons_filtered)</span>
<span id="cb18-86"><a href="#cb18-86" tabindex="-1"></a></span>
<span id="cb18-87"><a href="#cb18-87" tabindex="-1"></a><span class="co"># calculate the prob </span></span>
<span id="cb18-88"><a href="#cb18-88" tabindex="-1"></a>prob_weights <span class="ot">&lt;-</span> exon_lengths <span class="sc">/</span> <span class="fu">sum</span>(exon_lengths)</span>
<span id="cb18-89"><a href="#cb18-89" tabindex="-1"></a></span>
<span id="cb18-90"><a href="#cb18-90" tabindex="-1"></a><span class="co"># random sample</span></span>
<span id="cb18-91"><a href="#cb18-91" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb18-92"><a href="#cb18-92" tabindex="-1"></a></span>
<span id="cb18-93"><a href="#cb18-93" tabindex="-1"></a></span>
<span id="cb18-94"><a href="#cb18-94" tabindex="-1"></a><span class="co">#random_distances_list &lt;- list()</span></span>
<span id="cb18-95"><a href="#cb18-95" tabindex="-1"></a></span>
<span id="cb18-96"><a href="#cb18-96" tabindex="-1"></a><span class="co">#for (i in 1:10){</span></span>
<span id="cb18-97"><a href="#cb18-97" tabindex="-1"></a> selected_exons <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_along</span>(exons_filtered), <span class="at">size =</span> <span class="dv">1019</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> prob_weights)</span>
<span id="cb18-98"><a href="#cb18-98" tabindex="-1"></a> <span class="co"># choose the site in the select the exons</span></span>
<span id="cb18-99"><a href="#cb18-99" tabindex="-1"></a> random_positions <span class="ot">&lt;-</span> <span class="fu">start</span>(exons[selected_exons]) <span class="sc">+</span> </span>
<span id="cb18-100"><a href="#cb18-100" tabindex="-1"></a>   <span class="fu">floor</span>(<span class="fu">runif</span>(<span class="dv">1019</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> exon_lengths[selected_exons]))</span>
<span id="cb18-101"><a href="#cb18-101" tabindex="-1"></a> </span>
<span id="cb18-102"><a href="#cb18-102" tabindex="-1"></a> <span class="co"># create the data frame</span></span>
<span id="cb18-103"><a href="#cb18-103" tabindex="-1"></a> random_sites <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-104"><a href="#cb18-104" tabindex="-1"></a>   <span class="at">chr =</span> <span class="fu">as.character</span>(<span class="fu">seqnames</span>(exons[selected_exons])),</span>
<span id="cb18-105"><a href="#cb18-105" tabindex="-1"></a>   <span class="at">position =</span> random_positions,</span>
<span id="cb18-106"><a href="#cb18-106" tabindex="-1"></a>   <span class="at">strand =</span> <span class="fu">as.character</span>(<span class="fu">strand</span>(exons[selected_exons]))</span>
<span id="cb18-107"><a href="#cb18-107" tabindex="-1"></a> )</span>
<span id="cb18-108"><a href="#cb18-108" tabindex="-1"></a> </span>
<span id="cb18-109"><a href="#cb18-109" tabindex="-1"></a> </span>
<span id="cb18-110"><a href="#cb18-110" tabindex="-1"></a> <span class="co"># Calculate distance from each SNP to the nearest junction (matching chr and strand)</span></span>
<span id="cb18-111"><a href="#cb18-111" tabindex="-1"></a> random_sites_with_distance <span class="ot">&lt;-</span> random_sites <span class="sc">%&gt;%</span></span>
<span id="cb18-112"><a href="#cb18-112" tabindex="-1"></a>   <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-113"><a href="#cb18-113" tabindex="-1"></a>   <span class="fu">mutate</span>(</span>
<span id="cb18-114"><a href="#cb18-114" tabindex="-1"></a>     <span class="at">nearest_junction_distance =</span> <span class="fu">min</span>(</span>
<span id="cb18-115"><a href="#cb18-115" tabindex="-1"></a>       <span class="fu">abs</span>(junctions_long<span class="sc">$</span>site_position[junctions_long<span class="sc">$</span>chr <span class="sc">==</span> chr <span class="sc">&amp;</span> junctions_long<span class="sc">$</span>strand <span class="sc">==</span> strand] <span class="sc">-</span> position),</span>
<span id="cb18-116"><a href="#cb18-116" tabindex="-1"></a>       <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb18-117"><a href="#cb18-117" tabindex="-1"></a>     )</span>
<span id="cb18-118"><a href="#cb18-118" tabindex="-1"></a>   )</span>
<span id="cb18-119"><a href="#cb18-119" tabindex="-1"></a> random_distances_list  <span class="ot">&lt;-</span> random_sites_with_distance<span class="sc">$</span>nearest_junction_distance</span>
<span id="cb18-120"><a href="#cb18-120" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb18-121"><a href="#cb18-121" tabindex="-1"></a></span>
<span id="cb18-122"><a href="#cb18-122" tabindex="-1"></a></span>
<span id="cb18-123"><a href="#cb18-123" tabindex="-1"></a></span>
<span id="cb18-124"><a href="#cb18-124" tabindex="-1"></a>random_distances_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-125"><a href="#cb18-125" tabindex="-1"></a> <span class="at">distance =</span> random_distances_list,</span>
<span id="cb18-126"><a href="#cb18-126" tabindex="-1"></a> <span class="at">group =</span> <span class="st">&quot;Random&quot;</span></span>
<span id="cb18-127"><a href="#cb18-127" tabindex="-1"></a>)</span>
<span id="cb18-128"><a href="#cb18-128" tabindex="-1"></a></span>
<span id="cb18-129"><a href="#cb18-129" tabindex="-1"></a><span class="co"># merge the data frame</span></span>
<span id="cb18-130"><a href="#cb18-130" tabindex="-1"></a>real_distances_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-131"><a href="#cb18-131" tabindex="-1"></a> <span class="at">distance =</span> snp_with_distance<span class="sc">$</span>nearest_junction_distance,</span>
<span id="cb18-132"><a href="#cb18-132" tabindex="-1"></a> <span class="at">group =</span> <span class="st">&quot;Real&quot;</span></span>
<span id="cb18-133"><a href="#cb18-133" tabindex="-1"></a>)</span>
<span id="cb18-134"><a href="#cb18-134" tabindex="-1"></a></span>
<span id="cb18-135"><a href="#cb18-135" tabindex="-1"></a></span>
<span id="cb18-136"><a href="#cb18-136" tabindex="-1"></a>all_distances_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(random_distances_df, real_distances_df)</span>
<span id="cb18-137"><a href="#cb18-137" tabindex="-1"></a>group_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Real&quot;</span>,<span class="st">&quot;Random&quot;</span>)</span>
<span id="cb18-138"><a href="#cb18-138" tabindex="-1"></a>all_distances_df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(all_distances_df<span class="sc">$</span>group, <span class="at">levels =</span> group_order)</span>
<span id="cb18-139"><a href="#cb18-139" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb18-140"><a href="#cb18-140" tabindex="-1"></a><span class="co">#  Boxplot</span></span>
<span id="cb18-141"><a href="#cb18-141" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_distances_df, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> <span class="fu">log10</span>(distance<span class="sc">+</span><span class="dv">1</span>), <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb18-142"><a href="#cb18-142" tabindex="-1"></a> <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb18-143"><a href="#cb18-143" tabindex="-1"></a> <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb18-144"><a href="#cb18-144" tabindex="-1"></a> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="fu">rep</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="dv">10</span>))) <span class="sc">+</span></span>
<span id="cb18-145"><a href="#cb18-145" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">title =</span> <span class="cn">NULL</span>,</span>
<span id="cb18-146"><a href="#cb18-146" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb18-147"><a href="#cb18-147" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;log10(Distance (bp)+1)&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-148"><a href="#cb18-148" tabindex="-1"></a> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-149"><a href="#cb18-149" tabindex="-1"></a> <span class="fu">theme</span>(</span>
<span id="cb18-150"><a href="#cb18-150" tabindex="-1"></a>       <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb18-151"><a href="#cb18-151" tabindex="-1"></a>       <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span><span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">7</span>))</span>
<span id="cb18-152"><a href="#cb18-152" tabindex="-1"></a></span>
<span id="cb18-153"><a href="#cb18-153" tabindex="-1"></a></span>
<span id="cb18-154"><a href="#cb18-154" tabindex="-1"></a><span class="fu">saveRDS</span>(all_distances_df,<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/results/splicing_junction_analysis/all_distances_df.rds&quot;</span>)</span></code></pre></div>
<div id="vis" class="section level4">
<h4>vis</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a> all_distances_df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/results/splicing_junction_analysis/all_distances_df.rds&quot;</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co">#  Boxplot</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_distances_df, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> <span class="fu">log10</span>(distance<span class="sc">+</span><span class="dv">1</span>), <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a> <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a> <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="fu">rep</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="dv">10</span>))) <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">title =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;log10(Distance (bp)+1)&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a> <span class="fu">theme_grey</span>() <span class="sc">+</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>       <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span><span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">7</span>))</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>plot</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="read-the-deseq2-results" class="section level3">
<h3>read the DESeq2 results</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>res_DESeq2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/res_DESeq2.rds&quot;</span>)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>log2FC <span class="ot">&lt;-</span>res_DESeq2<span class="sc">@</span>listData[[<span class="st">&quot;log2FoldChange&quot;</span>]]</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>pvals <span class="ot">&lt;-</span> res_DESeq2<span class="sc">@</span>listData[[<span class="st">&quot;pvalue&quot;</span>]]</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">log2FC =</span> log2FC, </span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>                       <span class="at">pvalue =</span> pvals,</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>                       <span class="at">neg_log10_p =</span> <span class="sc">-</span><span class="fu">log10</span>(pvals))</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>volcano_plot_DESeq2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> log2FC, <span class="at">y =</span> neg_log10_p)) <span class="sc">+</span></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a>  <span class="co"># Add light gray background for -1 &lt; log2FC &lt; 1 (non-significant FC region)</span></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">1</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="dv">30</span>, </span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;gray90&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>  </span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>  <span class="co"># Color points based on significance and log2FC:</span></span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a>  <span class="co"># - Red: log2FC &gt; 1 &amp; p &lt; 0.05 (significantly up-regulated)</span></span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a>  <span class="co"># - Blue: log2FC &lt; -1 &amp; p &lt; 0.05 (significantly down-regulated)</span></span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a>  <span class="co"># - Gray: Not significant or |log2FC|  1</span></span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a>    log2FC <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">&quot;Unspliced&quot;</span>,</span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a>    log2FC <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">&quot;Spliced&quot;</span>,</span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Not significant&quot;</span></span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a>  )), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a>  </span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a>  <span class="co"># Manual color scale (red, blue, gray)</span></span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb20-33"><a href="#cb20-33" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb20-34"><a href="#cb20-34" tabindex="-1"></a>      <span class="st">&quot;Spliced&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb20-35"><a href="#cb20-35" tabindex="-1"></a>      <span class="st">&quot;Unspliced&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb20-36"><a href="#cb20-36" tabindex="-1"></a>      <span class="st">&quot;Not significant&quot;</span> <span class="ot">=</span> <span class="st">&quot;gray50&quot;</span></span>
<span id="cb20-37"><a href="#cb20-37" tabindex="-1"></a>    ),</span>
<span id="cb20-38"><a href="#cb20-38" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Regulation&quot;</span>  <span class="co"># Legend title</span></span>
<span id="cb20-39"><a href="#cb20-39" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-40"><a href="#cb20-40" tabindex="-1"></a>  </span>
<span id="cb20-41"><a href="#cb20-41" tabindex="-1"></a>  <span class="co"># Add dashed lines for thresholds:</span></span>
<span id="cb20-42"><a href="#cb20-42" tabindex="-1"></a>  <span class="co"># - Vertical: log2FC = 1</span></span>
<span id="cb20-43"><a href="#cb20-43" tabindex="-1"></a>  <span class="co"># - Horizontal: p-value = 0.05 (-log10(0.05)  1.3)</span></span>
<span id="cb20-44"><a href="#cb20-44" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-45"><a href="#cb20-45" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fu">log10</span>(<span class="fl">0.05</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-46"><a href="#cb20-46" tabindex="-1"></a>  </span>
<span id="cb20-47"><a href="#cb20-47" tabindex="-1"></a>  <span class="co"># Axis labels and theme</span></span>
<span id="cb20-48"><a href="#cb20-48" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-49"><a href="#cb20-49" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;log2 Fold Change&quot;</span>, </span>
<span id="cb20-50"><a href="#cb20-50" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;-log10(p-value)&quot;</span>,</span>
<span id="cb20-51"><a href="#cb20-51" tabindex="-1"></a>    <span class="at">title =</span> <span class="cn">NULL</span></span>
<span id="cb20-52"><a href="#cb20-52" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-53"><a href="#cb20-53" tabindex="-1"></a>   <span class="fu">theme_grey</span>() <span class="sc">+</span></span>
<span id="cb20-54"><a href="#cb20-54" tabindex="-1"></a>   <span class="co"># Set axis limits (zoomed-in view)</span></span>
<span id="cb20-55"><a href="#cb20-55" tabindex="-1"></a>   <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>),<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb20-56"><a href="#cb20-56" tabindex="-1"></a>volcano_plot_DESeq2</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>n_unspliced <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(log2FC <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> pvals <span class="sc">&lt;=</span> <span class="fl">0.05</span>))  </span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>n_spliced <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(log2FC <span class="sc">&lt;=</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> pvals <span class="sc">&lt;=</span> <span class="fl">0.05</span>))  </span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>n_nonsig <span class="ot">&lt;-</span> <span class="fu">sum</span>(pvals <span class="sc">&gt;</span> <span class="fl">0.05</span> <span class="sc">|</span> (log2FC <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> log2FC <span class="sc">&lt;</span> <span class="dv">1</span>))</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>total <span class="ot">&lt;-</span> n_unspliced <span class="sc">+</span> n_spliced <span class="sc">+</span> n_nonsig</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>Percentage <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(n_unspliced, n_spliced, n_nonsig) <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>  <span class="at">Category =</span> <span class="fu">c</span>(<span class="st">&quot;Unspliced&quot;</span>, <span class="st">&quot;Spliced&quot;</span>, <span class="st">&quot;Insignificant&quot;</span>),</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>  <span class="at">Count =</span> <span class="fu">c</span>(n_unspliced, n_spliced, n_nonsig)</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>)</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>pie_chart_DESeq2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> Count, <span class="at">fill =</span> Category)) <span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(Count, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">(&quot;</span>, Percentage, <span class="st">&quot;%)&quot;</span>)), </span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Unspliced&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;Spliced&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>,<span class="st">&quot;Insignificant&quot;</span><span class="ot">=</span><span class="st">&quot;gray50&quot;</span>)) <span class="sc">+</span></span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a>    <span class="at">title =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>  </span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a>  )</span>
<span id="cb21-31"><a href="#cb21-31" tabindex="-1"></a></span>
<span id="cb21-32"><a href="#cb21-32" tabindex="-1"></a>pie_chart_DESeq2</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="meth-density" class="section level3">
<h3>meth density</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="co"># Load input data</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>test.list <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/test.list.rds&quot;</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="co"># Extract different parts of the data</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>spliced.meth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">1</span>]]  <span class="co"># Methylated spliced data</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>spliced.unmeth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">2</span>]]  <span class="co"># Unmethylated spliced data</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>unspliced.meth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">3</span>]]  <span class="co"># Methylated unspliced data</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>unspliced.unmeth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">4</span>]]  <span class="co"># Unmethylated unspliced data</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>isoform.meth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">5</span>]]  <span class="co"># Methylated isoform data</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>isoform.unmeth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">6</span>]]  <span class="co"># Unmethylated isoform data</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a>spliced.meth.sum.cell <span class="ot">&lt;-</span> <span class="fu">apply</span>(spliced.meth.test,<span class="dv">2</span>,sum)<span class="co">#,apply(spliced.meth.control,2,sum))</span></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a>spliced.unmeth.sum.cell <span class="ot">&lt;-</span> <span class="fu">apply</span>(spliced.unmeth.test,<span class="dv">2</span>,sum)<span class="co">#,apply(spliced.unmeth.control,2,sum))</span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a>unspliced.meth.sum.cell <span class="ot">&lt;-</span> <span class="fu">apply</span>(unspliced.meth.test,<span class="dv">2</span>,sum)<span class="co">#,apply(unspliced.meth.control,2,sum))</span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a>unspliced.unmeth.sum.cell <span class="ot">&lt;-</span> <span class="fu">apply</span>(unspliced.unmeth.test,<span class="dv">2</span>,sum)<span class="co">#,apply(unspliced.unmeth.control,2,sum))</span></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a>isoform.meth.sum.cell <span class="ot">&lt;-</span> <span class="fu">apply</span>(isoform.meth.test,<span class="dv">2</span>,sum)<span class="co">#,apply(unspliced.meth.control,2,sum))</span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a>isoform.unmeth.sum.cell <span class="ot">&lt;-</span> <span class="fu">apply</span>(isoform.unmeth.test,<span class="dv">2</span>,sum)<span class="co">#,apply(unspliced.unmeth.control,2,sum))</span></span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a>spliced.sum.cell <span class="ot">&lt;-</span> spliced.meth.sum.cell <span class="sc">+</span> spliced.unmeth.sum.cell</span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a>unspliced.sum.cell <span class="ot">&lt;-</span> unspliced.meth.sum.cell <span class="sc">+</span> unspliced.unmeth.sum.cell</span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a>isoform.sum.cell <span class="ot">&lt;-</span> isoform.meth.sum.cell <span class="sc">+</span> isoform.unmeth.sum.cell</span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a>spliced.prob.cell <span class="ot">&lt;-</span> spliced.sum.cell<span class="sc">/</span>(spliced.sum.cell<span class="sc">+</span>unspliced.sum.cell<span class="sc">+</span>isoform.sum.cell)</span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a>unspliced.prob.cell <span class="ot">&lt;-</span> unspliced.sum.cell<span class="sc">/</span>(spliced.sum.cell<span class="sc">+</span>unspliced.sum.cell<span class="sc">+</span>isoform.sum.cell)</span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a>isoform.prob.cell <span class="ot">&lt;-</span> isoform.sum.cell<span class="sc">/</span>(spliced.sum.cell<span class="sc">+</span>unspliced.sum.cell<span class="sc">+</span>isoform.sum.cell)</span>
<span id="cb22-31"><a href="#cb22-31" tabindex="-1"></a></span>
<span id="cb22-32"><a href="#cb22-32" tabindex="-1"></a></span>
<span id="cb22-33"><a href="#cb22-33" tabindex="-1"></a>spliced.cell.prob <span class="ot">&lt;-</span> spliced.meth.sum.cell<span class="sc">/</span>(spliced.unmeth.sum.cell<span class="sc">+</span>spliced.meth.sum.cell)</span>
<span id="cb22-34"><a href="#cb22-34" tabindex="-1"></a>unspliced.cell.prob <span class="ot">&lt;-</span> unspliced.meth.sum.cell<span class="sc">/</span>(unspliced.unmeth.sum.cell<span class="sc">+</span>unspliced.meth.sum.cell)</span>
<span id="cb22-35"><a href="#cb22-35" tabindex="-1"></a></span>
<span id="cb22-36"><a href="#cb22-36" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb22-37"><a href="#cb22-37" tabindex="-1"></a>  <span class="at">Probability =</span> <span class="fu">c</span>(spliced.cell.prob, unspliced.cell.prob),</span>
<span id="cb22-38"><a href="#cb22-38" tabindex="-1"></a>  <span class="at">Type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;mature RNA&quot;</span>, <span class="st">&quot;pre RNA&quot;</span>), </span>
<span id="cb22-39"><a href="#cb22-39" tabindex="-1"></a>             <span class="fu">c</span>(<span class="fu">length</span>(spliced.cell.prob), <span class="fu">length</span>(unspliced.cell.prob)))</span>
<span id="cb22-40"><a href="#cb22-40" tabindex="-1"></a>)</span>
<span id="cb22-41"><a href="#cb22-41" tabindex="-1"></a></span>
<span id="cb22-42"><a href="#cb22-42" tabindex="-1"></a><span class="co"># Create the density plot</span></span>
<span id="cb22-43"><a href="#cb22-43" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> Probability, <span class="at">fill =</span> Type)) <span class="sc">+</span></span>
<span id="cb22-44"><a href="#cb22-44" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb22-45"><a href="#cb22-45" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Density Plot of Methylation Probabilities&quot;</span>,</span>
<span id="cb22-46"><a href="#cb22-46" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Methylation Probability&quot;</span>,</span>
<span id="cb22-47"><a href="#cb22-47" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-48"><a href="#cb22-48" tabindex="-1"></a>  <span class="fu">theme_grey</span>()<span class="sc">+</span></span>
<span id="cb22-49"><a href="#cb22-49" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb22-50"><a href="#cb22-50" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb22-51"><a href="#cb22-51" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.7</span>),</span>
<span id="cb22-52"><a href="#cb22-52" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_blank</span>())<span class="sc">+</span><span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.8</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="regulatory-mechanisms" class="section level3">
<h3>Regulatory mechanisms</h3>
<div id="finding-sites-where-methylation-levels-are-high-in-pre-mrna-but-low-in-spliced-mrna-as-well-as-sites-where-methylation-levels-are-high-in-spliced-mrna-but-low-in-pre-mrna." class="section level4">
<h4>Finding sites where methylation levels are high in pre-mRNA but low
in spliced mRNA, as well as sites where methylation levels are high in
spliced mRNA but low in pre-mRNA.</h4>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">library</span>(TxDb.Mmusculus.UCSC.mm39.knownGene)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="co">#&gt; Loading required package: GenomicFeatures</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co">#&gt; Loading required package: BiocGenerics</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;BiocGenerics&#39;</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:dplyr&#39;:</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">#&gt;     combine, intersect, setdiff, union</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:stats&#39;:</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="co">#&gt;     IQR, mad, sd, var, xtabs</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="co">#&gt;     anyDuplicated, aperm, append, as.data.frame, basename, cbind,</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="co">#&gt;     colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,</span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="co">#&gt;     get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,</span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="co">#&gt;     match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,</span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="co">#&gt;     Position, rank, rbind, Reduce, rownames, sapply, setdiff, table,</span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="co">#&gt;     tapply, union, unique, unsplit, which.max, which.min</span></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a><span class="co">#&gt; Loading required package: S4Vectors</span></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="co">#&gt; Loading required package: stats4</span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;S4Vectors&#39;</span></span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:tidyr&#39;:</span></span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a><span class="co">#&gt;     expand</span></span>
<span id="cb23-27"><a href="#cb23-27" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:dplyr&#39;:</span></span>
<span id="cb23-28"><a href="#cb23-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-29"><a href="#cb23-29" tabindex="-1"></a><span class="co">#&gt;     first, rename</span></span>
<span id="cb23-30"><a href="#cb23-30" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:utils&#39;:</span></span>
<span id="cb23-31"><a href="#cb23-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-32"><a href="#cb23-32" tabindex="-1"></a><span class="co">#&gt;     findMatches</span></span>
<span id="cb23-33"><a href="#cb23-33" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb23-34"><a href="#cb23-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-35"><a href="#cb23-35" tabindex="-1"></a><span class="co">#&gt;     expand.grid, I, unname</span></span>
<span id="cb23-36"><a href="#cb23-36" tabindex="-1"></a><span class="co">#&gt; Loading required package: IRanges</span></span>
<span id="cb23-37"><a href="#cb23-37" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-38"><a href="#cb23-38" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;IRanges&#39;</span></span>
<span id="cb23-39"><a href="#cb23-39" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:dplyr&#39;:</span></span>
<span id="cb23-40"><a href="#cb23-40" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-41"><a href="#cb23-41" tabindex="-1"></a><span class="co">#&gt;     collapse, desc, slice</span></span>
<span id="cb23-42"><a href="#cb23-42" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:grDevices&#39;:</span></span>
<span id="cb23-43"><a href="#cb23-43" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-44"><a href="#cb23-44" tabindex="-1"></a><span class="co">#&gt;     windows</span></span>
<span id="cb23-45"><a href="#cb23-45" tabindex="-1"></a><span class="co">#&gt; Loading required package: GenomeInfoDb</span></span>
<span id="cb23-46"><a href="#cb23-46" tabindex="-1"></a><span class="co">#&gt; Loading required package: GenomicRanges</span></span>
<span id="cb23-47"><a href="#cb23-47" tabindex="-1"></a><span class="co">#&gt; Loading required package: AnnotationDbi</span></span>
<span id="cb23-48"><a href="#cb23-48" tabindex="-1"></a><span class="co">#&gt; Loading required package: Biobase</span></span>
<span id="cb23-49"><a href="#cb23-49" tabindex="-1"></a><span class="co">#&gt; Welcome to Bioconductor</span></span>
<span id="cb23-50"><a href="#cb23-50" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-51"><a href="#cb23-51" tabindex="-1"></a><span class="co">#&gt;     Vignettes contain introductory material; view with</span></span>
<span id="cb23-52"><a href="#cb23-52" tabindex="-1"></a><span class="co">#&gt;     &#39;browseVignettes()&#39;. To cite Bioconductor, see</span></span>
<span id="cb23-53"><a href="#cb23-53" tabindex="-1"></a><span class="co">#&gt;     &#39;citation(&quot;Biobase&quot;)&#39;, and for packages &#39;citation(&quot;pkgname&quot;)&#39;.</span></span>
<span id="cb23-54"><a href="#cb23-54" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-55"><a href="#cb23-55" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;AnnotationDbi&#39;</span></span>
<span id="cb23-56"><a href="#cb23-56" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:dplyr&#39;:</span></span>
<span id="cb23-57"><a href="#cb23-57" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-58"><a href="#cb23-58" tabindex="-1"></a><span class="co">#&gt;     select</span></span>
<span id="cb23-59"><a href="#cb23-59" tabindex="-1"></a><span class="fu">library</span>(MetaTX)</span>
<span id="cb23-60"><a href="#cb23-60" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb23-61"><a href="#cb23-61" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb23-62"><a href="#cb23-62" tabindex="-1"></a>res_preprocess <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/res_preprocess.rds&quot;</span>)</span>
<span id="cb23-63"><a href="#cb23-63" tabindex="-1"></a>spliced_methylation_M_value_meta <span class="ot">&lt;-</span> res_preprocess<span class="sc">$</span>spliced_methylation_M_value_meta</span>
<span id="cb23-64"><a href="#cb23-64" tabindex="-1"></a>unspliced_methylation_M_value_meta <span class="ot">&lt;-</span> res_preprocess<span class="sc">$</span>unspliced_methylation_M_value_meta</span>
<span id="cb23-65"><a href="#cb23-65" tabindex="-1"></a></span>
<span id="cb23-66"><a href="#cb23-66" tabindex="-1"></a></span>
<span id="cb23-67"><a href="#cb23-67" tabindex="-1"></a></span>
<span id="cb23-68"><a href="#cb23-68" tabindex="-1"></a>index_pre_high_spliced_low <span class="ot">&lt;-</span> <span class="fu">which</span>(unspliced_methylation_M_value_meta<span class="sc">-</span>spliced_methylation_M_value_meta<span class="sc">&gt;=</span><span class="dv">1</span>)</span>
<span id="cb23-69"><a href="#cb23-69" tabindex="-1"></a>index_spliced_high_pre_low <span class="ot">&lt;-</span> <span class="fu">which</span>(spliced_methylation_M_value_meta<span class="sc">-</span>unspliced_methylation_M_value_meta<span class="sc">&gt;=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="metatx-plot" class="section level4">
<h4>metaTX plot</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>intersect_pre_dominate <span class="ot">&lt;-</span>index_pre_high_spliced_low</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>intersect_spliced_dominate <span class="ot">&lt;-</span>index_spliced_high_pre_low</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>reads_counts_isoform <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/reads_counts_isoform.rds&quot;</span>)</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>reads_counts_pre <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/reads_counts_pre.rds&quot;</span>)</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>reads_counts_spliced <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/reads_counts_spliced.rds&quot;</span>)</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>reads_counts_meth <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(reads_counts_isoform,<span class="cf">function</span>(x)x[[<span class="st">&quot;methylated_reads&quot;</span>]]))<span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(reads_counts_pre,<span class="cf">function</span>(x)x[[<span class="st">&quot;methylated_reads&quot;</span>]]))<span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(reads_counts_spliced,<span class="cf">function</span>(x)x[[<span class="st">&quot;methylated_reads&quot;</span>]]))</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>reads_counts_unmeth <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(reads_counts_isoform,<span class="cf">function</span>(x)x[[<span class="st">&quot;unmethylated_reads&quot;</span>]]))<span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(reads_counts_pre,<span class="cf">function</span>(x)x[[<span class="st">&quot;unmethylated_reads&quot;</span>]]))<span class="sc">+</span></span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(reads_counts_spliced,<span class="cf">function</span>(x)x[[<span class="st">&quot;unmethylated_reads&quot;</span>]]))</span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a>reads_counts_M_overall <span class="ot">&lt;-</span> ((<span class="fu">rowSums</span>(reads_counts_meth)<span class="sc">+</span><span class="fl">1e-7</span>)<span class="sc">/</span>(<span class="fu">rowSums</span>(reads_counts_unmeth)<span class="sc">+</span><span class="fu">rowSums</span>(reads_counts_meth)<span class="sc">+</span><span class="fl">1e-7</span>))</span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a>index_not_dominate <span class="ot">&lt;-</span> <span class="fu">order</span>(reads_counts_M_overall,<span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>]</span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" tabindex="-1"></a><span class="co"># metaTX</span></span>
<span id="cb24-22"><a href="#cb24-22" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" tabindex="-1"></a>SNP_all <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/origin/SNP_all.rds&quot;</span>)</span>
<span id="cb24-24"><a href="#cb24-24" tabindex="-1"></a>SNP_1019 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/SNP_1019.rds&quot;</span>)</span>
<span id="cb24-25"><a href="#cb24-25" tabindex="-1"></a>txdb <span class="ot">&lt;-</span> TxDb.Mmusculus.UCSC.mm39.knownGene</span>
<span id="cb24-26"><a href="#cb24-26" tabindex="-1"></a></span>
<span id="cb24-27"><a href="#cb24-27" tabindex="-1"></a></span>
<span id="cb24-28"><a href="#cb24-28" tabindex="-1"></a>SNP_intersect_pre_dominate <span class="ot">&lt;-</span> SNP_1019[intersect_pre_dominate]</span>
<span id="cb24-29"><a href="#cb24-29" tabindex="-1"></a>SNP_intersect_spliced_dominate <span class="ot">&lt;-</span> SNP_1019[intersect_spliced_dominate]</span>
<span id="cb24-30"><a href="#cb24-30" tabindex="-1"></a>SNP_intersect_not_dominate <span class="ot">&lt;-</span> SNP_all[index_not_dominate]</span>
<span id="cb24-31"><a href="#cb24-31" tabindex="-1"></a>SNP_background <span class="ot">&lt;-</span> SNP_1019</span>
<span id="cb24-32"><a href="#cb24-32" tabindex="-1"></a></span>
<span id="cb24-33"><a href="#cb24-33" tabindex="-1"></a>SNP_to_exclude <span class="ot">&lt;-</span> <span class="fu">c</span>(SNP_intersect_pre_dominate, SNP_intersect_spliced_dominate)</span>
<span id="cb24-34"><a href="#cb24-34" tabindex="-1"></a></span>
<span id="cb24-35"><a href="#cb24-35" tabindex="-1"></a><span class="fu">library</span>(GenomicRanges)</span>
<span id="cb24-36"><a href="#cb24-36" tabindex="-1"></a>hits <span class="ot">&lt;-</span> <span class="fu">findOverlaps</span>(SNP_intersect_not_dominate, SNP_to_exclude)</span>
<span id="cb24-37"><a href="#cb24-37" tabindex="-1"></a></span>
<span id="cb24-38"><a href="#cb24-38" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(hits)<span class="sc">!=</span><span class="dv">0</span>){</span>
<span id="cb24-39"><a href="#cb24-39" tabindex="-1"></a>  SNP_intersect_not_dominate<span class="ot">&lt;-</span> SNP_intersect_not_dominate[<span class="sc">-</span><span class="fu">queryHits</span>(hits)]</span>
<span id="cb24-40"><a href="#cb24-40" tabindex="-1"></a>}</span>
<span id="cb24-41"><a href="#cb24-41" tabindex="-1"></a></span>
<span id="cb24-42"><a href="#cb24-42" tabindex="-1"></a>remap_results_pre_dominate <span class="ot">&lt;-</span> <span class="fu">remapCoord</span>(<span class="at">features =</span> SNP_1019[intersect_pre_dominate], <span class="at">txdb =</span> txdb)</span>
<span id="cb24-43"><a href="#cb24-43" tabindex="-1"></a>remap_results_spliced_dominate <span class="ot">&lt;-</span> <span class="fu">remapCoord</span>(<span class="at">features =</span> SNP_1019[intersect_spliced_dominate], <span class="at">txdb =</span> txdb)</span>
<span id="cb24-44"><a href="#cb24-44" tabindex="-1"></a>remap_results_not_dominate <span class="ot">&lt;-</span> <span class="fu">remapCoord</span>(<span class="at">features =</span> SNP_intersect_not_dominate, <span class="at">txdb =</span> txdb)</span>
<span id="cb24-45"><a href="#cb24-45" tabindex="-1"></a>remap_results_background <span class="ot">&lt;-</span> <span class="fu">remapCoord</span>(<span class="at">features =</span> SNP_background, <span class="at">txdb =</span> txdb)</span>
<span id="cb24-46"><a href="#cb24-46" tabindex="-1"></a></span>
<span id="cb24-47"><a href="#cb24-47" tabindex="-1"></a></span>
<span id="cb24-48"><a href="#cb24-48" tabindex="-1"></a><span class="co"># Step 2: Create plots for each subset</span></span>
<span id="cb24-49"><a href="#cb24-49" tabindex="-1"></a>plot_pre_dominate <span class="ot">&lt;-</span> <span class="fu">directPlot</span>(remap_results_pre_dominate)</span>
<span id="cb24-50"><a href="#cb24-50" tabindex="-1"></a>plot_spliced_dominate <span class="ot">&lt;-</span> <span class="fu">directPlot</span>(remap_results_spliced_dominate)</span>
<span id="cb24-51"><a href="#cb24-51" tabindex="-1"></a>plot_not_dominate <span class="ot">&lt;-</span> <span class="fu">directPlot</span>(remap_results_not_dominate)</span>
<span id="cb24-52"><a href="#cb24-52" tabindex="-1"></a>plot_background <span class="ot">&lt;-</span> <span class="fu">directPlot</span>(remap_results_background)</span>
<span id="cb24-53"><a href="#cb24-53" tabindex="-1"></a></span>
<span id="cb24-54"><a href="#cb24-54" tabindex="-1"></a>data_a <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(plot_pre_dominate)<span class="sc">$</span>data[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Group =</span> <span class="st">&quot;Precursor&quot;</span>)</span>
<span id="cb24-55"><a href="#cb24-55" tabindex="-1"></a>data_b <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(plot_spliced_dominate)<span class="sc">$</span>data[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Group =</span> <span class="st">&quot;Mature&quot;</span>)</span>
<span id="cb24-56"><a href="#cb24-56" tabindex="-1"></a>data_c <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(plot_not_dominate)<span class="sc">$</span>data[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Group =</span> <span class="st">&quot;Other&quot;</span>)</span>
<span id="cb24-57"><a href="#cb24-57" tabindex="-1"></a>data_d <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(plot_background)<span class="sc">$</span>data[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Group =</span> <span class="st">&quot;Real&quot;</span>)</span>
<span id="cb24-58"><a href="#cb24-58" tabindex="-1"></a></span>
<span id="cb24-59"><a href="#cb24-59" tabindex="-1"></a><span class="co"># Combine all datasets</span></span>
<span id="cb24-60"><a href="#cb24-60" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(data_a, data_b, data_c, data_d)<span class="co">#, data_intersect)</span></span>
<span id="cb24-61"><a href="#cb24-61" tabindex="-1"></a></span>
<span id="cb24-62"><a href="#cb24-62" tabindex="-1"></a>region_rects <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb24-63"><a href="#cb24-63" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>),  <span class="co"># Start positions of each region</span></span>
<span id="cb24-64"><a href="#cb24-64" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>),  <span class="co"># End positions of each region</span></span>
<span id="cb24-65"><a href="#cb24-65" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="fu">min</span>(combined_data<span class="sc">$</span>y, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fl">0.1</span>,  <span class="co"># Adjust below data range</span></span>
<span id="cb24-66"><a href="#cb24-66" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="fu">min</span>(combined_data<span class="sc">$</span>y, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fl">0.05</span>, <span class="co"># Slightly higher to make room</span></span>
<span id="cb24-67"><a href="#cb24-67" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">c</span>(<span class="st">&quot;5&#39; UTR&quot;</span>, <span class="st">&quot;CDS&quot;</span>, <span class="st">&quot;3&#39; UTR&quot;</span>)</span>
<span id="cb24-68"><a href="#cb24-68" tabindex="-1"></a>)</span>
<span id="cb24-69"><a href="#cb24-69" tabindex="-1"></a></span>
<span id="cb24-70"><a href="#cb24-70" tabindex="-1"></a><span class="co"># Calculate the height of 5&#39; UTR and 3&#39; UTR regions</span></span>
<span id="cb24-71"><a href="#cb24-71" tabindex="-1"></a>utr_height <span class="ot">&lt;-</span> region_rects<span class="sc">$</span>ymax[region_rects<span class="sc">$</span>Region <span class="sc">==</span> <span class="st">&quot;5&#39; UTR&quot;</span>] <span class="sc">-</span> region_rects<span class="sc">$</span>ymin[region_rects<span class="sc">$</span>Region <span class="sc">==</span> <span class="st">&quot;5&#39; UTR&quot;</span>]</span>
<span id="cb24-72"><a href="#cb24-72" tabindex="-1"></a></span>
<span id="cb24-73"><a href="#cb24-73" tabindex="-1"></a><span class="co"># Increase the height of CDS region by 20% (can be adjusted as needed)</span></span>
<span id="cb24-74"><a href="#cb24-74" tabindex="-1"></a>cds_height <span class="ot">&lt;-</span> utr_height <span class="sc">*</span> <span class="dv">2</span> <span class="co"># Increase height by 30%</span></span>
<span id="cb24-75"><a href="#cb24-75" tabindex="-1"></a></span>
<span id="cb24-76"><a href="#cb24-76" tabindex="-1"></a><span class="co"># Set ymin and ymax for CDS so that it is centered with respect to 5&#39; UTR and 3&#39; UTR</span></span>
<span id="cb24-77"><a href="#cb24-77" tabindex="-1"></a>region_rects<span class="sc">$</span>ymin[region_rects<span class="sc">$</span>Region <span class="sc">==</span> <span class="st">&quot;CDS&quot;</span>] <span class="ot">&lt;-</span> region_rects<span class="sc">$</span>ymin[region_rects<span class="sc">$</span>Region <span class="sc">==</span> <span class="st">&quot;CDS&quot;</span>] <span class="sc">-</span> <span class="fl">0.5</span><span class="sc">*</span>utr_height  <span class="co"># Decrease ymin for CDS</span></span>
<span id="cb24-78"><a href="#cb24-78" tabindex="-1"></a>region_rects<span class="sc">$</span>ymax[region_rects<span class="sc">$</span>Region <span class="sc">==</span> <span class="st">&quot;CDS&quot;</span>] <span class="ot">&lt;-</span> region_rects<span class="sc">$</span>ymin[region_rects<span class="sc">$</span>Region <span class="sc">==</span> <span class="st">&quot;CDS&quot;</span>] <span class="sc">+</span> cds_height  <span class="co"># Increase ymax for CDS</span></span>
<span id="cb24-79"><a href="#cb24-79" tabindex="-1"></a></span>
<span id="cb24-80"><a href="#cb24-80" tabindex="-1"></a></span>
<span id="cb24-81"><a href="#cb24-81" tabindex="-1"></a>compare_metaTX_plot <span class="ot">&lt;-</span><span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> Group))<span class="sc">+</span></span>
<span id="cb24-82"><a href="#cb24-82" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb24-83"><a href="#cb24-83" tabindex="-1"></a>    <span class="co"># Add region highlights using geom_rect, with consistent positioning across all facets</span></span>
<span id="cb24-84"><a href="#cb24-84" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="at">data =</span> region_rects, <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax, <span class="at">fill =</span> Region),</span>
<span id="cb24-85"><a href="#cb24-85" tabindex="-1"></a>              <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, </span>
<span id="cb24-86"><a href="#cb24-86" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Default linewidth for all regions</span></span>
<span id="cb24-87"><a href="#cb24-87" tabindex="-1"></a>    <span class="co"># Set fill for CDS region to grey (lighter than black)</span></span>
<span id="cb24-88"><a href="#cb24-88" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">subset</span>(region_rects, Region <span class="sc">==</span> <span class="st">&quot;CDS&quot;</span>), <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax),</span>
<span id="cb24-89"><a href="#cb24-89" tabindex="-1"></a>              <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Grey fill for CDS</span></span>
<span id="cb24-90"><a href="#cb24-90" tabindex="-1"></a>    <span class="co"># Adjust 5&#39; UTR and 3&#39; UTR fills to a very dark grey, closer to black</span></span>
<span id="cb24-91"><a href="#cb24-91" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">subset</span>(region_rects, Region <span class="sc">!=</span> <span class="st">&quot;CDS&quot;</span>), <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax,</span>
<span id="cb24-92"><a href="#cb24-92" tabindex="-1"></a>                                                                <span class="at">fill =</span> <span class="fu">factor</span>(Region, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;5&#39; UTR&quot;</span>, <span class="st">&quot;3&#39; UTR&quot;</span>))), </span>
<span id="cb24-93"><a href="#cb24-93" tabindex="-1"></a>              <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb24-94"><a href="#cb24-94" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;5&#39; UTR&quot;</span> <span class="ot">=</span> <span class="fu">grey</span>(<span class="fl">0.15</span>),  <span class="co"># Very dark grey for 5&#39; UTR, closer to black</span></span>
<span id="cb24-95"><a href="#cb24-95" tabindex="-1"></a>                                <span class="st">&quot;CDS&quot;</span> <span class="ot">=</span> <span class="st">&quot;grey&quot;</span>,           <span class="co"># Grey for CDS</span></span>
<span id="cb24-96"><a href="#cb24-96" tabindex="-1"></a>                                <span class="st">&quot;3&#39; UTR&quot;</span> <span class="ot">=</span> <span class="fu">grey</span>(<span class="fl">0.15</span>))) <span class="sc">+</span>  <span class="co"># Very dark grey for 3&#39; UTR</span></span>
<span id="cb24-97"><a href="#cb24-97" tabindex="-1"></a>    <span class="co"># Adjust y position for the text annotations to place them above the rectangles</span></span>
<span id="cb24-98"><a href="#cb24-98" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> region_rects, <span class="fu">aes</span>(<span class="at">x =</span> (xmin <span class="sc">+</span> xmax) <span class="sc">/</span> <span class="dv">2</span>, <span class="at">y =</span> ymax <span class="sc">-</span> <span class="fl">0.5</span>, <span class="at">label =</span> Region),</span>
<span id="cb24-99"><a href="#cb24-99" tabindex="-1"></a>              <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb24-100"><a href="#cb24-100" tabindex="-1"></a>    <span class="co"># Remove Region fill legend</span></span>
<span id="cb24-101"><a href="#cb24-101" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span><span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb24-102"><a href="#cb24-102" tabindex="-1"></a>  <span class="st">&quot;Other&quot;</span> <span class="ot">=</span> <span class="st">&quot;#00ba38&quot;</span>,      </span>
<span id="cb24-103"><a href="#cb24-103" tabindex="-1"></a>  <span class="st">&quot;Mature&quot;</span> <span class="ot">=</span> <span class="st">&quot;#619cff&quot;</span>,     </span>
<span id="cb24-104"><a href="#cb24-104" tabindex="-1"></a>  <span class="st">&quot;Precursor&quot;</span> <span class="ot">=</span> <span class="st">&quot;#F8766d&quot;</span> ,</span>
<span id="cb24-105"><a href="#cb24-105" tabindex="-1"></a>  <span class="st">&quot;Real&quot;</span> <span class="ot">=</span> <span class="st">&quot;#4D4D4D&quot;</span>  </span>
<span id="cb24-106"><a href="#cb24-106" tabindex="-1"></a>),<span class="at">name =</span> <span class="st">&quot;Higher on&quot;</span>)<span class="sc">+</span><span class="fu">theme_grey</span>()<span class="sc">+</span></span>
<span id="cb24-107"><a href="#cb24-107" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb24-108"><a href="#cb24-108" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.7</span>) ,<span class="at">legend.background =</span> <span class="fu">element_blank</span>() )<span class="sc">+</span><span class="fu">xlab</span>(<span class="cn">NULL</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="cn">NULL</span>)</span>
<span id="cb24-109"><a href="#cb24-109" tabindex="-1"></a></span>
<span id="cb24-110"><a href="#cb24-110" tabindex="-1"></a>compare_metaTX_plot</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="find-the-index-of-site-only-detect-methylated-reads-in-spliced-or-pre-mrna" class="section level4">
<h4>find the index of site only detect methylated reads in spliced or
pre mRNA</h4>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>index_meth_only_detect_pre <span class="ot">&lt;-</span>  <span class="fu">which</span>(res_preprocess[[<span class="st">&quot;vg.test&quot;</span>]] <span class="sc">%in%</span> res_preprocess[[<span class="st">&quot;index&quot;</span>]][[<span class="st">&quot;methylation only occurs at unspliced RNA&quot;</span>]])</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>index_meth_only_detect_spliced <span class="ot">&lt;-</span>  <span class="fu">which</span>(res_preprocess[[<span class="st">&quot;vg.test&quot;</span>]] <span class="sc">%in%</span>res_preprocess[[<span class="st">&quot;index&quot;</span>]][[<span class="st">&quot;methylation only occurs at spliced RNA&quot;</span>]])</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="co"># only detect at spliced</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>index_meth_only_detect_spliced_int <span class="ot">&lt;-</span>  <span class="fu">intersect</span>(index_meth_only_detect_spliced,intersect_spliced_dominate)</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>SNP_1019[index_meth_only_detect_spliced_int]</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="co">#&gt; GRanges object with 255 ranges and 6 metadata columns:</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="co">#&gt;         seqnames    ranges strand |         ref         alt   quality</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="co">#&gt;            &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt; &lt;numeric&gt;</span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a><span class="co">#&gt;     [1]    chr12  82042831      + |           A           G   7.30814</span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a><span class="co">#&gt;     [2]     chr1 167055341      + |           T           C   7.30814</span></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a><span class="co">#&gt;     [3]    chr10   7651111      + |           T           C   7.30814</span></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a><span class="co">#&gt;     [4]    chr15 100049050      + |           A           G  10.79230</span></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a><span class="co">#&gt;     [5]     chr8  41799385      + |           T           C  39.41490</span></span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a><span class="co">#&gt;     ...      ...       ...    ... .         ...         ...       ...</span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a><span class="co">#&gt;   [251]     chr6  13082432      + |           A           G   7.30814</span></span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a><span class="co">#&gt;   [252]     chr9  86909152      + |           A           G  26.42420</span></span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a><span class="co">#&gt;   [253]    chr11  52127745      + |           A           G   9.76599</span></span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a><span class="co">#&gt;   [254]    chr18  24759496      + |           A           G   5.75677</span></span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a><span class="co">#&gt;   [255]     chr1 182262919      + |           A           G  19.46360</span></span>
<span id="cb25-22"><a href="#cb25-22" tabindex="-1"></a><span class="co">#&gt;                           info transcript_overlapped transcript_strand</span></span>
<span id="cb25-23"><a href="#cb25-23" tabindex="-1"></a><span class="co">#&gt;                    &lt;character&gt;           &lt;character&gt;       &lt;character&gt;</span></span>
<span id="cb25-24"><a href="#cb25-24" tabindex="-1"></a><span class="co">#&gt;     [1] DP=2;VDB=0.88;SGB=-0..  ENSMUST00000221721.2                 +</span></span>
<span id="cb25-25"><a href="#cb25-25" tabindex="-1"></a><span class="co">#&gt;     [2] DP=2;VDB=0.42;SGB=-0..  ENSMUST00000053686.9                 -</span></span>
<span id="cb25-26"><a href="#cb25-26" tabindex="-1"></a><span class="co">#&gt;     [3] DP=2;VDB=0.02;SGB=-0.. ENSMUST00000039763.14                 -</span></span>
<span id="cb25-27"><a href="#cb25-27" tabindex="-1"></a><span class="co">#&gt;     [4] DP=2;VDB=0.58;SGB=-0.. ENSMUST00000100203.10                 +</span></span>
<span id="cb25-28"><a href="#cb25-28" tabindex="-1"></a><span class="co">#&gt;     [5] DP=5;VDB=0.230191;SG.. ENSMUST00000034000.15                 -</span></span>
<span id="cb25-29"><a href="#cb25-29" tabindex="-1"></a><span class="co">#&gt;     ...                    ...                   ...               ...</span></span>
<span id="cb25-30"><a href="#cb25-30" tabindex="-1"></a><span class="co">#&gt;   [251] DP=2;VDB=0.66;SGB=-0.. ENSMUST00000031556.14                 +</span></span>
<span id="cb25-31"><a href="#cb25-31" tabindex="-1"></a><span class="co">#&gt;   [252] DP=3;VDB=0.0588947;S..  ENSMUST00000168529.9                 +</span></span>
<span id="cb25-32"><a href="#cb25-32" tabindex="-1"></a><span class="co">#&gt;   [253] DP=12;VDB=0.60156;SG..  ENSMUST00000147684.8                 +</span></span>
<span id="cb25-33"><a href="#cb25-33" tabindex="-1"></a><span class="co">#&gt;   [254] DP=2;VDB=0.38;SGB=-0..  ENSMUST00000234266.2                 +</span></span>
<span id="cb25-34"><a href="#cb25-34" tabindex="-1"></a><span class="co">#&gt;   [255] DP=3;VDB=0.28399;SGB..  ENSMUST00000117245.2                 +</span></span>
<span id="cb25-35"><a href="#cb25-35" tabindex="-1"></a><span class="co">#&gt;   -------</span></span>
<span id="cb25-36"><a href="#cb25-36" tabindex="-1"></a><span class="co">#&gt;   seqinfo: 22 sequences from an unspecified genome; no seqlengths</span></span>
<span id="cb25-37"><a href="#cb25-37" tabindex="-1"></a></span>
<span id="cb25-38"><a href="#cb25-38" tabindex="-1"></a></span>
<span id="cb25-39"><a href="#cb25-39" tabindex="-1"></a></span>
<span id="cb25-40"><a href="#cb25-40" tabindex="-1"></a><span class="fu">library</span>(biomaRt)</span>
<span id="cb25-41"><a href="#cb25-41" tabindex="-1"></a></span>
<span id="cb25-42"><a href="#cb25-42" tabindex="-1"></a><span class="co"># Ensembl (Mouse)</span></span>
<span id="cb25-43"><a href="#cb25-43" tabindex="-1"></a>ensembl <span class="ot">&lt;-</span> <span class="fu">useEnsembl</span>(<span class="at">biomart =</span> <span class="st">&quot;genes&quot;</span>, <span class="at">dataset =</span> <span class="st">&quot;mmusculus_gene_ensembl&quot;</span>)</span>
<span id="cb25-44"><a href="#cb25-44" tabindex="-1"></a></span>
<span id="cb25-45"><a href="#cb25-45" tabindex="-1"></a><span class="co"># ENST </span></span>
<span id="cb25-46"><a href="#cb25-46" tabindex="-1"></a>transcript_ids <span class="ot">&lt;-</span> SNP_1019[index_meth_only_detect_spliced_int]<span class="sc">$</span>transcript_overlapped</span>
<span id="cb25-47"><a href="#cb25-47" tabindex="-1"></a></span>
<span id="cb25-48"><a href="#cb25-48" tabindex="-1"></a><span class="co"># clean</span></span>
<span id="cb25-49"><a href="#cb25-49" tabindex="-1"></a>transcript_ids_clean <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">..*&quot;</span>, <span class="st">&quot;&quot;</span>, transcript_ids)</span>
<span id="cb25-50"><a href="#cb25-50" tabindex="-1"></a></span>
<span id="cb25-51"><a href="#cb25-51" tabindex="-1"></a><span class="co"># find</span></span>
<span id="cb25-52"><a href="#cb25-52" tabindex="-1"></a>transcript_info <span class="ot">&lt;-</span> <span class="fu">getBM</span>(</span>
<span id="cb25-53"><a href="#cb25-53" tabindex="-1"></a>  <span class="at">attributes =</span> <span class="fu">c</span>(<span class="st">&quot;ensembl_transcript_id&quot;</span>, <span class="st">&quot;ensembl_gene_id&quot;</span>, <span class="st">&quot;external_gene_name&quot;</span>, </span>
<span id="cb25-54"><a href="#cb25-54" tabindex="-1"></a>                 <span class="st">&quot;chromosome_name&quot;</span>, <span class="st">&quot;start_position&quot;</span>, <span class="st">&quot;end_position&quot;</span>, <span class="st">&quot;strand&quot;</span>),</span>
<span id="cb25-55"><a href="#cb25-55" tabindex="-1"></a>  <span class="at">filters =</span> <span class="st">&quot;ensembl_transcript_id&quot;</span>,</span>
<span id="cb25-56"><a href="#cb25-56" tabindex="-1"></a>  <span class="at">values =</span> transcript_ids_clean,</span>
<span id="cb25-57"><a href="#cb25-57" tabindex="-1"></a>  <span class="at">mart =</span> ensembl</span>
<span id="cb25-58"><a href="#cb25-58" tabindex="-1"></a>)</span>
<span id="cb25-59"><a href="#cb25-59" tabindex="-1"></a></span>
<span id="cb25-60"><a href="#cb25-60" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">match</span>(transcript_ids_clean, transcript_info<span class="sc">$</span>ensembl_transcript_id)</span>
<span id="cb25-61"><a href="#cb25-61" tabindex="-1"></a>transcript_info_ordered <span class="ot">&lt;-</span> transcript_info[idx, ]</span>
<span id="cb25-62"><a href="#cb25-62" tabindex="-1"></a>transcript_info_ordered <span class="ot">&lt;-</span>transcript_info_ordered [,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">7</span>)]</span>
<span id="cb25-63"><a href="#cb25-63" tabindex="-1"></a>transcript_info_ordered<span class="sc">$</span>position <span class="ot">&lt;-</span> SNP_1019[index_meth_only_detect_spliced_int]<span class="sc">@</span>ranges<span class="sc">@</span>start</span>
<span id="cb25-64"><a href="#cb25-64" tabindex="-1"></a>transcript_info_ordered<span class="sc">$</span>position <span class="ot">&lt;-</span> transcript_info_ordered<span class="sc">$</span>position<span class="sc">-</span>transcript_info_ordered<span class="sc">$</span>strand</span>
<span id="cb25-65"><a href="#cb25-65" tabindex="-1"></a></span>
<span id="cb25-66"><a href="#cb25-66" tabindex="-1"></a></span>
<span id="cb25-67"><a href="#cb25-67" tabindex="-1"></a>transcript_info_ordered<span class="sc">$</span>meta_M <span class="ot">&lt;-</span> </span>
<span id="cb25-68"><a href="#cb25-68" tabindex="-1"></a>spliced_methylation_M_value_meta[index_meth_only_detect_spliced_int]<span class="sc">-</span>unspliced_methylation_M_value_meta[index_meth_only_detect_spliced_int]</span>
<span id="cb25-69"><a href="#cb25-69" tabindex="-1"></a></span>
<span id="cb25-70"><a href="#cb25-70" tabindex="-1"></a>transcript_info_ordered_spliced <span class="ot">&lt;-</span>transcript_info_ordered</span>
<span id="cb25-71"><a href="#cb25-71" tabindex="-1"></a></span>
<span id="cb25-72"><a href="#cb25-72" tabindex="-1"></a><span class="co"># only detect at pre</span></span>
<span id="cb25-73"><a href="#cb25-73" tabindex="-1"></a>index_meth_only_detect_pre_int <span class="ot">&lt;-</span> <span class="fu">intersect</span>(index_meth_only_detect_pre,intersect_pre_dominate)</span>
<span id="cb25-74"><a href="#cb25-74" tabindex="-1"></a>SNP_1019[index_meth_only_detect_pre_int]</span>
<span id="cb25-75"><a href="#cb25-75" tabindex="-1"></a><span class="co">#&gt; GRanges object with 41 ranges and 6 metadata columns:</span></span>
<span id="cb25-76"><a href="#cb25-76" tabindex="-1"></a><span class="co">#&gt;        seqnames    ranges strand |         ref         alt   quality</span></span>
<span id="cb25-77"><a href="#cb25-77" tabindex="-1"></a><span class="co">#&gt;           &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt; &lt;numeric&gt;</span></span>
<span id="cb25-78"><a href="#cb25-78" tabindex="-1"></a><span class="co">#&gt;    [1]     chr8  69273342      + |           A           G  26.42420</span></span>
<span id="cb25-79"><a href="#cb25-79" tabindex="-1"></a><span class="co">#&gt;    [2]     chr2 118303166      + |           A           G   7.30814</span></span>
<span id="cb25-80"><a href="#cb25-80" tabindex="-1"></a><span class="co">#&gt;    [3]    chr16  85596521      + |           T           C  10.79230</span></span>
<span id="cb25-81"><a href="#cb25-81" tabindex="-1"></a><span class="co">#&gt;    [4]     chr8  36965510      + |           A           G  10.79230</span></span>
<span id="cb25-82"><a href="#cb25-82" tabindex="-1"></a><span class="co">#&gt;    [5]     chr2 158477250      + |           A           G   7.30814</span></span>
<span id="cb25-83"><a href="#cb25-83" tabindex="-1"></a><span class="co">#&gt;    ...      ...       ...    ... .         ...         ...       ...</span></span>
<span id="cb25-84"><a href="#cb25-84" tabindex="-1"></a><span class="co">#&gt;   [37]    chr16  37636150      + |           A           G  26.42420</span></span>
<span id="cb25-85"><a href="#cb25-85" tabindex="-1"></a><span class="co">#&gt;   [38]     chr2 119369615      + |           T           C  19.46360</span></span>
<span id="cb25-86"><a href="#cb25-86" tabindex="-1"></a><span class="co">#&gt;   [39]     chr7 127075423      + |           A           G  26.42420</span></span>
<span id="cb25-87"><a href="#cb25-87" tabindex="-1"></a><span class="co">#&gt;   [40]    chr11  16924147      + |           T           C   7.30814</span></span>
<span id="cb25-88"><a href="#cb25-88" tabindex="-1"></a><span class="co">#&gt;   [41]    chr15  12184079      + |           A           G  40.70820</span></span>
<span id="cb25-89"><a href="#cb25-89" tabindex="-1"></a><span class="co">#&gt;                          info transcript_overlapped transcript_strand</span></span>
<span id="cb25-90"><a href="#cb25-90" tabindex="-1"></a><span class="co">#&gt;                   &lt;character&gt;           &lt;character&gt;       &lt;character&gt;</span></span>
<span id="cb25-91"><a href="#cb25-91" tabindex="-1"></a><span class="co">#&gt;    [1] DP=3;VDB=0.450604;SG.. ENSMUST00000034328.13                 +</span></span>
<span id="cb25-92"><a href="#cb25-92" tabindex="-1"></a><span class="co">#&gt;    [2] DP=2;VDB=0.02;SGB=-0.. ENSMUST00000005233.12                 +</span></span>
<span id="cb25-93"><a href="#cb25-93" tabindex="-1"></a><span class="co">#&gt;    [3] DP=2;VDB=0.38;SGB=-0.. ENSMUST00000023610.15                 -</span></span>
<span id="cb25-94"><a href="#cb25-94" tabindex="-1"></a><span class="co">#&gt;    [4] DP=2;VDB=0.52;SGB=-0..  ENSMUST00000135373.8                 +</span></span>
<span id="cb25-95"><a href="#cb25-95" tabindex="-1"></a><span class="co">#&gt;    [5] DP=2;VDB=0.02;SGB=-0..  ENSMUST00000142531.8                 +</span></span>
<span id="cb25-96"><a href="#cb25-96" tabindex="-1"></a><span class="co">#&gt;    ...                    ...                   ...               ...</span></span>
<span id="cb25-97"><a href="#cb25-97" tabindex="-1"></a><span class="co">#&gt;   [37] DP=3;VDB=0.301053;SG..  ENSMUST00000114763.3                 +</span></span>
<span id="cb25-98"><a href="#cb25-98" tabindex="-1"></a><span class="co">#&gt;   [38] DP=3;VDB=0.421281;SG..  ENSMUST00000060009.9                 -</span></span>
<span id="cb25-99"><a href="#cb25-99" tabindex="-1"></a><span class="co">#&gt;   [39] DP=3;VDB=0.0822145;S..  ENSMUST00000106292.8                 +</span></span>
<span id="cb25-100"><a href="#cb25-100" tabindex="-1"></a><span class="co">#&gt;   [40] DP=2;VDB=0.06;SGB=-0.. ENSMUST00000102881.10                 -</span></span>
<span id="cb25-101"><a href="#cb25-101" tabindex="-1"></a><span class="co">#&gt;   [41] DP=6;VDB=0.713234;SG..  ENSMUST00000122941.8                 +</span></span>
<span id="cb25-102"><a href="#cb25-102" tabindex="-1"></a><span class="co">#&gt;   -------</span></span>
<span id="cb25-103"><a href="#cb25-103" tabindex="-1"></a><span class="co">#&gt;   seqinfo: 22 sequences from an unspecified genome; no seqlengths</span></span>
<span id="cb25-104"><a href="#cb25-104" tabindex="-1"></a></span>
<span id="cb25-105"><a href="#cb25-105" tabindex="-1"></a></span>
<span id="cb25-106"><a href="#cb25-106" tabindex="-1"></a><span class="co"># ENST </span></span>
<span id="cb25-107"><a href="#cb25-107" tabindex="-1"></a>transcript_ids <span class="ot">&lt;-</span> SNP_1019[index_meth_only_detect_pre_int]<span class="sc">$</span>transcript_overlapped</span>
<span id="cb25-108"><a href="#cb25-108" tabindex="-1"></a></span>
<span id="cb25-109"><a href="#cb25-109" tabindex="-1"></a><span class="co"># clean</span></span>
<span id="cb25-110"><a href="#cb25-110" tabindex="-1"></a>transcript_ids_clean <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">..*&quot;</span>, <span class="st">&quot;&quot;</span>, transcript_ids)</span>
<span id="cb25-111"><a href="#cb25-111" tabindex="-1"></a></span>
<span id="cb25-112"><a href="#cb25-112" tabindex="-1"></a><span class="co"># find</span></span>
<span id="cb25-113"><a href="#cb25-113" tabindex="-1"></a>transcript_info <span class="ot">&lt;-</span> <span class="fu">getBM</span>(</span>
<span id="cb25-114"><a href="#cb25-114" tabindex="-1"></a>  <span class="at">attributes =</span> <span class="fu">c</span>(<span class="st">&quot;ensembl_transcript_id&quot;</span>, <span class="st">&quot;ensembl_gene_id&quot;</span>, <span class="st">&quot;external_gene_name&quot;</span>, </span>
<span id="cb25-115"><a href="#cb25-115" tabindex="-1"></a>                 <span class="st">&quot;chromosome_name&quot;</span>, <span class="st">&quot;start_position&quot;</span>, <span class="st">&quot;end_position&quot;</span>, <span class="st">&quot;strand&quot;</span>),</span>
<span id="cb25-116"><a href="#cb25-116" tabindex="-1"></a>  <span class="at">filters =</span> <span class="st">&quot;ensembl_transcript_id&quot;</span>,</span>
<span id="cb25-117"><a href="#cb25-117" tabindex="-1"></a>  <span class="at">values =</span> transcript_ids_clean,</span>
<span id="cb25-118"><a href="#cb25-118" tabindex="-1"></a>  <span class="at">mart =</span> ensembl</span>
<span id="cb25-119"><a href="#cb25-119" tabindex="-1"></a>)</span>
<span id="cb25-120"><a href="#cb25-120" tabindex="-1"></a></span>
<span id="cb25-121"><a href="#cb25-121" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">match</span>(transcript_ids_clean, transcript_info<span class="sc">$</span>ensembl_transcript_id)</span>
<span id="cb25-122"><a href="#cb25-122" tabindex="-1"></a>transcript_info_ordered <span class="ot">&lt;-</span> transcript_info[idx, ]</span>
<span id="cb25-123"><a href="#cb25-123" tabindex="-1"></a>transcript_info_ordered <span class="ot">&lt;-</span>transcript_info_ordered [,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">7</span>)]</span>
<span id="cb25-124"><a href="#cb25-124" tabindex="-1"></a>transcript_info_ordered<span class="sc">$</span>position <span class="ot">&lt;-</span> SNP_1019[index_meth_only_detect_pre_int]<span class="sc">@</span>ranges<span class="sc">@</span>start</span>
<span id="cb25-125"><a href="#cb25-125" tabindex="-1"></a>transcript_info_ordered<span class="sc">$</span>position <span class="ot">&lt;-</span> transcript_info_ordered<span class="sc">$</span>position<span class="sc">-</span>transcript_info_ordered<span class="sc">$</span>strand</span>
<span id="cb25-126"><a href="#cb25-126" tabindex="-1"></a></span>
<span id="cb25-127"><a href="#cb25-127" tabindex="-1"></a></span>
<span id="cb25-128"><a href="#cb25-128" tabindex="-1"></a>transcript_info_ordered<span class="sc">$</span>meta_M <span class="ot">&lt;-</span> </span>
<span id="cb25-129"><a href="#cb25-129" tabindex="-1"></a>unspliced_methylation_M_value_meta[index_meth_only_detect_pre_int]<span class="sc">-</span>spliced_methylation_M_value_meta[index_meth_only_detect_pre_int]</span>
<span id="cb25-130"><a href="#cb25-130" tabindex="-1"></a></span>
<span id="cb25-131"><a href="#cb25-131" tabindex="-1"></a>transcript_info_ordered_pre <span class="ot">&lt;-</span>transcript_info_ordered</span></code></pre></div>
</div>
</div>
</div>
<div id="run-velocity" class="section level2">
<h2>run velocity</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>res_preprocess <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/res_preprocess.rds&quot;</span>)</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="co"># the input data</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>test.list <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/test.list.rds&quot;</span>)</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>control.list <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/control.list.rds&quot;</span>)</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>spliced.meth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">1</span>]]</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>spliced.unmeth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">2</span>]]</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>unspliced.meth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">3</span>]]</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>unspliced.unmeth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">4</span>]]</span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>kCells <span class="ot">=</span> <span class="dv">1</span>; deltaT <span class="ot">=</span><span class="dv">1</span>; kSites <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a><span class="fu">library</span>(VeloRM)</span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a><span class="co"># calculate the emat_size and nmat_size</span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a>emat_size <span class="ot">&lt;-</span> <span class="fu">colSums</span>(spliced.meth.test <span class="sc">+</span> spliced.unmeth.test)</span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a>nmat_size <span class="ot">&lt;-</span> <span class="fu">colSums</span>(unspliced.meth.test <span class="sc">+</span> unspliced.unmeth.test)</span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">methylation.site.relative.velocity.estimates</span>(res_preprocess<span class="sc">$</span>test, res_preprocess<span class="sc">$</span>control,</span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a>                                                    <span class="at">kCells =</span> kCells, <span class="at">deltaT =</span> deltaT, <span class="at">kSites =</span> kSites, </span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a>                                                    <span class="at">fit.quantile =</span> <span class="fl">0.05</span>, <span class="at">n.cores =</span> <span class="dv">1</span>, <span class="at">emat.size =</span> emat_size, </span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a>                                                    <span class="at">nmat.size =</span> nmat_size)</span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a><span class="co">#&gt; fitting gamma coefficients ... done. succesfful fit for 189 sites</span></span>
<span id="cb26-25"><a href="#cb26-25" tabindex="-1"></a><span class="co">#&gt; filtered out 70 out of 189 sites due to low nmat-emat correlation</span></span>
<span id="cb26-26"><a href="#cb26-26" tabindex="-1"></a><span class="co">#&gt; filtered out 17 out of 119 sites due to low nmat-emat slope</span></span>
<span id="cb26-27"><a href="#cb26-27" tabindex="-1"></a><span class="co">#&gt; calculating RNA velocity shift ... calculating delta use model 2 ... done</span></span>
<span id="cb26-28"><a href="#cb26-28" tabindex="-1"></a><span class="co">#&gt; calculating extrapolated cell state ... done</span></span>
<span id="cb26-29"><a href="#cb26-29" tabindex="-1"></a><span class="co">#&gt; fitting gamma coefficients ... done. succesfful fit for 189 sites</span></span>
<span id="cb26-30"><a href="#cb26-30" tabindex="-1"></a><span class="co">#&gt; filtered out 82 out of 189 sites due to low nmat-emat correlation</span></span>
<span id="cb26-31"><a href="#cb26-31" tabindex="-1"></a><span class="co">#&gt; filtered out 11 out of 107 sites due to low nmat-emat slope</span></span>
<span id="cb26-32"><a href="#cb26-32" tabindex="-1"></a><span class="co">#&gt; calculating RNA velocity shift ... calculating delta use model 2 ... done</span></span>
<span id="cb26-33"><a href="#cb26-33" tabindex="-1"></a><span class="co">#&gt; calculating extrapolated cell state ... done</span></span>
<span id="cb26-34"><a href="#cb26-34" tabindex="-1"></a><span class="co">#&gt; calculating P-value ... done</span></span>
<span id="cb26-35"><a href="#cb26-35" tabindex="-1"></a><span class="co">#&gt; calculating methylation level ... done</span></span>
<span id="cb26-36"><a href="#cb26-36" tabindex="-1"></a></span>
<span id="cb26-37"><a href="#cb26-37" tabindex="-1"></a><span class="fu">saveRDS</span>(res, <span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/results/res_A_to_I_velocity.rds&quot;</span>)</span></code></pre></div>
<div id="load-the-embedding-tsne" class="section level3">
<h3>load the embedding (tsne)</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>sra_table <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/origin/SraRunTable_E12.5.csv&quot;</span>, </span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>                      <span class="at">header =</span> <span class="cn">TRUE</span>, </span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>                      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="co"># Extract the first column which contains SRR </span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>classification_table <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/origin/classification.csv&quot;</span>)</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>GSM_info_2 <span class="ot">&lt;-</span> classification_table[,<span class="dv">1</span>]</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>classification_label <span class="ot">&lt;-</span> classification_table[,<span class="dv">2</span>]</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>GSM_info_2 <span class="ot">&lt;-</span> GSM_info_2[<span class="fu">grep</span>(<span class="st">&quot;E12.5&quot;</span>,classification_label)]</span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a>classification_label <span class="ot">&lt;-</span> classification_label [<span class="fu">grep</span>(<span class="st">&quot;E12.5&quot;</span>,classification_label)]</span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>classification_label <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot; </span><span class="sc">\\</span><span class="st">[single cell RNA-seq</span><span class="sc">\\</span><span class="st">]&quot;</span>,<span class="st">&quot;&quot;</span>, classification_label)</span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>classification_label <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;E12.5_&quot;</span>,<span class="st">&quot;&quot;</span>, classification_label)</span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>SRR_info <span class="ot">&lt;-</span> sra_table[<span class="fu">match</span>(GSM_info_2,sra_table[,<span class="dv">17</span>]),<span class="dv">1</span>]</span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">colnames</span>(res[[<span class="dv">3</span>]][[<span class="st">&quot;current&quot;</span>]][[<span class="st">&quot;M&quot;</span>]])<span class="sc">!=</span>SRR_info)</span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a><span class="co">#&gt; integer(0)</span></span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a>embedding <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/origin/embedding.rds&quot;</span>)</span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a>cell.colors <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/origin/cell.colors.rds&quot;</span>)</span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a>embedding <span class="ot">&lt;-</span> embedding[<span class="fu">match</span>(<span class="fu">names</span>(cell.colors), <span class="fu">rownames</span>(embedding)), ]</span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">which</span>(classification_label<span class="sc">%in%</span><span class="fu">rownames</span>(embedding))</span>
<span id="cb27-27"><a href="#cb27-27" tabindex="-1"></a></span>
<span id="cb27-28"><a href="#cb27-28" tabindex="-1"></a>index_order <span class="ot">&lt;-</span> <span class="fu">match</span>(<span class="fu">names</span>(cell.colors),classification_label[index])</span></code></pre></div>
<div id="filter" class="section level4">
<h4>filter</h4>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>SNP_1019 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/pre_process/SNP_1019.rds&quot;</span>)</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="fu">names</span>(SNP_1019) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(test.list[[<span class="dv">1</span>]])</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>spliced_methylation_Beta_value_meta_index <span class="ot">&lt;-</span> res_preprocess[[<span class="st">&quot;spliced_methylation_Beta_value_meta&quot;</span>]]</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>unspliced_methylation_Beta_value_meta_index <span class="ot">&lt;-</span>res_preprocess[[<span class="st">&quot;unspliced_methylation_Beta_value_meta&quot;</span>]]</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>Beta_not_1or0 <span class="ot">&lt;-</span> <span class="fu">apply</span>(res[[<span class="dv">3</span>]][[<span class="st">&quot;current&quot;</span>]]<span class="sc">$</span>Beta,<span class="dv">1</span>,<span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">which</span>(x<span class="sc">!=</span><span class="dv">0</span><span class="sc">&amp;</span>x<span class="sc">!=</span><span class="dv">1</span>)))</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>index_site_name_int_intersect <span class="ot">&lt;-</span>   <span class="fu">names</span>(<span class="fu">which</span>(Beta_not_1or0<span class="sc">&gt;=</span><span class="dv">10</span>))</span></code></pre></div>
</div>
<div id="trajectory-m" class="section level4">
<h4>trajectory M</h4>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>umap_results <span class="ot">&lt;-</span> embedding</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="fu">rownames</span>(umap_results) <span class="ot">&lt;-</span> SRR_info[index][index_order]</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="fu">names</span>(cell.colors) <span class="ot">&lt;-</span> SRR_info[index][index_order]</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>umap_results <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(umap_results)</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>umap_results<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(cell.colors)</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>    <span class="at">data =</span> umap_results,</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">color =</span> color)</span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;PC1&quot;</span>, <span class="at">y =</span> <span class="st">&quot;PC2&quot;</span>) <span class="sc">+</span>  <span class="co"># Change axis labels</span></span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_blank</span>()</span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>arrow.scale<span class="ot">=</span><span class="dv">3</span>; cell.alpha<span class="ot">=</span><span class="fl">0.4</span>; cell.cex<span class="ot">=</span><span class="dv">1</span>; fig.height<span class="ot">=</span><span class="dv">4</span>;</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>vis_umap_Beta_emb_Beta_linear_index  <span class="ot">&lt;-</span> <span class="fu">show.velocity.on.embedding.cor</span>(umap_results[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>             res[[<span class="dv">3</span>]][[<span class="st">&quot;current&quot;</span>]]<span class="sc">$</span>M[index_site_name_int_intersect,index],</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>             res[[<span class="dv">3</span>]][[<span class="st">&quot;projected&quot;</span>]]<span class="sc">$</span>M[index_site_name_int_intersect,index],</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>             res[[<span class="dv">3</span>]][[<span class="st">&quot;delta&quot;</span>]]<span class="sc">$</span>M[index_site_name_int_intersect,index],</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>             <span class="at">cell.colors=</span>cell.colors,<span class="at">n=</span><span class="dv">200</span>,<span class="at">scale=</span><span class="st">&#39;log&#39;</span>,</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>             <span class="at">cex=</span>cell.cex,<span class="at">arrow.scale=</span>arrow.scale,<span class="at">arrow.lwd=</span><span class="fl">0.5</span>,<span class="at">rm_uniform=</span><span class="st">&quot;mode1&quot;</span>)</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a><span class="co">#&gt; delta projections ... log knn ... transition probs ...</span></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a><span class="co">#&gt; &#39;as(&lt;dgeMatrix&gt;, &quot;dgCMatrix&quot;)&#39; is deprecated.</span></span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a><span class="co">#&gt; Use &#39;as(., &quot;CsparseMatrix&quot;)&#39; instead.</span></span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a><span class="co">#&gt; See help(&quot;Deprecated&quot;) and help(&quot;Matrix-deprecated&quot;).</span></span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a><span class="co">#&gt; done</span></span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a><span class="co">#&gt; calculating arrows ... done</span></span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a>vis_umap_Beta_emb_Beta_linear_index[[<span class="dv">1</span>]]</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAIAAACb4TnXAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nOxde1zN9/9/Ju0QztEml/GJ+um7IddsdJJbNNUmM6oV1qaVIrnUurt130kkslqMUboxsooo105uuUyYZbKO5tK2FMqROr8/XqdPny5CF8J5Pnp4fM7n/jk+z/N6v5+vm5JMJoMCCijQOmj3qm9AAQXeZCgIpoACrQgFwRRQoBWhIJgCCrQiFARTQIFWhIJgCijQilAQTAEFWhEKgimgQCtCQbCXijR7pQZgn1Zvx2th+pwd9MOuNXi6a2H6DR3cNm6y1tanPcEbDwXBXjqEa/NkXKTaRZnUegHT7JWUtBPMa/ZK1Vmk3cArmmavvUjcRm/yWpi+9iKx/Cx5a4XiRdqt8FPwOkCmwEtEql39d7f22ry1QsAutc4eeWuFtQ9Mtav+D6y3b1u4yXo7NHzEWwCFBWsD0B4ohPhyHgBcS0kQC9e6GtfZo7+zd2pqlnN/+pRmr2QSJVybx6FZbVwL068zpkuzlw/Tag/rXsCovNBN9nfOkskiOTv0/58OkPvH2zdOVBCsDSDvshjCgdqgVxc6/+tffx9j45rX1ThSJpOxdGsA/U3NhYjaXcOetN1REJqbIkxfe5EOa0dS7aJMnptjL3qTtZG2OwoNH/OGQ0GwV440e5Mo2Hk79wf3LW4e6jBMzq/+eZfFsJvGksA4UlbbzrTWTabZm0ShAZv3FkBBsJcO8SLtWvKcSe7avOd8zZ8f/Z297ViGVfMLxtPs8HxGqwVvMs1eySQKdqmNmdw3FwqCvXTU0w84bx5notNcGE+rZhjLL8A4Upa3Vhhl8sw5WEvdJDtdbOlfkNcFCoK1KfQ3NRc2rAWk2b+YJlHDsLTd7OAOkOsP8ikYokya4KB63pu8FqZP7Ho7bZccrapRKlAHDSvgXDynTF9zuka071Q7wM6ukX0aPr5FbjJvrRBvpzBfGwqCvVQ8+92V78Tdi97Vhg57BsGqZXx2lzqXf8rdtMBNPuUH4S2EgmAvFc/17lbvWIOnHfIsgtFpau1R68QNn7f5N0lsq4e3kXFKMkXRGwUUaDUoRA4FFGhFKAimgAKtCAXBFFCgFaEgmAIKtCIUBFNAgVZE+1Y8d2GSs8PP+QCACV7Ji0fR2pNrpvofAqA5Z2PYjN6teHkFFHj1aD0LdnKNwzGDjcnJycnJG+fc8HdOKgRQmOTsD6/k5OTkjQbHHNacbLWrK6BAm0CrEeyk+NAEK7mF6j3DakK+5CaAm5L8CcJRANBbz0DzkFjBMAXebLTaEHHU4uRR7IeT4kOajDlQKLmhyZjTut5MPxyTFGJU9TBx5MiR7AFnzpxprRtTQIGXiNacg8lRmOTsf2POxsW9gZOSfDBP249Lqn/++QdAt27daKFpaM7hr/DSzTxccelXculu3bo1uLW1VcSTa6Y6HDOoljP6MJqtfD0FFGhTaE2CFSY5T/WHV3KNWNib6UdzMQCFkhvoxyhkRAXeaLQawQqTnB1+7lejzhP6MJqHYklPzD5WrXcooMAbi9aagxVmH8sH8v2nHqpeM8ErefGo3jPCvCRTHab+TH4wBb8UeMPRWgTrPSMseUaDW0YtTk5e3EpXbQWEOs2nhSXhG17tnSjwOuIlqIivK4haHpZyt0Kg03xU00zBOgWeEwqCNQaWXbQcGJfQCOsUUKA+FMG+DWPZnFlcdhEC4xIkeXl1WPdy70uB1wwKgjUM320x/Gkz2D8AQZFRs4YN3p5zjj6y8LA0Z0eMCihQB4ohYsPwmW3t+sXnAPjTZswaNthxxcq+76r1fVftqvO8G48eE8dKdydlp6UCkOS1SKlQBd5AKAjWMFb9vN3zSwvJ71cAdFVREZmZAPhmR9INjT5jdEcA2G//TXZa6hidgQCOFNwMVUzGFGgICoI1jGVzZkny8rafvwhg/emzXTt2eFRR4a7/8dCon7ElFsAvZ3JW28wG4J+a7m5vByAwLuHV3rMCbRCKOdhTMXvk8IfhIbTsd1Qckn16aNTPABKnfwrAYcSQgF+SOzm5BKSl0z6KyZgC9aEgWANYPMXId1vM3vO/AbjqPI9dP3PA/9jly0X/jtXoA6B0dxIrhBDU1dWXzZmlIJsCUAwR64BYMXvk8E3f2vDmOa8/WZNB4zJKN+RkDoCZu34F8F7nzlSxNSgyqnR3EgD+tBkzB36weIoRgGWzrcvLyhReMgUUFqwuAuMSPoncDIAdHxKIXSweVVTQPjREDIqMmqU7XLtv30gbawCHd+/KTktVeMkUUFgwOdTV1b/4UFu9k+p++2/0jE141UO+O0vnnyiQmCUmA3DTGxmcLbdpYklhcXk5e3jB3aLtOecABKSlPwwP6eTkQjLjeEHnxVOM1uxLf+kPpECbgIJgWDzFSFpeBsB+5PCxmhreB4/8ckZurMr9vAGYrZaP8Vh2XXX45klV5aDIrSrv8PbbfzPX08vWQF+ju7qXiVEnJ5dOTi4APoncvN/GaozuiCMFNxdNmQqgl9ZYtwiXZ97PgsnOSkrtysvKO3TkAWC0mec5SoG2CcUQEQBsP9Zll/0mjev8zju03NHbr6O3345pJi56H91ZOj/dSm7WPti4eVDk1mSLz+9JpXrGJtp9+9Y/J5GzIE8SkJYeMduVUddwNXcPdgwJdgypvzNhwWTnBZOdXT72VFfu3v/d/8Wfj53S5zNhp7ELJjs3cpQCbRlvuwVbPMVo9uABn2yJBWC0vZYja7/9N0cKbo7T6KNnbJIVGMRXUxta+9ip8b8A2D5thqexEXmc/VPTAVx1nte3Zw9ZZSWdluAxxSJw0zzXuT+IEoIauZ/487EuH3vy3uEt1fNcnR0IYPoW0102KeKHR1voiRV4qVBYMHBpQHjk4+Ki9xGAgrtF286co5UFRf+c/7d4v40VgGSLz9mdPY2NUE2tgLR0+gigo7ff/FGjPCfIPwoWTacFsmP1b2PBZOf487EA4i7GuAg9e63ucmvp/SkffPrTpzumbzEVdhqrMGKvI9qoBWNr9DytWM+LnudpUGqnlP619dj/9QfQwWMlgEeBy49evlJYen/72fPbzpwFsGzOLLX/feAnPjXnoxEAdnxuSrbL23CcX8aRgLR070+nANh+9nxFeiqAJcuWhZ84M3vY4KnDDQwGjws4lE7sUm7XTlVVFYCKikr9G1NSavfv2rL3Fqmuzg4k26WkhJ4hXWhrO2XlBo9q2lO33uGKS9dBGyVYK5Vtq58oGZq6f/EUI5lMNra/Fq2RVVYm/3G9/wjdhaFr6fCFoWvp2K0nc6ZqaQxUf++C3ZxtF6/4ZRwhwdDv130AioqKljnNB9C5n5aP9geuX3x+PFVcUVEBoGTtrsB98f6pOxZ+HQGgoqKi/nPJZFUVFRWn7XI/itKhNT1Dutxaer/X6i4Apm2a4jLT7Xm+jVdewOztvPSrKtvWVhDqND/Uab6HpTnlTaqrq3MjLaJP5Ry9dr3cz7vcz9t177479+/XPxzA7JHDzRP3JP5+beOZ8x+/3xNAJycXCvWYOfCDUKf5S8I3EHVv/H7F0dffJCo06/JxAIH74tlTiRKCGlQF1x8Ic45xYLTldSNvLb1/a+n9fVd/vS0qoTUhicEt930o8JLQRi1Ya8DD0rxOKheBnFSLpxhFn8oB0H/I0OXhG+r/pHlYmlNyipfRRAB7z11I+OIz8517Pwj7odzP+9ukPUol9yiMI8LHq6OqanlZ2fZpM346nmatq7d47g8AFj9L4QDQ01UAwGnkkhBxgM57Q77+9Uv8CothVgqx/jVFG+3R3LJDxFCn+RTqzsY00XJgXMLT4pi4lybTxyandHJyKffzPvb7H6zq6DVxrOfnU0nnINWxo6qqipEJewlWn3gJfrBXPlh6Oy/9tCHi22LBiFpP+/icIA8ygI7efgAufDv7g549vA8e8c886vn5VCXpo7EafcboDDyeljrxC7mp9LA0D3Sa7xbxAuGI6w+ENfN1UaDt4G2Zg9VHdlqqJC+vwZj3UKf5TwuH5wYobsy54HdEHJJ9GkAnJxf/zBpXFZkvAPxpMxR5Ym8z3goLtiR8Q6DTfDb0lqIEjxTcjPDxQu3KUOrq6iSE0CSK3USH7wc6ObmQcgjg8yE65ENj13yyJfah7gi6Cncg+vIfWYE2grfIgnFf9CMFN9nl+rXZGtzEXe9pbDRr2GDwOiTMNGPZ5Wls5GlsdDz3sp6xSUV6aunupManeQq8DXgrLBiAJeEbQp3mO/r6S8vLtPv2pSR/UgVRPVOiBVZspDEebWLrjXpYmndycvGwNMfdosMlDwIT9yBxz8PwELftcaX//Xfn/v2Cu0V6xiZ0WoXtUuCtIBi3WqhnYFDBrVv2Xt47Lv1es0fk5lm6wwHwp83Yb/8Nm6TM1ULYKVlRURH35JK8PJuNP1K8b4CHe2BcgqOvv+bAgU8qKhS2S4G3gmBkSZRK7gFwGj2ya3vl7ALJjku/e48VehlN7Ojtd8Fujt/xk0SSTyI3I3LzAUfbUUZT6HDSQtjhouMUIwCMtja5ldXV1bk8pEHmqp+3K2RABfA2ECzUaT7X/RWQhvNzZ01LTE6c/unMXb/6HRUD2JhzYYvDtzSVIp1QfEVu3wLjEhht7cC4BO54b8GokUol90Kd5kvy8sjcoXpIGRQZpQTM+Vg3NHX/y35UBdoe3nyCEYIio1g1Ytim7agureE9ZrTf8RMPH1cczzkLwNPYyD81PSAtXfpD2OG01MMlDyR5eRE+XmT9JIWF2367BGD9yTMX7ObES25TpiaXwCw/ybtdZzypwNuGt0VFLP3vv5vXrnHXXLCdBcDv+AkAfdW60sqAtHRKOfH9NW3bmXNLwjcw2tq0SUn6iNjFwsvEqEeXLkGRUahmF4DjOWeJq4FxCYqaHAq8+QRbEr6BRncUNJhsPg3Ab7az+1WTCoD3OGH0yTMASFt3t7dbvnAhS62gyCgvE6OCf/595FMTsjQ06ueb164Fz7LM++svKq+938aq3M/7ky2x/QT8yRHR++2/UVRKVODNJxgASV7e+pNnvCaOBTA1YTeAIdHbBKL1tLXcz/uXi5d5PB5Xq1i1LYY0wCXhGwruyod5HXwbSHlMvHyVLBWb8PJB2A+t+DAKvFZ4KwjGaGuX7k7yzzxKMYQEd+HHAPbbWO29cFFZRQXKNdPR+v6r47mXNbq9R8t3ls5HdcmN47mXiV3bz1+kAh60j/SHsDE6A1k/mwJvLd4KgqHawQWA7Jj3WGGQ+BQA8DpMsZ59Tpm3Zl86SYUUe7Hq5+3ssWv2pR8ueeCfefTLQR8C4KupASgo+ufGo8c0TwNQujvJ09iIFA42XpHdqsBbi7dCRVwSvkGSlzdGZyAJiV4Tx/plHgXwMDzkeO5l1l41TgYPS3OlknueGhpHr10HcOHvW+eUeew8jWC/aSuAgF+Sl5l/QdkrCrzlaH2CFSY5O0iskhePkn8+uWaq/yEAmnM2hs3o3eqXr4F/arqXiREANuzdftNW6ePHEUeOP/NYbmvmbRevADinzGMJuSR8g+MUI43u6tSNZaxGH9sfomXK7RX1RhVoZYLJ2TSh+nNhkrM/vJKTR6EwydlhDVPDu1YGo63tbmnuHxnlaWxEQnxAWnrk3K+O515+/tZe7D5rGto6TqNPAADgky2xBxxtt9Yutf22wXaMvGlG9PG3WvJpRYKdXDPV/5DmHK85x/wl1etuSvInCEcBQG89A82fxScXj3o5DJOnnNjb0UcvE6NxPbpRges6EfRNQKjT/AgfL5rmUV378dOmjzKawkYJv1Ugav0w46fqj1/jLaZZKxJs1OLk5MVAYdIxdlWh5IYmI3e+9mb64ZikEKOqh4kjR45kdzxzRl6kugVrcbVXURHt/EVW/O/4nupZZ89pdhUAGD986NH0fRPf5a9bsogrbLzQpdurqHRUVaWabRXVucwdVVXbP3ehtcbv/GUe2/xLK0Fp99WkPf477/o8APCj+Va7BJuXUHBOUbYNuCnJB/O0jSyp0Ao1OWhNfUvFm+dMUseT2qXUXujSTyoqysvKuGsoX/NJQ+XZXujOX/Kxzb+0kpIS+7G7b2dauOVVOu3DGc80Yq/vU7eZmhx9GM2Xer2aRBU2lGnmwA+2OHxbZ7cxOgO3bYl55tmoaBR1UeEGGdbJmCa8namWZh98wQ4Oe/nzAdzyKn2ld/SK8XIJ1pvply++CfQGUCi5gX7C1pcRiV1szDuvoyrJiZT8T/v4p6bXEdwJrOmT5OWhmlqE+k2JHHxXW+vqARhjIly17dl0fbNB7KKFt5ljL9kP1ofRPBSbZD5qRu/C7GP5E6xaVeFYNmcWl11szPusYYPJSUUca9BhtWzOrCcVFaxRmuvplXj56n4bq7H9tShcQ1peFlqtYQQ7hgCavd7Vijl5BEBMTrbGB4ZLwp1b8+HaKKKP/2A75us9V3eCY7vmJX3dzeCWu4cZgKDAPa/y/l46XjLBes8I85JMdZj6M/nBXoaCSLzixhlKHz9muzRQAsvMgR/wOhaF1hb9WHaxw0tum4ifrWbOiU2kZUmehFHXcDHy6OkadFtUEpIemH/lRqs+VBsHd6D4bcKse12yOpWrAnBysnzbaPYmFx5dt2SR6xc1bVAoMnCMzkC37XHUfJmams/UGTD0/V59+vf3T00vuFtEY8VV39iwusW+mG1Du6t/sCG6zvkXjBrZRVOrolIT95RcjDxQXZf3tqgkNOP7qi5PGikY2ngp0td6uk/LJNbvubpzwkS+i4u82n5MjARAx45MgwR7rZ+6bYgcLxerft7u+aUFV3sYozOQLR4K4D3Vjg66Q28/fnKjpPSD6vUetSdj/GkzEmaaAXjk4+J3REwZ0ACoij0ASZ4kzHojUYtAyxbDrBq8qwWTnQHEn4+9k1gMINgxCM9X8ff1AmmGpRYHDmWWHsqUf2kpqcKYGImtrb67h9lbYsTe/GBfkuaz01I/idzcycmFiqvRpsWjPxoa9fMnW2K5Yz+lknskabAwT9xD5svvqJiC6IldAR7utENPV8FtUQn9sUdRsy8uqL0lo64RZr3xtqikx0y1rBSxq7n7Mx+BDnzt+oO5e5hNNBTUWWltzYSHx72S+3klePMJBsDR13/bmXOexkY0E6OIxAUfjWBHfUQbVAfCM9raXBmwdHdSwkyzDr4h7G5ku0iIZ7SZXTYpda64e+4+l5luDdzKPaWQA/L+D7dFJdO3mPaYqfa0lnyopparubuw09jXsZesj5ckJVX4qu/iVeINHCKSti7Jy9McOLCmFJSvP7sDpfSvP32WPl6db9vR249apdAmAjfn/5wyb5bu8DmxiT26dFkwaiSVZ6NNbhEuNOqbvsWU1uyySYk7uz08vVbEIvFEFBWM6jEkix4z1RpmIwAgJDE4JDGYbKNw0BjnGIdgx5DXZUiZfcJVb7QofAMfgNN8uah461ZJQvzZRo97LpBegrYtmbxRBOPWP8xOSz1W+HdQZBTVGI3w8eJyrNzPm02OJDtmvnNvuZ+3X+bRgpL7jKAr1V0j9zHXZUyXqONEZrQZ8cOjrB0TPzyqOaBfI/dJbCGafavr6Ofu32BbI+IktQWjnXdZpoZZb3SOcWjS1/MKoDdatHip8vXrD/WF7wOl1/Nzd+2ElpZOM09L1LK11dcbLco+4eruYaaiouK7KqkO5doCA98ogoHDrk8iN0t/CFu5p2bwNnvkcEdff43u6kcLbrLp/SzSZ5n7ZR4teVg2e+TwwyUPaGX9UIwGgzPInnCFQa4qFewYIsmTPCqXZnUSu9q5hRwIEiUHrT4WSG6im0UFC/3ns333uJDkSVK37aNl2rmXP38XUvFEqe0bMXcPs+vXc83N+WtWlybtZLLEfy9eqhwb83DgwFEt8rrb2uqj2kJmn3D19opy9zCjlQDMLf4PQECAPXszeEU0e3MIFuo0f3iltE6LPS8To07VRQv1jE0OlzwoyMvr2l6ZJlFXnec9Ki8bGvWztc6HRtsTKBZ+/ckzpbuTls2ZRZ1jnx/133iilsUwa6H1GADOWx3TLqYAuFlcwLJL8vgvi2HW4odHuQd6WvtUVFQw6hpfJ39Jaygego6Kz30NwkSuX891cdExNREDmPGFxNycf+euNDR0YXR0VjPPzCUSC8NJXXNz5UkbeqNFVtbMgIE1W8nWBQU288pNwRsiciyeYnTttwvmiXsAlPt575hmwt3KlsIGwGhrfzZsCNXA+fni5R/P5V51nrfMcDyATyI3U1WpFrwxi2HWwkFjAPR0FVjoWJdKS77VdYzPjenlz+/lz8+9fVHfVKhvKmxA57inFHIgaGr/6ewKCj4KORoY9lWEJE+CNgxWP2QVjoSE0u++021x/VBvtIj+vXDhHne9tTUzYjhzMKPmctknXNXV1Vv26s+DN8eCJV6+Sgsdvf3K/bx3VEfK00puo5PFU4zY9cdzzmqodyOD1rLUCnYMEXYaS+wiTI8zWWrg8cet33+aukPwLl/fVNhjphqSAYB8YoQFk5379tR0MfIIORDUo0vPmR9+mfj7DtpEHNP/vzENDinbIMiCcZfn2rbMnYeHxxUW3h03nnfksBRAfFzJuPGPwsPjYmMk48bzTE3ExG1iYPYJ1xa5aBPwJhBs8RSjSBvr7TnnvCaOZcsBvNe5847PTf1T08l8sXpgqNN8je7qVL6X1swaNrjvu2pUEocQGJcQsCO+BYvLs7Lh6mOBAN5RfkdTQ1MfwjuJxT1mqt1JLBZFBUuKJOzMym2K13uLVG+LSsQ5WYPUhiT+vmOpnsfq7EAA9V0CbROTDC3JgNCLTuyaMJHfIhMhT8/IQ5m1AohXrBRcviQrLLybkiqka506lVt8776vP4NqmgFQV1d/ybWW3wSCER6GhwT8ksx+NPjwf3N2JPE6dCS1nStOkK7IhiMS08Zq96etLdtzqI4iT9h5Nd5CxVoUFRxyIMhlsrsoKljY20DfTghgweT5k3oZHz11hHvsLa/SXv78r4fYtVdpr28qFCUEtXGFIyhwj7uHWT9N0PtN9iQkJLf5+iFhoqFg+AipUK87gBlfSIxNeCuWy138Rw6LiWMrV5QuX8EfMZwB4OuPzIwS4uRzcqylFMg3h2AAPD+fShaMikZ1UFVtpAMDG2JPfJvr6bXtzDkALVWpxi3CJdgxZJdNStafx13GerDpG6ftcvPu5AGw2vM52S5hbwPaJIoKxhOlYcxwJSX53HiXZer0OBM6NnC2CMBC/9dGo7+Rz5C64OvPELuab75YhUNvtCgU8onoggW6paXZWcflUbXsuHTwYMGpU7krV8htXVFREdGm8UAt0j8PZZb6+jOTDJsbnfwmEGzNvnT7KUaRNtZsilcnJ5dZusO3nTlbf5hXPzkyKDKq4G7RpgC5l4w68QXsiG/y/QQ7hqioqFRUVEjyJFvLN++5upNGhqe/ufTR5kEfRekAuOVVeoyfY+vxzfSB5vqmNbEOfdQ0+qhr/Flw7bRdbh91DZaWXw+x6+kq2GWTwqhrSIoKaDDZeMTwqwXriZprK7yRjxbxLNcBq6CYmojHj+elpOpez8/Nz5eGhkhp69YtuXfuSq2smdgYiZU1Y27xf88U7oldLi46Li5E1Lh+mriR3/R54xuiIgKw56Qkz9IdLi0ve1ojc1SPA8mIFdwtmj1yOKvvN6djAxvZVPmfDPeULIZZf6X3zU9Td0z/n7njiEUfbR7E7tnLn2+wTVe1g6rgXT6AHjPVesxUCzkQtPpYYC9/vqT0r4+idG4WFRybnRNr9guAn36LAiAuPOZi5BFmvXGQdNiCyc64p+Rq7k4KZNsMoQoK3EN/LX7m7BOuXAVFKn186lTuvXuCmTMWopp7X9noHDksdXKypH24gZH1hX4CsYv9SCNMik5u2n2+IQRbsy99zb70WbrD7bfEzNkQCSDx8tVls62VSu4tnmJEqf4saD7m6Ovv6Os/S3d4hI8XNX3lcmzZnFlNuxNXc/ceM9W+3+cfciCIgqdMZk/57MPPO3bquMsylc1BPG2Xe1tUEp8bIxw0JitFzFURAXy55/NdlqmS0oIOHXl7/kxymexOO7BxjADCrDdyL9q0u33tEBS4h+tJW78+Z+uW3OUr+CtXjT11SlpcfJcrzcfESMgTPW48LzamrmOjPm3cPcx69ao1ZzY1Eft4SbjnfFG83kNENuyQkrjo3/GCzlQ77Zvv3DTeVYu0sU45eow4tmZfOjecCoCjr39QZFRAWjqb79xksZ5sFwCXye4hB4Jq4qG2AMBPU3ekXf11epwJKRYAQtID7yQWi6IC2TkYF1mFx24WF/B5gvjcGOTWUKtGNUkGOJS7k1gc7NjWxY+WQnR0lq2tfvYJ1/DwuJ697t5/gDNnbqipdb99C2pqyD7hejAjzsdLAiA2RsTqiuDIiY0I91zD2Hy0UYKx6WtPy2NbNmfWjd+vbDt9dvawwZvm2R797SKAyRHRAAIB6Q9hvHnOP1pM905OLfzzz6kjhnXt3Plo0b/rliy6+ee1zf7yKEQVI5MDjrZHCm4C6KiqCoBKrzV+6adBRUVFVVUVQDtlZQA9XQX/rpWnbN5PkWbsOvRjcsQZ+8uF/9wEkFiwo52ysqqqajtl5YQLO/ZdrNsm4suBszUH9HtvkSod7hu+ym2KF216b5Eqe2Z2B7oBuue2WcCspQ6P/jHLwXG8t1dUWfmDzz7rY2rqPnTISuAvABd+Wx4i2pKaEgogILDv48f3hgztyhJm1MdagOTCb8sBDB2yEoChocBn2QwAGyMOd+vWTUVFZeHCb5TbbZk9px8Ao8lH0g+MM5p85HBm6cGDjQWgtJmybc+NxjOaqXcrlaDZdv7irBMnAey98ge7A2+evB6Gq/Dj8NPnvIwmGv0UQ4Xp99t/w6Yq0xxsv/03nsZG3LprdfxgwY4hIYnBLjPdGrcPFRUVZWVlAKoqK2kNvf27bFLKysr0poxyKXUTnfRj1Gnp3fYAACAASURBVDVcJrsvnesCoKys7K/b+Yw2c/XcHwB++nTH17/KY6Nksqoj5w9ZDLNitJmVW5ahUqmiogKA+NJxuhbtRtaSrltRUUGptW0ho7mVDmfDfIGP9UaLssV/eXqspHEggLKyMsf55p6ekQEB9gcz4t7rJissrBl7V1RUpKQKhw5ZmX3C1defycwo8fOXF6J1cBxfUVFB3oXKqqotW65bWzMpqUKjyUcmTORnZJQ0cmONZzS/lnMwSV5epI01+5Eid9efPHPVed5V53ns+pJ//umxeoPfUXFHb7/9NvL8YrarEDdqke0Ahtp+MFa0APBMLcEtwkWUEERaxXdTvLj5l1kp4h4z1dwiXBhtBl1lrnZuAERRwQv951sMsx4kHTb9Q3Pzgda5Jb8B2GWZCkBSWgCA0WbcIlzcIlzQVeYc4yC+dHz6FtM7icVEs5D0wJADQTQ9a/vOsZYCq0/4+jMpqUIrawYA2SUAeqNFhzJLiW9amjpamjoAUlKFFN7BWrPMjBLudMvBYfymaPmmjh0ZJydL2nnCRH4dj/aLoo1asEYQ6jR/9sjhnZxcFnw0gnK6KPFkwUcjAPTp3z9hppl54p47S+f3WL3hzmKHHms2gurVbImdNWwwex62kNsnkZu51bPrxMuz+kFWiljYaWydqNz6cJnp5mruvnpTiPNWxylan562y2W0mZD0QABsoAaVCZAUSSyGWU/fYkqKvE73IaITAUsNPIS6+v+OLquoqHCOcVh/IIxOS6K8+OFRVg5xjnFg1DVYdjXnK31dwA3zJQr5+stTpGNjJDStmjCRT1q83mgRUCNs9O7dPfuEZXh43K1bJWTi2E1sOBXrHyPvAgCWdU3G60cwSV5eiZZGuZ+3f3omd/1ngz4MP3EmuH//yoqKhJlmF+4UlbguYNtYEiJWLPePjBqn0Yc+shxrsFu5urr6ncTirBQxiYHyqMJLWDDZmX3v64Dlj8q7KvH7YphezKX8C8gHZalwdwt2DLEYZl3yX+lpu9yPonRueZV+tHnQ6W8uiU5QAwk4b3V8VCHlpqVwyQlg/YGwYMcQotZbYrsIrFBBOHuuhkVcgZHGjYuXKgMwNRGToevYkUmIP8sVDynbRVVVtYwzR2D9Cs0PwH/9CAbAdKxBwbVrXkYTAVAVmnI/770XLvLffdd+S8zskcM/idwc/7np3L37HXWHRuRc2G9jdeTOPxQSVXC36LCg6ye1vV4NZnm5zHTrMVMNwG1RCavdCQeNiT//jGwRtwiXUOcwNs4QALtAQh+lseBDpSmD5UnQpCv26cUIeAL7H7/pwOtgMdKKHNB1quJwufRW8QrApmjxpmgxKwDqjRZNMrQEkJkROc9hXHR0Fmt/BF1zQkOkP27iAfh2rhRAYeFdoh+5ksPDJeQfIx6yI8wWx2tGMOpj4h8Z9dX/tAqK5PPORz4uv5w5+26PnjLlB7hbtOW4GMCvf95I+j1vwUcj5ukOPXA1752uahRQz2hrc+nUeHXrXTYpwkFjiF1U2QYAo67xnPmOxLEGNzHqGuCUvyX08ucvNfAorSj58uPZrFLiau7+lowAnwk21gnVloeGfFpaOhsjDnN1iNAQadJOZsYXNcbt8eMntGBrqw/oH8yIo3j83r27W1kzJCq2Rhzwa0YwFtRoPNni86vO877e9esTmax/B3mrgRWTxu+49Pu23y7NHjJo/emzD8NDUo4eS75ewM3zf56q8VRsQzhoDGvBKKdr3fL1z//GsxaMXUOqSY+ZakDNSVjnGAVVxefGcF3Prububd/HRXn7pMW16oXICQYgPDxuwEAMGCiYZKjPyoAArl/PJd+XuTkfQEJCKQBv71F+fidDQ5fQSYqL7/bshdgYaUoqA+DO7dKq1ikQ+vqpiPxpMwLS0inm8GTRv75HsjQ1NPoPGUqcmaqlQdwD8OM0UwBuP8eaJ+6Rlpc1oRVD/PnYnq6Cnq6CpQYet7xKd1mmWuhYi6KCn5nvGBDjyyVhfaHvTmKxy+Sa8Ite/vxvdR3ZTfdTpBQ8RczMShFL8iQvIRgq2DHE09rnRS/k7mFG8oODw3gKj2hyYNFzwtMzcsJE/oCBmGRoSaNErgxISEkVfmWjk5BQyubL6AnbAziYEXcwIy40RBoaIg3fwF+/PufsOUnomkUtFelfB6+ZBQuMS5ilO5xtwuD5+VQA9lti1vwcE+o038PSnCR4QodV35OKOHvIoFl6o56/kyWLoqKiYMcQyZWbq48F6vc2EOrqA8AlmbjrM7REgighiBUh6xs9EutDDgQtNfBAte2qg102KT1mqt0WlYgLj7mau7VGldI6eb73U6RlZWUveiFuaJ+trX7z6wLUB8cDhvBwSc9edykwigiG6pzlOsM8bhjHkyePD2bEjRjOsGuo0FVaqsTHayVXRWxBvGYWzMPSfPbI4dw1x3Mvzx45nA3qLfnvX+7WHms2Lhg5fPaQQXvP/9a0KF5JnsRipNVtUcn0OJOergJyQDVSyZAF+a9ECUH0J3dnVbvLaB9XO7c7icVKHWQ37//lMtOtqKioqKhIlBDUxZR3J7GY7B47QBVFBeOeUiNXbCbYK6LaOfE8BU+50vnQIStJ4mtOdGwjoOSXgxlxxcV3hXrdQ0OkI4YzeqNFXF3R3cNMS0snJCSXXWNuzqex4rq1MgreJSTtZABYWTPZJ1xnz+4bHh53/XouWhqvmQUDoGdsgsjNx3MvA+jk5EKhg4ervViCd9+76jxPQ70bW5Vt/Zlz68+cAxAAeFiav2hbV0ab0TcVZqUc32WTMn2LKUn2d0yLGz+Kqtbg6UaAa9zQVcZ0Zdg9QxKDPay8QZ63QWOctzpa6FiTyk+dJRrxEzQBRUVF6urqZCpRHXXVY6baLpsUceExMrONGzSKhfXxklz4bXlZ7UaELQUujX28JESYpJ0MpXKePSchlQIAyYxLlpz08zvJ9OlEEzAW3DhDkkAKC++Gh8fZ2GhVVFSYmkhavP7U60cwAhWo4a6hRK/xgs4AWIERwFXneeysrMmQ18+oXTyjQdDv/Rj+hKp3KtmPdV7NOh6tOluLioq6devmau4uyZOIC48xvRgXI4941xhUK5ktUhexjl0iLQdAxq5DVZWV9GvCzhKfpmSS5D19ug696CkpWyqrqtgxWyuBRn0JCaVkgk6dygUgWq3sulSuu5LAGB2dlZsrXrhIqUOHduPGjtq6Jbf80cO9yZXm5nxzCwGxa+w45SOH5ToH+dNafHz7mhGMWITaBWq48uC2M+dohnbBbs62i1cA9OnfH80oaOMW4RLsGBSSGMylViNxSVSnzWDwWHm44CU8zW/W+AxHnk95Dy5GHmzTFtpkMcz6mX6CRnIxaRNrPxf6z7fQqYk7Mxg8Njlzj7GBCQ1N2VCspymZAQH24eFx7FSHagSwLqlWAiVTEklWrigNC+c5O1XW2ae8XKI/hhcaIgUqvw+SG67Ppir303p48aJ8H7NpVVVVAHDmzA32wPq9KZpTPuA1m4MRuLMpNsSJpmERPl6zhg2eNWzwjxcuj2J6r7Sy4PbXa3JbV25p60Y0eorPEA4aQ2G+AISDxhAfmnBRtwgXSVFBHXaJLx3nZkDXB8mArubuuKeEe0oNlrPnxn/Fn49lejEkltK1BKoCSZ6EsmlQ28fABXfYFhMjSUkVph8Y5+Ml8fSMbMLDNo46aWBkwdiPzk7SqWbKtJySKkxJFZKPS1OTRx9p09hxynuTK9XV0U0dVM37rxuy48fk40YfLwkbNMx9RnpM+muCQPqaWTBUy4CB1apG/ZZ5ESuWAwiKjEq49HtC7hXtvn2puE2Tq9k0PqLjQpInoRqj4DimhYPGxMc0q1QoGZPbohKSWJ4Jbjn7nq4CC1hxwiBDuNmZNKUMORBkoWPNrWcalRPxY04Ea74ah5OTpd5oEWU0Un7+oUzxCwUZ0VtL5a/xFItx/Xqup2eulTVz9pyE2iABKCy826M7LyGhNHlPJXmWt27J/cpGp7j47pMnjx89erJ1S13dwnVpJSAnp3J75aSd7yfEl3h6/IV6QVgEbvQjjTxf4MFeR4IR6hii0Ho9yAF8oNnPoPf7tOzo618nhuNF8fyaNWtz6hifJmD9gbB49VjWzf3MwPlgx5DlNqsCY/24twGgwWkbGwgGyv5cXtxjplrwPv+qysofcyLqUKv+RSngCICTkyWFL6mqqrJiA6uYN144hCu+q6qqTjXrmS2upGoz4DANQECAvd5oka+/IDXl79SUv8ll7O6+zmAcDMbxneaXzvhCkrST2br1b3IxFxc/3puM2XOkABISYG7OJ6Pn5Iz27ZXXrK4EMMlw1KlTuQkJpekHxp08dZ1yNLkhV/UrC7xoc7PXlWCNgM1K9vnU+PC5C1QOQM/YpGXrsTUINnCeBel+za8Tyr7uzwwi8Q1fBY7RAyBKDuIrd62vPVaPAAUALHSsKWBSVVV15ZZlLjPduDrnQv/54GQD0HtPOVcjhsv7fbGlL1Adc0TUouYVlHCNhmjGhmUot2vH9OlktQFO8yU+XvIId7IYdSrRR0dnRUdnXb+eO2ly93v3MGI4syHi0nzHEla6SEgoHTeeN0L3ScFf0OgLAAkJpaP1lE5ky8LDkLTzfX6XEgCmJuJx43kAjCYfWeLCq2+g6HJ4inF7HryBBAMQFBlFTcC4aIJG/5zg/khTK6N/15ZVVFTQW24xzGp9bNNV9eqX9dkDVBY1rrPkIABUNG6XTQrdJ8sc6qV02i439/ZFYwOTeNcYUVSwinp7cEbFFLOyzmtD9ZMGAYBA7pJCdcIIDdiGDlk511bI/XWnmjzgTOS491/HRGzb9hcAcwsGKCXxnX2t2d3YadJcW6GWls4kQ/2DGXFnz0l8vOTDhMVLlbPFVTRSHT+eD6DgL+l37soVFSCrRRg8WHDxYgkAVflkGTlncO5sZJ3aciyln/mdPw1vTo9mdXV1tq6Gp7FRQFr6AUfbUUZTuGU2SOQw81pNH/f4L33a2Z7z0nUUOVFCkCRPwmgz7e63l0frdpXhxWMvmpMa7GS0eK3VhjoFT4lydxKLyRYBWOe1QRQVLHxvbElZydfJX1LB4PjzMXHnYriX5s7ZyMSxVGFfO/KDZWaUZHIyf7kHesZ/uikpC8CdxGLuUJNb5BCAhaVg5kw+gFu3S9hmYgCsrBkyj3XMyFxbIRseFRDYt7Kqqrj4ruFEXWI7zQlJ3ly4SElbu4uWprwZhbEJLy1Vam7Ov/9AmpYq5T4O14JRgjP7U4Jqi1pnfPgW9WgOjEsIjEtgs7zq42K+xMxrtb69B3008wpEozR7HrC/0C6T3QElykEOdQ6rqmgKtZoPzQH9nGMcbotKRMlBLmM9bhYVoLrQQFaKOMx6Y0h6oKudm63HN1O1p0+Pq9UlY53XBk9rnyVh8oILdRQRYtfcGfrEFvanneZLN/IbmP17xn8KYFNSljjOTWgZ7Bn/qeRuAVD3OyGDg2rnLxe+/syVy/Jl1nxxXnQ5RSM2JFRWobgYt29JnJws2S4T5KAzNRGHb8D1/FzuSbg65OzZfalAaj9NXLksH+6Sly86GuwosQkuspdPsJNrpvofAqA5Z2PYjN4td16KSABAlegD4xLGT5tOlTZ2ZIrt14V6WJr/N3Qcyy6RrsA1pyQrsukpddymlQCokhRFWtSxAy8TATG+rubuzjEOfOWuN4sKGG2GCg0AmL7F9LaoJORAEMmG36bNpkNoqta4RMkaLmLX82PujDFzZ4wRWgaL49wArIio1bra0zOSUvfZ+HeDcaA8fwCmJuIb+UzHjkDtNg5cM0JnsLHRMpp8xNef8fGSxMaIAFhZM9bWjKmJOCMzB0BVlTQt9QmAgxlxdJLEpHVUohTVo9Pi4ruamjxAbvxtbfWjo+V2DECd0e9z4iX7wQqTnP3hlZycnLzR4JjDmpOtdJkl4Rs8LM1VjEz402akbf3Ffl2o9TSLE1euSaTtAIh0BSJd+Zeob+/BjhibDBcjjwaXXxXcIlzWHwgrrbwnefwX+c3YlhE9XQUuk91dJrurd+hx1eEmraSJFlVo5J4nJDE4K0WclSIWRQXTUXNn1EyZfghj9EaLdiVEoiHPsluEy+zwIXNnjAHAskt86fjK7y3dPczU1dXV1dVtbfUnGgqokdf33+ekHxh3/4E0NUX+0p89J6G8fTp/9gnXBkdxWlo6AwbKPcU+XhJff2bCRD7tSYPD9u2fJO1knJ2knTq1B1BcfJeOPXeWx56TINTr3qungFtckdUMm1w+9SVbsJuS/AnCUQDQW89A82fxycWjRrXc2cmIkSqwJHwDyYbGX31uPc3ifZ+oo5li5B4jwwWAOCbSFUwZad1gQNPzQBQVzEZaoNr3ZTHMmjvQelWgmgIhicFUmJFVPoS9DdIupkzR/DQkOwDAVYebH2zsc9ouF5w5mDznGojJ/rlfdy3LAbMAMNpMT9cgAJ9O4QOY5ywBwO8kWP7dU+tyii8dp1ILQstgACE+tVRvjlGKy89/Ehx03s9/IQBKowRqFdzmOse4Dl/uLA6gBBZ4ekZqaelMmFhy4bz0yGEpFefYmSRN2slcvFhyMCPuRj6jpaVDqWW+/syoj7WMJh8BkBBfsmCBrqmJeJIhmilvyCF7mbiZuHBh4k35hxOhn9V8kMlkuhw0/1Lj5vssv/KYnrHv1959v/bmmS2g5eVXHtOmL6fJKw3eT5HeT5F6WHl7WHm/0FUsh8+iEoX/ri2jhd1z99Gpmv8IzQc90f0U6Zapcb9YpdHD2unOB7BrZlqdN8FOd77l8Fl0FD0XPdEOs1/+cCikfQ64Rs4Wfhq6Yuzpnd7WM/rSym/Nxzb4vPMcxl34bXnoirEAQleMpbT8C78tNzQUoLoO1IXflrN/8xzGsX/ck3DX0DJ7iKGhICCwL/dUtDDPYRwAQ0NB+oFxdJPsgrGx8qjRoBPOcxhnaCiwsBRYWAoA0L+EgMC+9K+hoYB7Py+KZ1iwNHslkyj5958qizSutQG11jwPbkry8VSP0JkzZ9jlJqiIdcBWDgTw109+wswHvYHskn8Krv2+OWiF5UI3ADt2+4c5pDpvNOliykO1xvVCl6bqhdzLVVVWUkR5WyhOuCTMOdgxxNbra75y1ycVTwAsGLmEp8IzH2g9PdEY1ZnUS/U8pBXSDmrv8Lt2BnD98vUw641stNd4HUPKtg6f5t+nf+/ZMtM9x48tWeHHXvHHhKPA0YqKCvr26pgaW1v97Cmj9EaLfFXyff2ZRYvWaGnpZJ/QHzpkpZU1Exy8metAo0gOAOx52CIctt/Krd+maHFp6XVa7tGTX1lVNXTISgrkP5gR5+vPsM7usvIHWVnnAFCFQ1qZllYJYO3aj22/1af8lA8/hJKSEoD4uBLUbmiWm1tFtRPp6g2OEpteFzHNXskkd20eMTEVJkpK9nV/9V4QfRjN5p3gRcF85QlAmPlAPLGzeGLnd+zXyI4llQwYu85tvsqYGqWRTYV6nkQvLtYfCBM/PLrLJkV86bj40vE7icXUvysgxrfFn6XJWOe1wXiwqePohQCcPloCgBFofD3EDtVFQeyGzX/4+EHJf6UAPK19KI+bDUChfU7b5bZXUQZgFOKw4WAsAKsvan4r6dtzcBxfJ3Lv+vXc6OgsmtKMGM5cuYxevQSXL590d18HwNqaoaJrDbaWrVPixtZW//r13PJyCUmOdCyAgwfu+vozKSlbyOvt4yWhAlIANDXf76Yuz2pZvoK/fEWtCig0tpxoKLhyGdRebPkKfp3yiagefD6tWcQz0QjB0nZHwc7bWd6XzjiyBUjWm+mXL5HPrAslN9CPaUEZsTb2+C9du2guEQwA39qTSXso/bIXP2jfQ35PnpVX+87dAPhcjRVaNFeWED88Sq2W0cZKFJLOSXllFE3ywcY+lgNmrc4OpHYthKjzGz4bOM3XMlCSJ8m/coOyVNhCCWzDih6dBp89J7Ew0jYUdv81Vj92p1xS5yofXK+Rra0++W0zM0qsrJmYGImTk6WTk6WJ6fuqqjXNh4gn0dFZGyMOA2AlEHBcbUTCqippcfFdEvSJBrScmVECgFKV2WZFAGJjJKkp0lu3S5J2MqX3H65cUUoxvgAocVO9Gw4euGswDrt2903ayaxcUXrksHS0ntKo0fLH4frfmpZF+kIih3GkLG+gvraSfaps2oteiNCH0TwUm2Q+akbvwuxj+ROsWlDhaBCSnGNkvgCUxgQAEAw1wK0CZGwr3/cDAMHEWcKB+p/HB4jjA58nsLU+nj8U+FWB1HkySj1dBWwXpV2WqQxfg7qQrc4OdPnXfZ3XBucAJ6riWB1mFegy1oNGkncSiw9mFPx9719r6050Bl8fBsCNKxAlBBULjv2fRuHBjOvguMhsbfW5XbkAkJ3p2rWEtRLhG/g9e0nPnS2hwjVk/fRGi6ysGXqzraqNlamJ5LOpynWe7tPPniQlSq9cVsvNlZBLOjZGZG3NxMZISLVXU+uuJyxZs7pStFrZaX4p7cP+CowfzwMwfdpf7AlPZMsAUDwxPUiT46TQqAUznmaHKL+wa7VW9nfOSrWLMmFnZi+I3jPCvPr97DB16lSHYwYbF7cuv4b172c5USjJOcauYdIeSow7cfdhBhnEX84SxweSHWtyAWqqCNAG2QVgl00KGy4MgATDpQYeMee29lHXyP7zOKpr3AP40W/TQv/5LpPdWWk05GjgvospJPRvvRxg9smAP/8qOXLmIgAfX4nhIKsBA3Dyrx+vX88dObKfj5ckJVXo6880+FLSSlMTsdP8UmMTHq38pwiGE3UB5P1xnh2JGZvw2PD8anaJAexNloc7iVYrU9nD0pL2SkpK3XvcHjBQbnDIfLEWMjZGki0WjBvPy8xoD2DAQBzMiJtspOTjJZE+vg/I3W6fTVU2/VR+n5TVZl091GwOxxqbgxlHylJ1Fmkr6dcmmXGkLG9tYxlJjWPU4uTk5OTk5Bb1MjeIw+tXkR+ZZyaPDyJ2lX4zgKwZgJzzByXeUxi/fUILz5ERC1r5jl42qP4H+cHYOVVUTgSAa3f/aN9RedEeB/G/R1l29ZipRnoPusruJBaHpAdSvZB9BXvFD4+KEoKY/zH6pkJRaKkoVD5uJD9b+85PuKXeRwxn6B0ND4979OhheHgc9wVlX31a+PhjHQBVVVLDSV1RPRpcsEA3fAP/ixm8Hj3/PnUql9i1xIUHyFO5unZt37mznKLvvNOuS5cOFAvPglp7kafLycmyd+/u//0nNTbhZR3/O+v439/M7QJAqC9buaKUTj7VrH3Kr5hirDxuPM/HS3L2nISiQGh+2GCQ1PPgGUNE40iZrIH0uf7OWbJX7OV5DoxfsCw3X1IaZSzMfCDes0F5xZ7Kqiqs+pz3pZd0h7xhrHSlGQB07xt1OhXt2+IAr/kQJQQJO40VXzp+2i43KieCryoAoK2hLSkqYHoxVHWD/qVwjfjzsUUHioIdg9AVALiRyurqwXVq6+qbCnclRB7KLA3xGcwqdQAuXigRZ60T6nd3clpCIge9qZMMLfVGi4xNeORuQrVpsrJmRo7sR3vGxkhiYyThG/iPHz/p16891TEixgKSR48eTpqMb+dKfZYBwNXfeT178DIzH0wxVqYRHY0AjU14amrdWflkwED07MXr0pm3coXUy0cZwOIlSm6uMpfv8PsV/LoX386VhoXzAOzaCQA+XpIlLrxTp3IpsKPJdQTenGDf+pixYt3H37iQQ5k3aRaAx7rGsmBr3pdeGGwg9ZzC31tW+pmqMPMB7Z8baP9n7FpafoVNgJp5eIPHkjSa99s1bQ1tAGwm5UL/+eu8NrBhUHcSi9f+srqOi7xOQhc3QpccxylHLh46WgrgU2MBZLJf98mN28JFSurqfSYZWrJVcWg9t2UJW2vAypqxsdFas+YEG33LInwDPz9fOnPGQqonFRoiNZumZPllly8tahW0WbxUec3qShof5uf/rSdsTyPP77/PUVXFgIEIDZFOMVaeYoxFCysXL1FaEyoDsHWbUlUVvv5KFvQ9Onbk3bjxREurEzfUWE+o3KFDp4T4Pxv/wpsc7FvH4XUtTF97EdbmZVWri20VZl6rJy9eVVZWTh+lB7cDUFYVVAK8drKHJ/by95ZJH5QAEE/sLMx8INkaYB8UYeYV2MzY37YJqvAR5RdNH9lOFPHnY+FfK9lMRUWFPYqb0OUyudqBIaiprQvgypWaqyy3dfroCz8AY8cpjxvXvl07HgC2dCGleAFIiP/T3cOsvFwCgCLfySRGbEhA7dbmAKysGS1N5t49OTkNJ+peuZxTVfUkKVFKFzp6RD4ro2yU2BjJhIl8SsekPpfhG/jZYoGaGlJSGVMT8b40ACB2AfhqtnzB/TsAxO1SOi3pHE5Ols0pg9MowVg21biT+ztnyf5nr6StdPmFvcyvAmxgFIC4dcHMV54Sg08lrsYASpPlOU78oH0kM2Kh21NO8waCLZJFZRtppVuECxW0ooaDkjwJo65R0wsXsBhmtf6APNvXaCxz5QoCLH4F0OOoGgBiF4CjRyqPHqkEpEBp9dBOLhVQIBvrg6YhXHh4nJOT5d9/36uS8bg3SaH0MTESUiZGDGdiYiRqat0HDETXriU7k6Qsu7gg81idrsZoaTJamli/PqfOJI2LT6Zg/z585678fVDNCWNiJLExktgYUXNqkjbqaBYtEtul1rdVxpGyVLsok+Z6nV8lGFGaMPMB39oTgPTgdtecEpaHbwnIt86WAScJlEpnU4pKSGJw/PlY2SN5qVOiWfz5WPJQBQXuGdLDithFmDtD329Z319j6zpku3YtoXf9YEbchIl8ciW5e5hdvnxyyZLQ2BhJSqrQ2pqhUjlaWjp+ficzMnOoiNokQ0snJ8uOHZkb+UxmRgnrSfPxkrCjOJ9ltThJQ0Ru6P31/FxKVGkQ37kpAejShQegY4dONuzXWQAAIABJREFUAKYYy60i9RxrZjhiI3OwRqOhmhYq9dxowTkYd02ku6N9UAQAka6AZzaf11kgaA/J1gBiV6S7o44mA2CP/9I3bA5G4OZ3UZaNsLdBHf/4cptVZWVlPWaq/TR1x5TBpnX6v0BuxMJQL1sMwJfr+/Xsxv+35J+FS4ZzgyGcnBEeJs+bpGZ5ZNZGDGfWr88BINTvfuUy7twu9fO3I5tGIfaTDOXDM9bicS+3atW6iYZPXJdW+vozUz/7JnnvZnBmeqjWRZ5UlKxcUQpgiQuPpmHF/1UuWsJ/8EBKnY0WLcbaNdgRz//SolR/jFLWcRnNDLnUakRCfANbyD4/uOletBzp7iiXPcwWSPsNvVtYACAuUxzp7ih4v6++vQclsIxfsOxV3XOrghtoIuxtwC5TnVM2eZRmZb38+be8Sql0PoClBh6s1u/uYVYsODY7fAj35P/XY+i/Jf8I3lVhazn5LOPtiOczjBKqa+iSyfLxkhAT0lKlaalSWnZzH6Y3WkQ26splpKb8TWaN3uw6ldsALFu20HVpJdEgJWULe84JE/lELR8vCdXKHq2nZG7Op+wvqbSTaif+2jWlu3ZCf4wSgDFjGAAkmWQdlwHYuiV33Hgeq0A2p8xjIxbsWpi+doJ5w3JGY9taAi1iwejwOgUCzLxWi6OCGFEaAMuJQpGugD/ZGgBZNhanNockrVjYzEu/ksOfeSylolgMs6ZyxTUKR1SwsLfB5JmT5K4w4LRdbsF/BV8kmQCggKll+9yvtkvSHtqfFRKNxjIVKNHqPvj6XbmWSGK3s5MUwGdTlcrLZQcPyC89bjzvyGEptyFDHRAxKGWLkv9JY7h+PVdLS4f+Ze0Yu76fpmTUx1oVFRVssYAJE/kTDQUjhjNbt+TeuSs9clhKgYhkygBMmMh/9Ohhtlg+41qxUkDhiCxIa4mJkVD/sUYI1mQVsb+puXDRIlGac/1x4LWUBLHQfGsbFxIJrCpo5rU6N18iMJoFBElcjV1zSkgCicsUI/dYnaPGL/Ax81r2BiuKbPVSLsdYcEuOLtXzcJnoAeBmUYGwt8Ff9/ay7KLAP9cl/B6dsCmpdKkLb3WI9J8ivNftict3yPsDe3bX+vlmX/TlK/jsu84FBYJczy/p1VNAJZ8OZsT100R5uYAa50VHZ1GuF6otm7uH2ZXLyDhwQgYcOSxF9dRryZLQK5dx5670u+90jxwWcy8311ZI+oqRUcn9B9InTx4Tu1JShadO5Z46JU1LldIkcMBAdOzYGLueicaGiNVhUXUiOdLslbQXYe3Wti7U10BdXZ1KcUhlSiWV8lk7m9TMRYMr32xQpY0eM9Vc7dyoyjfLrp+m7vhW19FysHUvf/7NogLJ479S7gescLSixOfsE64UzTR+kk5GzhkA+mN6Ll/B910l/etG1ZMnGDsWAHyW8SimiQuK3kC1oaDaafTxen4u1w0FYMRwedC93mjRpmgx2RP2paeUE0+v0WQbrazlZeQ6dOgE4LvvdFFd7pf2X+LCKy+X16v6+GMdw4m66up9KJEsIzOnmzrSUqXZJ1yp89gkQ8tmdop5xhzMOFImyzNP0FbiwG9gnkzW5v1gXPAnW4ujgta5zef10BAMNQCg5BYD4G1TDllQCBVru+SKYkIQo82wiTZ3Eov3FewVvMuXPP4LwEdROvqmQsF7NZoHG/1kaiJOS5VSK4bBgwUA1oTK1oZi6RJ8NlXJd5X027lS0vrMzfn799/fuiXX1ETs68+wCv6kyd1HjYabuzINHdnur0cOSy9ekBcwJDKjoah2NmiQu5uWlg6lRbObaIFmYvTrQCtHDGdSUrZkn3BVU+ueLW7hX9jniKZ/PeKiGgYNC3U8InMNZ5e6T3kydX6pcSf+3jIADzvuicsUA2DyjoAHVDvN6N+VA95pjY69bRYkfrB+MFrJaDOu5m4AqOhAHbCloAj1C0IB2JssS9rJFP599+CBx0afoDfzcMDALvcfSI1NeFS8acmSUD2h8pXL6NCBd+NGh/ANskePHs74osaCJSSUJiSIiXLy+lDhcR07yhnl7mFG9U9J3mBzJfPzQwcOHPXo0cOz5yTcnmBLXHhsXTcCcYzylzMzSrg+NHDyZZqMN6psW4MQGM3KPXVcMNRAUB1Kf3+LT7svXKr+b0RJ4SVkbKNfuVx3R2IXamuPbyqqHV8NZNlwl4Md5VVK2YqIkrsFK7+Xp3vQC03TlQPpf3fv3j4pUfp9iBLD1Ipj6v1+93feufvBh9LHj6s4MkNJdHQWyQzZYgmFSkX/eO7+g/aTjaoOpNdM3pJ2MgnxcjvGVqWvj+rybHyS47PFYjozFeSgctwHM+JIOAEnRt7Kmsk4eO/AgUgtLZ1DmXJDx1KrmZ1imloy4HVA1ylz+JOs7t4r5XURALhbWIBVKVhmKiu+g+T1sjj/0nEWvDHTu9+8QBUEIt3lXZLFUUEymexFdbzGi7C3TTzPrZJxo/GkKCHotzuxVOMJ1W3IAUwytPTxEgGVYeG83u93n/GFZPESpdOnZR4edQRDGeVo0eAwNeUkN26Y7OEUY2WjT9odSK8EoD9G6d132xG7WO1xwEDcyK91h9T7j/xg+flSw4m6OWdyevfuTmXbUBMojBv5zK1buewV6eqenpEffDD8q68+BlBeLrl1q2SioXyg2PxeYY0RrLpkgHN/0uWV7F8XjpE03/X9vr11DSQTOz92iyk17oRPHdFJAECpe9/KOH8AOBLP+2oFbl6go+yDIrI0GXHUC6ckc+v70s+8iorKK68q1SIgBlLkVHWyXE15+lu3Sjp21NkULaY4w6UuvBs3njg7SRYvVa6srPrKhsfNqqS0K3baA0CcdbdOsYDFS5U//rgTa/2yjsuASqqkTQeStWTBFi2EvP5pnI+X5PYtCcsuOlCcdffRI96N/CzaPzo6i80JIAo5OIwvKyvj5tRQHdXmdzlrhGDX/sitKRnQ33nr2gTt3WmRxq8FwwB9e4+E9fLvq921s5UA5vjC/D0Asjs16auCXhp375VwjwLwQhwjtxKjrsGucTV3X/tLc2sttinUn47WfvPMNkWLyTSBYy6+nSsxNuEJ9bvT+uv5ucQxVtBLS5WmpDLskK/aGVUKgBo1AKBCayxRKW64jmFhyycCsLJmCgvvfvedLssuKnPPDQqhe2ZPciizlOrksIPGgAD7luoh2AjB8i7Xcwbm/nENxi9DPmTddk/z3zUCJSUlqspm892ylQPeGXfs0XGRCwBiFwDlRVGVh7bT8t+blvUZZybSFSy/8njL96sA3Pu7kJzvz7y0p7UPgJDEYCpvFrzJ//t9/tTj2NPaJ8DZtzmlb5rw4C1ybBMOj/4xS0VlvI/XEQAXfluekrKF1gcE9j1+/LZyu3bpB8YZTT6ya3ff/enZGyIEFLBvNPkI7VxZWTpggPxUu3b3vfX3PW3tYZRaln5gXF7eeSUlpfQD47b9fMPF1QbAxo2Ho3/M4l4dgIPjeAB5f5SGrlkUItpy+vSlFSsFp09fAqCioqLcrp2qqqqKigr7aOwZHBzHk0YPgGhGH7k7N+cba6MiR3MiOYR27isHvAOAaHZipW17S6/K5PXsDpVmqjV7y0BdGjYHrZBsDRBmPqjKOaZv76GiovLMSI6KigpXc/eP3tGjCme3RSXf7/OnQD4ALjPdWi8ao5WObfLhvquSKirMNkWLhw5ZyY4G/fxOAhg6tDfVtAtbe3uEbrsqmayiooIsUllZWWVVVWnpI5mMl5IqPH36UnVtDHniZkVFRZVMVnpfWlFRYfll7+DgzaQf1r/DjRGHaaW5xf9VVUnNpnVnVc19+0/MnLGwrKysoqKi/oEVFRVlZWWqqqplZWVkwajqXoM7N/KNvRXNH1iQg4toJj24He90ZjdRkiUtKxvOqty5GqMnAWC+8pRsDZDkHLOcKMRE4anNzyjetmCys8Uwa3K5chM6uF22WuXZXjUabD9JFdpo2Wl+KSA2NuF17dpeTa07JX1QpK+7+7pCCVJTcrhNt6ysmfsP7rJqhI+XhOI8zM357MhQTU0C4NatEm6t36dh0mQ5u1h/Gp4uBtKsbOHCyeDIHi3YY/oNJNge/6VmXoH69h59v/auqqqSbA1gnFZLUn8AoPTFUpZdACoztvMmzZK4GlPlKQpQJDQSKkWSBqOuQUWhxZeO1+kVBCAgxvc10hLr4GlyqL2xDYBePfvN8u6NaqaxL2KvXgKglBpJmpvzBw8VAKAMLlTXPwsKWhgeHiesjoln3+bQEEn2CVdVVVVSAgGYm/O/stEZPFRCdTVoZf0GLizbachHbjGqF4Bq11xoiJQafzXyyBs3Hv7qq4/r175vPp5BsCgTpVrlo8TaSovYD21auM+KDATaM195Ml95iifKK0nJdq5mC0vxJs2SHty+MHhD6KJHlHBJsb94jvAOblMV4aAxP03d8XXyl6juZ1knL/g1QrBjiIqKCutoZntSEuW+GPkpqX/r/WIB2Hrr07vo7mG2KVpsZc3QXAvAVzY6ADIyc4AaZzRrrzIzSiYZyq9IZ5hrK4yOzlq4cDLJ/UePgnzEXHbVsSrc3rMAqOQbLdfvSXkoszQh/qkWKShwT7du3djKwS1luwiNEOwpBW9eB+zxX2rmtRqDx3JrtgkzH5z8/ZrEuBNRi/IssyIDRw3or7+2RKQriMusUXVWDnhHaOde/8xsEpSrnZsoKpDt/EBVzZxjHKg/WDMnQq8QgbF+iz6X221Xc3dRQhBlWAK4EilPr1zwmdUA+083/ApK9UW1/mZjo8U9lZpad1ZV546+EuLPNjjO9Fk2o6KigroEuXuY3cgH+YjxFKvCxhxnn3B1cBi/bt0B7lauh40rMz4NLcsrFm/gEJGFjfF4qslBP2WSnGPt75XCYAbV5wAnYoNczIyuAZP5QKQrHys+M5SeKluwzbXED48Su1rnaVod9NtBFThYhCQGWwyzWue14WBG3AD7T9n1VyJ/Xb+3VqevBosHZmaUUOg6fWR50uDbTEIF2zmF+uvV1tbleFp7curdzN1E7Gol8jwP3mSCccHG9WYVncMAd3CcXbn5EsH7fUv/v73zD4uqzvf4m8V2KlvG6pFyh2NMYs9tndWKDZ4GSHBzk0DsuSHyTEmuKT/CZeAaKpGh1qSGheOVEHUtTbmo1BNzQdx0QxeZxNXy7uL13sQH6jBuC10fZ0zWWcS5f3yHw2EYQJFzRg6f18ODZ86P+X7PDG8/3/P5fr6fD2CdcQ9LIsDnxk7PXHlDb5u6vHDrWgB8+3ceJcZHKJernUIpDOawEarOni2tejQtnv0WXyIsN54//6Gu69fZmPCrr/mWZu7hhznxXPDAf+gZr0ZvKTkqWB6PZzyveM0HKmjsBm2XpChWYJWmpYmr3vJIGVBfulZYdqlPXRGRllf+hVWXHMXvfIeNG4WEpKebWubkv+exlgyATssV7lu3Yf96YQ1VburyB+beq7zIYI91Ys/8OvmBufeyUSLTWGa8QfxctH17/Wu5Czo6OoDyDRsaIarudbMGhKV5C9ZiZT6/brCwUHFdWYgWiWGoNSmHF4WnDBCv76ovXSsO0YhIyxOOCjUiALA0ieOedZdXnZP/3iRDNj95ui6vVJdXyjt/0nC21/K4B+be+9pcJaSjYmtYAIh1Vbhv3eZDZra2ZU96ifBMlRlvuPpgi3AaW6BVUnJk+/b6u+7i9u09P0AiQa+syJuTkRHNcm4/8TjH6qS8ZeKS5k3qe7I4fQB7BvuvvxSI1X4rNSmHF8VaMABHNq/5YVXW+PFqfeoKpiVmZ8R10PncWB4IePH1wKWl/OHdTF3Ma590ys6qpKt/8xIX6k5fwb38egve0etXsNlk5dmud/a8xZwcLLSX7WSxiCxM6fAfyz85WQWg9EPPP19httcrrNzma3OXD/qYyqa/WEQVq5ziFSHmGEBJyZFBbsxHKFlgApWmpeP7CS/kCmvaLjkcpnmOPe8ErDsIQDwhxlIMCOqCKEupDN2WH2E9mCi0F+j+j0lY21Ja89FNva0QDL1h//rcpBWC99/jtOrqj554nGPpQdG9OGXCBLXXnITioSCA7dvqb0+3rfIFxgo3o0/Eqnu1ZWiUvYW/9sLSMbGLHE2nG1t4v+V7WGZSIR8Ow52ctBt96grr1nUKM1+M/izMrThIc5NWCA91zPvvccK6tZXJySHTpvWqCMKUFjPD3p/D43YYBA6Mwp/BGB4yqDQtLV3xatsl95oIXTA3Nm6R8+NVcF13LHzUtb5HVI5De9BHWgCYBVOkuoadvukTH5h774b9671WEmVhHyyFhlCosvYLh1Ay81bSY/gE5VswhiAGtlTM6fJzmuZxNVcaW74D4KzcjKN7MfZef9Mfxk6Ncsy+2y8u/adj/EMf+BnOHUVhDRsZMqWdMi/HDcySEX0R8nXDWynQw4cvLVocIaxeYe5+thKZ7WEzXfJ1dzgYFRbMg4i0vEDNRLByYX/82LHwUWdlMQAc2NKV/6yzzARgYlYRdE9HpOU1NvP2z3dzhTU9duyKHcCc/PeEjIvEjcBS6wxaRvSuu7iy7vhgYWmZwC3meJKf0SUwsf+QOQzZxJf/KvdQvlfpMNO88i+sOi13vmwjd+4oumsgsUCQISx8Hp0I3n8x/VUSZb71VxbpX1mk/9vf7M/8Opkt1ryVIq6+ZbQMET1IzlpeGHoPuj3yXavc/ykK6vr22bsCdpzF/7UIlwgpcQS47/3mx2arr7lYffGRGyQlA4X73Mlz6qutLPviAHh4CEc0o05gHiLp5cCISkRdhfBKF8w1/sfbX3WX5GOIZRZwGSo/9bsvrn0wV/3pgmr21E4y6wv7TJbMzATAjZ+4Kb8YolD9/q5iMVbiEEefBxYOgdE1RKw0LdWnrmDFinJP2bmXXw948XWhgrPfhEmIMQT8Z4dq+1kADQULPC4Xq+vT7Q4AKU9m9hxN8hJ9Twhwk7m9p8tYrVrc8McljtjweWDhEJBeYLYKY0JRQ8/rhqKEhISEhARjhU3ytr3DguhZPT71Y1GBkfHuUGDtVNWLKx0bFl6r2Q7g5w8/wqoZAag0LWVXCUHD/7ooYN6jL+m0QeylfkpkfbU1N2mFV+8zwZz1QpputnPQj0t4JEN3YOHIMl+QXGANRQkZu0RJ7GwVRhPyLRaLpSSqLkOsO7moNC1larFf+JYlCHCvswRc61+81vqN/5gxXZ+8N73uKnRR/OTpYlch09i8BLeb5JkPpjyYq2brwfouaia8IiS+F2Q2KOvWVra3t484aTEkfAZrKEow1WpT8lPqTEIuu1a+OUYfDgCap6K0u6wNOeHh0vWgf9iKzIhuabEaK/b7gx0LHxXO4UKjxOs1u8Pw1wZc4M0ZB/imPwmVjokbRzwVNipwSU3r/qzZ7x8XtrP2t7oPHH9/ds8Ll8sVKkLyXrlcLpdreubKgrP/ZD+qN/Y99Id/qF/Kn153FcD0uqvsR/3s/L4X5hneuFztXDYrnyVsY78vVzvzDG/I0/ORSJ7hDfYpCT+j4eOS14vYyjfDc+pQ4OTJk8L2MBbgG+CEzs7OQ0Vvspkx59tJ7oxhu00AjkbdyYJ6pzyk8Zrra/VHb6LLb231mu8L7UdP1366oJqlkZKn5xJdK2nTnZ2dr81dzpKioTuSQ3z+iL5rOdK2NRQlmGoBADH5lhxvQ78gTjuM7d0ywqivsZn3j0ocG7cIgHpaFB87Vv1S/gAh88y5zB7QWR4OkIN+MLo/NC/lJhTMcAosPMdiyRnwDA0X3GxtBTQAbHwLgvWaAc+XBffzWFpe+RdWPjfWAQSsO3j18O7U9cXCCmivjJI/keFltH1oMk80B3Ha2rKKpPBEje3LuuYYg088HB4wdYknoHVhkXdERJeueAXdwcEU2ksMDZkFpkk05/MJGQm7AG1Kifl20BfQXXpP2OZP1bXZL6tEldHZ0maSGXGzSC8wTaLZIn49+EBSfjxqySbP0O872nD95w8JeyLS8kZDVT5i2BldoVJeEaI0BMq/sOKvf2JV+QQi0vJofQpxs5DA3Agayz1lt3++W9jvERxMEDfFqIum94rgr2cvdVpuZs6bLCuwQPmm9fYLvDhZIkEMCgmsB7FyxElLyzetB9AWNC1QF8WTX5G4GWiI2C9C+Dy/8522oGmqSVP53Fj7/cGnxj/OsvwSxKCQBfPOkc1rfvjhBxbkAcBpmqfacRaAesJETJjYBkwyZJ/vvRaTIPpCFmwghHFgwI6zLNCe1RYLjIy/ctXpy54RIwQS2A2hnjBR2OZjx/KxY8eo7iSvPTEoJLCBGD9+vLCoGQBXc4VtBLz4Okv8RhADQwIbiPb2dpaejY0M2W8Azr9/5zENTRBeISfH4LA09Kw2HwD1GEBUaowgBoAs2CAIRgxt36rHQD0GyVnLOdV1X/eLGBmQBRscVp/lfNlG5tUg20XcOCSwG4LVjiBdETcLDREJQkJIYAQhIX4ul8vXfSAIxXKbPoON5uRnt3g5Ne2TpvtL20ZDRIKQEBIYQUgICYwgJIQERhASQgIjCAkhgRGEhJDACEJCSGAEISEkMIKQkNs0kkNhzCkwso3K1Wbf9oSQGRKYtDBpRWQaxC9JZqMHGiJKjqAuj20AcwqMcwqM48ePl71ThEyQBZOQOQVGD0UBiMg0CCNGdtT6QRlZNqVCApOJwinxuWeqyjduAWC3temCQ5i62H4A9cVlPu4iIQE0RJSE6OwFcwqMjS1NhVPihZ3lG7fw26q4xfGXO69++UDnhoqd5UcOCkfFlo1QDGTBhhMmKgA5xes6OjoigFKsEWwUv60KgDUs3d8QOTZ6qvP7i/y8IpXJwETIziEUBlmw4YG5KyIyDWpNoOPAidXaGcw6qePCALCRoUBX2THH9JWqB+8D4MwvU5kMXPESsTUjFAMJbBhgbsCITEP5xi3cYveYkM/cDCA5elbumSpmuwCoqvMCjr6lWhDDXvrtylTtzcE9Kvv4u3C6BaIZM0IZSCkwW4UxwU1Rg7C3oYjtMlbYJGxbVvSvGqwfuF0U1rB0/YktAPQnthROiWfDP/8ZvxSfr/rtDACO6SsBuO3Y/nr0ceITCkA6gTUUZdRFlVgsFoulJKXFxPRkqzCakG+xWCwlUXUZItmNdHLPVBVOiRcsFYMrXsIVL9m06p0xv3YLzBm39srXTVe+bmIvXSnFjukrr9V8HRj9BLuWXB0KQzKBNVhrYwyJGgCAJtEQ08y3Amjlm2P04QCgeSpKW2tVhsIaW5rY4JA5KhqPn2K/2y5d5J7U4ceroTOfZmeq9uZ0Ze/syt4JAGvmAlCZf9t18DQbTxLKQzIvYniOJVx40WCt1XJJgI1v0XJJbJ+GC0Ydb0O4xn3Sr371K+GCkydPso3+kvXcILdy+Y1cG529AEBO8bqPDn526drVTa8V+M963JG17aEv3/vu8+MBv9Dafn/AWfOVtSYdgHr/sh//0QEAL0Vi9zG8uV9lXug07lDvXzbu8P98W2q5++67Adxxxx0y9Fyiy6lpD2Rw09sqjKaWlJIcDdDAN4Pr7zxBVBg5ads6OzsjMg0dHR3Xr1+/6vgxMH+efcchB/Ddmztdh/5iB+xAwMKZjpYLAQXJ9ukrwV7uOATAf9cSZ8pm9sCGVx7+ttTS0dFRX1zG4jlGbgKz0dm0HGnbut0XYp9GQ1FCRl1UiZkNFoM47TC252vEkVB85ubQmU/bL7Rj1mMAJj4cHLBwJjvk2HEIX5xxTF/pX+5+uArYtBhAV8pmlcnA/7lReEMK5lAew2nBwnMslhzRa1uFMWNXcL7FLIwVNVxws7UV0ACw8S0I1mv6vs1IxRqWDkB/YosV+LbUgt9MVR1Z5YxeBcBvftRP5j/d9RsTgMv8359KfwEnQq1h6c78suQzVWwGLOC5MIpFVB6SOTm61ZUTLt4bxGlry5g/8cu6bn+HQmAmi8kMgN/TjwLwr1oOwPVxXVfpIb89v/N/O9l16C/WsPTGlvNc8RLmFEmOnsWduXh+Z7Xv+k5IhVTPYLYv65qBZlNCbfeemHxLTrgm0ZzPJ2Qk7AK0KSXmka2vytXmOQVGvtPBb6vSn9jS2HKeWzizzVSOe+507re6urqcx//X/86fus++W+Wq+bpr9zGsnuv/V9754R/bIv+l/MjB5OhZNDJUMFIJTJNotiR6PeI5kBzp2G1twnbb0dPOmq8QMwUzpqCgwm9XZldKsfvYx3XsX1XzD/+8+GPgpGC0OOy2ptLqE7rgEPm7TcgDhUoNHRbaq44L44qX8H9udCQVBo67DwCeneb34L1eLnghDEDgotigNSltrRcAqDWB6riwiEwDP+W+SS/HTXo5TtYbIKSHBDYUxKG93JM6PnNz26WL6I4/5CIfc5UdUy2IcQnmq2oZnvklPjkBgI9cxkcuU024v631Arc4vu3SxfIjB7kndbpVC9WaQPbOvrszYpghgQ0RwUHfePxUwKbFzvwy7ti7bE+b7W8Arv2z033q/CjEv4vDfw04+hYAdppjxyFVrNuRKIRxcIvj+U6HvPdBSAsJ7KbpNf21rcqRtU39xGTV3hw+chnb6ZxXBKCr7Jj7gitOAKoFMSy6l49cJkyRMfQntljD0gX3Y0SmgQWIEAqAFlzeKgELZwrS4o69y7ZVe/8NcKkevM/5Ywd+vOr89ITzo1oAquo8Z9xaAKrYJxxZ21QmgzOfXIhKhgR2q+jSX2gErlxo7zp4mlkn57Qg57z3AaA6D03fO40f+u35neuTBtX0Kc64tX4zp+J7u8pvTOirBn7cfbxohYs1LJ3WNSsMGiLeNJWrzeKZq8Ytn6gXzhy7cCYA1Vy9Y8chp/FD9b+nqkwGZ9xap/FDAEEPcQHj1E7jhyqT4Wd33Hl+ZzWbVubOXOSKl7D3EZa61BeXHdn4kcw3RUgECWyIMI1xi+PxWLD9QrsjqRBAaG6K38yRvoC5AAAE7ElEQVSpKpNh3Jg7s543AAjYl8sez1iAb+C4+9IK3xSStFWuNturTwQ8F8Zvq0rOTs89U0WTzgqDhohDgQUNTno5Th0X5uj2AbJhXtDzT1/45OiC35tXa2ew/c55Rf6GyLHPP8VE6AEzZXMKjExaFI6oMEhgQ0cXHBIRPQtnZhVOiWdzzQCSo2eVVp9YrZ2Re6Zq02dljqRC5jPUBU+y9v9WpCulQgIbHpKjZwnbuuCQeleDOi48UBPYFvsEGxwi/QUA3JO60tw1FNc7eqBnsKEjeDtYQg62U1gxqQsOSc5ODwz6OcszxVyFHkk7CMVDFuxWqS8ui8g09Jf+mimKaYx5MsiNMaoggd0SzFh5Lf9l/aDM+kGZx7yWYN+IUQIJbBjwqpn29nbmGxTiqsh2jUJIYBIygH0jRgl+LpfL130gCMVym1qwkZK27Ta8nJr2SdNypG0jCMIDEhhBSAgJjCCkxKVcQkNDqWlq2rdNkwUjCAkhgRGEhJDACEJCaKKZICSELBhBSAgJjCAkhARGEBJCAiMICVGcwGwVxr6FbIXqtsYKmxwdELUsX9My3qMYn9yvD79lb4WSB2parvlueTj+/uys/a0ul8vlat2f5d5u3Z81+/3jrl5b0rU/e/bsnjZka1rGexTjm/v13bcsemuvm32bVpYFa7DWxhhYvXVoEg0xzXwrgFa+u1it5qkoba21YaC3uIXGixISTC0p+SmiQu8yNS1jQz347H59+C1rEs3dRZFFrQzUtLIEFp4jqgndYK3VckGAjW/RckFsn4YLRgsvzQAiPMdisZgTg0S75GpavoZE+Ox+ffotC/QUGR+waWUJrAdbhdHUkrIsUQO08s2+6oVsTfvwHsXI3Q0ffcu2CmNCQsYupCSFA4M0PeIF5u2Zs6EoIaMuqsTMhhFBnLb/y4e76d5I1rTPGhoYWbsh07fsBU2i2WKxWAx8hrHCNkjTt2nKgBvHs6a6rcKYsSs432IWBhEaLrjZ2gpoANj4FgTrNdI03RfJmvZZQ7dJN2T8lvsnXB9jsrYC4QM1PeItWC+6P/eeIToABHHa2rIKG8TjZpmQrWkf3qPs3fDht9xQJHLEdz/+Ddi0ooJ9bRXGjF29xsMx7q+hoSjBVAtAm9I9pJC0E7yh59uXrWkZ71GM7Pfr229Z1Lq4mX6bVpTACOJ2Q1lDRIK4zSCBEYSEkMAIQkJIYAQhISQwgpAQEpgCaDJH+PUhwtw0wEmeRwEANWne9xNDhwSmEPQbz4lXSZzbiOzJaTXug03mCL/J+5LO9TrqJxxm1KQ9t1X+fisdEpgyCTG+kYqtn9UAQE3a5GxsPFdvDOk5Wn9uo37r24K5qknz8yN5ScGIj0UkBqPms61IPdCjLkaIsd5lFJ2SesCV+03E5H1y907pkAVTJjVpz21F6vOxQNM3jdD/YvKAZ8eWukpjZerZKIMsmEKwZk/2yxbvSD3QIxrdIyFeLiFkgCyYQvBwcrh6maTGb8g36CNIYEon5BEdrP99ru8BcsrLAQlM8cTm9nIYumkyv72Vho7SQwJTPiHGnRuRPVlkrprMEZOzrakHyLMhOeTkGA2EGOtdj6T5idwg+o3nXJ6ee0ICaMElQUgIDREJQkJIYAQhISQwgpAQEhhBSAgJjCAkhARGEBJCAiMICSGBEYSEkMAIQkL+H/wNZA1gnKvMAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>arrow.scale<span class="ot">=</span><span class="dv">10</span>; cell.alpha<span class="ot">=</span><span class="fl">0.4</span>; cell.cex<span class="ot">=</span><span class="dv">1</span>; fig.height<span class="ot">=</span><span class="dv">4</span>;</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>vis_umap_Beta_emb_Beta_linear_index_grid <span class="ot">&lt;-</span> <span class="fu">show.velocity.on.embedding.cor</span>(umap_results[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>             res[[<span class="dv">3</span>]][[<span class="st">&quot;current&quot;</span>]]<span class="sc">$</span>M[index_site_name_int_intersect,index],</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>             res[[<span class="dv">3</span>]][[<span class="st">&quot;projected&quot;</span>]]<span class="sc">$</span>M[index_site_name_int_intersect,index],</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>             res[[<span class="dv">3</span>]][[<span class="st">&quot;delta&quot;</span>]]<span class="sc">$</span>M[index_site_name_int_intersect,index],</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>             <span class="at">cell.colors=</span>cell.colors,<span class="at">n=</span><span class="dv">200</span>,<span class="at">scale=</span><span class="st">&#39;log&#39;</span>,</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>             <span class="at">cex=</span>cell.cex,<span class="at">arrow.scale=</span>arrow.scale,<span class="at">arrow.lwd=</span><span class="fl">0.5</span>,<span class="at">show.grid.flow =</span> <span class="cn">TRUE</span>,<span class="at">grid.n =</span> <span class="dv">20</span>,<span class="at">rm_uniform=</span><span class="st">&quot;mode1&quot;</span>)</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a><span class="co">#&gt; delta projections ... log knn ... transition probs ... done</span></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a><span class="co">#&gt; calculating arrows ... done</span></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a><span class="co">#&gt; grid estimates ... grid.sd= 1.79047  min.arrow.size= 0.0358094  max.grid.arrow.length= 0.02634861  done</span></span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>vis_umap_Beta_emb_Beta_linear_index_grid[[<span class="dv">1</span>]]</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="scvelo" class="section level2">
<h2>scVelo</h2>
<p>jupyter notebook is in figshare: <a href="https://doi.org/10.6084/m9.figshare.28955183" class="uri">https://doi.org/10.6084/m9.figshare.28955183</a> or <a href="https://github.com/whz991026/VeloRM" class="uri">https://github.com/whz991026/VeloRM</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
