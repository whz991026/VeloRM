<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>RNA-Seq_A-to-I_2</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">RNA-Seq_A-to-I_2</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(VeloRM)</span></code></pre></div>
<div id="rna-seq-a-to-i-velocity-pipeline" class="section level2">
<h2>RNA-seq A-to-I velocity pipeline</h2>
<div id="data-download" class="section level3">
<h3>data download</h3>
<p><a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE151334" class="uri">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE151334</a>
### alignment</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># Extract SRR numbers into an array (skip the header line)</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="va">srr_list</span><span class="op">=</span><span class="va">($(</span><span class="fu">find</span> /gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR <span class="at">-maxdepth</span> 1 <span class="at">-type</span> d <span class="at">-name</span> <span class="st">&quot;SRR*&quot;</span> ! <span class="at">-name</span> <span class="st">&quot;SRR&quot;</span> <span class="at">-exec</span> basename {} <span class="dt">\;</span><span class="va">))</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co"># Check the extraction results</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Found </span><span class="va">${</span><span class="op">#</span><span class="va">srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st"> SRR samples:&quot;</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="bu">printf</span> <span class="st">&quot;%s\n&quot;</span> <span class="st">&quot;</span><span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co"># alignment</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co"># Base directories</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="va">input_base</span><span class="op">=</span><span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR&quot;</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="va">output_base</span><span class="op">=</span><span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR&quot;</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co"># Run trim_galore for each SRR sample</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>    <span class="co"># Input FASTQ file (assuming it&#39;s in $input_base/$srr/$srr.fastq)</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>    <span class="co"># Run trim_galore (single-end mode)</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>    <span class="ex">trim_galore</span> <span class="dt">\</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>        <span class="at">--output_dir</span> <span class="st">&quot;</span><span class="va">$output_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>        <span class="at">--basename</span> <span class="st">&quot;</span><span class="va">$srr</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>        <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">$srr</span><span class="st">.fastq&quot;</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co">### STAR build index</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="co">### STAR align</span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="kw">;</span> <span class="cf">do</span> </span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a>    <span class="ex">STAR</span> <span class="at">--runThreadN</span> 1 <span class="at">--outSAMtype</span> BAM Unsorted <span class="dt">\</span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a>    <span class="at">--readFilesIn</span> <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_trimmed.fq&quot;</span> <span class="dt">\</span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a>    <span class="at">--genomeDir</span> /gpfs/work/bio/haozhewang17/data/VeloRM_data/mm39/star_indx <span class="dt">\</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a>    <span class="at">--sjdbGTFfile</span> /gpfs/work/bio/haozhewang17/data/VeloRM_data/mm39/mm39.knownGene.gtf <span class="dt">\</span></span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a>    <span class="at">--outFileNamePrefix</span> <span class="st">&quot;</span><span class="va">$output_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">$srr</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a>    <span class="at">--outSAMattributes</span> All <span class="at">--outSAMunmapped</span> Within <span class="dt">\</span></span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a>    <span class="at">--sjdbOverhang</span> 150 <span class="op">&gt;</span> <span class="st">&quot;</span><span class="va">$output_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">$srr</span><span class="st">.log&quot;</span></span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a><span class="co">###  sort above.mapQ30</span></span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a></span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a>    <span class="ex">samtools</span> sort <span class="at">-@</span> 1 <span class="at">-o</span> <span class="st">&quot;</span><span class="va">${output_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_sorted.bam&quot;</span> <span class="st">&quot;</span><span class="va">${output_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">Aligned.out.bam&quot;</span></span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a>    <span class="ex">samtools</span> view <span class="at">-h</span> <span class="at">-b</span> <span class="at">-q</span> 30 <span class="dt">\</span></span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a>    <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_sorted.bam&quot;</span> <span class="dt">\</span></span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a>        <span class="at">-o</span> <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_above.mapQ30.bam&quot;</span></span>
<span id="cb2-55"><a href="#cb2-55" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
</div>
<div id="divide-bam" class="section level3">
<h3>divide bam</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">############ bedtools to divide the bam file</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">###### File prepare</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">## get exon-no-ambiguity bed by substract (exon.bed - intron.bed = exon-na.bed)</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="ex">bedtools</span> subtract <span class="at">-a</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39_bed/UCSC_Exons_mm39.bed <span class="at">-b</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39_bed/UCSC_Introns_mm39.bed <span class="op">&gt;</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39_bed/exon-na.bed</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">## get intron-no-ambituity bed by subtract (inton.bed - exon.bed = inron-na.bed)</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="ex">bedtools</span> subtract <span class="at">-a</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39_bed/UCSC_Introns_mm39.bed <span class="at">-b</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39_bed/UCSC_Exons_mm39.bed <span class="op">&gt;</span> /gpfs/work/bio/haozhewang17/data/VeloRM_1/mm39_bed/intron-na.bed</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co"># Extract SRR numbers into an array (skip the header line)</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="va">srr_list</span><span class="op">=</span><span class="va">($(</span><span class="fu">find</span> /gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR <span class="dt">\</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>    <span class="at">-maxdepth</span> 1 <span class="at">-type</span> d <span class="at">-name</span> <span class="st">&quot;SRR*&quot;</span> ! <span class="at">-name</span> <span class="st">&quot;SRR&quot;</span> <span class="at">-exec</span> basename {} <span class="dt">\;</span><span class="va">))</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co"># Check the extraction results</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Found </span><span class="va">${</span><span class="op">#</span><span class="va">srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st"> SRR samples:&quot;</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="bu">printf</span> <span class="st">&quot;%s\n&quot;</span> <span class="st">&quot;</span><span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co"># Base directories</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="va">input_base</span><span class="op">=</span><span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR&quot;</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="va">output_base</span><span class="op">=</span><span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR&quot;</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="co">#### mRNA.bam</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="va">${srr_list</span><span class="op">[@]:</span><span class="dv">0</span><span class="op">:</span><span class="dv">100</span><span class="va">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>    <span class="ex">bedtools</span> intersect <span class="at">-a</span> <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_above.mapQ30.bam&quot;</span> <span class="dt">\</span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a>        <span class="at">-b</span> /gpfs/work/bio/haozhewang17/data/VeloRM_data/mm39_bed/UCSC_Introns.bed <span class="dt">\</span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a>        <span class="at">-v</span> <span class="at">-wa</span> <span class="at">-split</span> <span class="op">&gt;</span> <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_mRNA_temp.bam&quot;</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="va">${srr_list</span><span class="op">[@]:</span><span class="dv">0</span><span class="op">:</span><span class="dv">100</span><span class="va">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a>    <span class="ex">bedtools</span> intersect <span class="at">-a</span> <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_mRNA_temp.bam&quot;</span> <span class="dt">\</span></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a>        <span class="at">-b</span> /gpfs/work/bio/haozhewang17/data/VeloRM_data/mm39_bed/UCSC_Exons.bed <span class="dt">\</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a>        <span class="at">-wa</span> <span class="at">-split</span> <span class="op">&gt;</span> <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_mRNA.bam&quot;</span></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a>    <span class="ex">samtools</span> index <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_mRNA.bam&quot;</span></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a><span class="co">#### mRNA_spliced.bam</span></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a>    <span class="ex">samtools</span> view <span class="at">-h</span> <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_mRNA.bam&quot;</span> <span class="kw">|</span> <span class="dt">\</span></span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a>        <span class="fu">awk</span> <span class="st">&#39;$0 ~ /^@/ || $6 ~ /N/&#39;</span> <span class="kw">|</span> <span class="ex">samtools</span> view <span class="at">-b</span> <span class="op">&gt;</span> <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_mRNA_spliced.bam&quot;</span></span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a>    <span class="ex">samtools</span> index <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_mRNA_spliced.bam&quot;</span></span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a></span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a><span class="co">#### pre-mRNA.bam</span></span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a>    <span class="ex">bedtools</span> intersect <span class="at">-a</span> <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_above.mapQ30.bam&quot;</span> <span class="dt">\</span></span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a>        <span class="at">-b</span> /gpfs/work/bio/haozhewang17/data/VeloRM_data/mm39_bed/intron-na.bed <span class="dt">\</span></span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a>        <span class="at">-wa</span> <span class="at">-split</span> <span class="op">&gt;</span> <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_pre-mRNA.bam&quot;</span></span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a>    <span class="ex">samtools</span> index <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_pre-mRNA.bam&quot;</span></span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a></span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a><span class="co">#### isoform-a.bam</span></span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a>    <span class="ex">bedtools</span> intersect <span class="at">-a</span> <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_above.mapQ30.bam&quot;</span> <span class="dt">\</span></span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a>        <span class="at">-b</span> /gpfs/work/bio/haozhewang17/data/VeloRM_data/mm39_bed/UCSC_Introns.bed <span class="dt">\</span></span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a>        <span class="at">-wa</span> <span class="at">-split</span> <span class="op">&gt;</span> <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_maybe_pre_mRNA.bam&quot;</span></span>
<span id="cb3-62"><a href="#cb3-62" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb3-63"><a href="#cb3-63" tabindex="-1"></a></span>
<span id="cb3-64"><a href="#cb3-64" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb3-65"><a href="#cb3-65" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb3-66"><a href="#cb3-66" tabindex="-1"></a>    <span class="ex">bedtools</span> intersect <span class="at">-a</span> <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_maybe_pre_mRNA.bam&quot;</span> <span class="dt">\</span></span>
<span id="cb3-67"><a href="#cb3-67" tabindex="-1"></a>        <span class="at">-b</span> /gpfs/work/bio/haozhewang17/data/VeloRM_data/mm39_bed/intron-na.bed <span class="dt">\</span></span>
<span id="cb3-68"><a href="#cb3-68" tabindex="-1"></a>        <span class="at">-v</span> <span class="at">-wa</span> <span class="at">-split</span> <span class="op">&gt;</span> <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_isoform-a.bam&quot;</span></span>
<span id="cb3-69"><a href="#cb3-69" tabindex="-1"></a>    <span class="ex">samtools</span> index <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">/</span><span class="va">$srr</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_isoform-a.bam&quot;</span></span>
<span id="cb3-70"><a href="#cb3-70" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb3-71"><a href="#cb3-71" tabindex="-1"></a></span>
<span id="cb3-72"><a href="#cb3-72" tabindex="-1"></a></span>
<span id="cb3-73"><a href="#cb3-73" tabindex="-1"></a><span class="co">#### we can also do further to clean the splicing reads missing classify to ambiguous and pre-mRNA, and merge the splicing reads to mRNA.</span></span>
<span id="cb3-74"><a href="#cb3-74" tabindex="-1"></a>  </span>
<span id="cb3-75"><a href="#cb3-75" tabindex="-1"></a>  </span>
<span id="cb3-76"><a href="#cb3-76" tabindex="-1"></a><span class="co">#  for srr in &quot;${srr_list[@]}&quot;; do</span></span>
<span id="cb3-77"><a href="#cb3-77" tabindex="-1"></a><span class="co">#    echo &quot;Processing sample: $srr&quot;</span></span>
<span id="cb3-78"><a href="#cb3-78" tabindex="-1"></a><span class="co">#    samtools view -h &quot;${input_base}/${srr}/${srr}_pre-mRNA.bam&quot;\</span></span>
<span id="cb3-79"><a href="#cb3-79" tabindex="-1"></a><span class="co">#    | awk &#39;$0 ~ /^@/ || $6 ~ /N/&#39; | samtools view -b &gt;\</span></span>
<span id="cb3-80"><a href="#cb3-80" tabindex="-1"></a><span class="co">#    &quot;${input_base}/${srr}/${srr}_pre-mRNA_spliced.bam&quot;</span></span>
<span id="cb3-81"><a href="#cb3-81" tabindex="-1"></a><span class="co">#    samtools index &quot;${input_base}/${srr}/${srr}_pre-mRNA_spliced.bam&quot;</span></span>
<span id="cb3-82"><a href="#cb3-82" tabindex="-1"></a><span class="co">#  done</span></span>
<span id="cb3-83"><a href="#cb3-83" tabindex="-1"></a>  </span>
<span id="cb3-84"><a href="#cb3-84" tabindex="-1"></a><span class="co">#  for srr in &quot;${srr_list[@]}&quot;; do</span></span>
<span id="cb3-85"><a href="#cb3-85" tabindex="-1"></a><span class="co">#    echo &quot;Processing sample: $srr&quot;</span></span>
<span id="cb3-86"><a href="#cb3-86" tabindex="-1"></a><span class="co">#    samtools view -h &quot;${input_base}/${srr}/${srr}_isoform-a.bam&quot;\</span></span>
<span id="cb3-87"><a href="#cb3-87" tabindex="-1"></a><span class="co">#    | awk &#39;$0 ~ /^@/ || $6 ~ /N/&#39; | samtools view -b &gt;\</span></span>
<span id="cb3-88"><a href="#cb3-88" tabindex="-1"></a><span class="co">#    &quot;${input_base}/${srr}/${srr}_isoform-a_spliced.bam&quot;</span></span>
<span id="cb3-89"><a href="#cb3-89" tabindex="-1"></a><span class="co">#    samtools index &quot;${input_base}/${srr}/${srr}_isoform-a_spliced.bam&quot;</span></span>
<span id="cb3-90"><a href="#cb3-90" tabindex="-1"></a><span class="co">#  done</span></span>
<span id="cb3-91"><a href="#cb3-91" tabindex="-1"></a>  </span>
<span id="cb3-92"><a href="#cb3-92" tabindex="-1"></a>  </span>
<span id="cb3-93"><a href="#cb3-93" tabindex="-1"></a><span class="co">#  for srr in &quot;${srr_list[@]}&quot;; do</span></span>
<span id="cb3-94"><a href="#cb3-94" tabindex="-1"></a><span class="co">#    echo &quot;Processing sample: $srr&quot;</span></span>
<span id="cb3-95"><a href="#cb3-95" tabindex="-1"></a><span class="co">#    bedtools subtract -a &quot;${input_base}/${srr}/${srr}_pre-mRNA.bam&quot;\</span></span>
<span id="cb3-96"><a href="#cb3-96" tabindex="-1"></a><span class="co">#     -b &quot;${input_base}/${srr}/${srr}_pre-mRNA_spliced.bam&quot;\</span></span>
<span id="cb3-97"><a href="#cb3-97" tabindex="-1"></a><span class="co">#      &gt; &quot;${input_base}/${srr}/${srr}_pre-mRNA_clean.bam&quot;</span></span>
<span id="cb3-98"><a href="#cb3-98" tabindex="-1"></a><span class="co">#  done</span></span>
<span id="cb3-99"><a href="#cb3-99" tabindex="-1"></a>  </span>
<span id="cb3-100"><a href="#cb3-100" tabindex="-1"></a><span class="co">#  for srr in &quot;${srr_list[@]}&quot;; do</span></span>
<span id="cb3-101"><a href="#cb3-101" tabindex="-1"></a><span class="co">#    echo &quot;Processing sample: $srr&quot;</span></span>
<span id="cb3-102"><a href="#cb3-102" tabindex="-1"></a><span class="co">#    bedtools subtract -a &quot;${input_base}/${srr}/${srr}_isoform-a.bam&quot;\</span></span>
<span id="cb3-103"><a href="#cb3-103" tabindex="-1"></a><span class="co">#     -b &quot;${input_base}/${srr}/${srr}_isoform-a_spliced.bam&quot;\</span></span>
<span id="cb3-104"><a href="#cb3-104" tabindex="-1"></a><span class="co">#      &gt; &quot;${input_base}/${srr}/${srr}_isoform-a_clean.bam&quot;</span></span>
<span id="cb3-105"><a href="#cb3-105" tabindex="-1"></a><span class="co">#  done</span></span>
<span id="cb3-106"><a href="#cb3-106" tabindex="-1"></a>  </span>
<span id="cb3-107"><a href="#cb3-107" tabindex="-1"></a><span class="co">#  for srr in &quot;${srr_list[@]}&quot;; do</span></span>
<span id="cb3-108"><a href="#cb3-108" tabindex="-1"></a><span class="co">#    echo &quot;Processing sample: $srr&quot;</span></span>
<span id="cb3-109"><a href="#cb3-109" tabindex="-1"></a><span class="co">#    samtools merge &quot;${input_base}/${srr}/${srr}_mRNA_spliced_combine.bam&quot;\</span></span>
<span id="cb3-110"><a href="#cb3-110" tabindex="-1"></a><span class="co">#     &quot;${input_base}/${srr}/${srr}_pre-mRNA_spliced.bam&quot;\</span></span>
<span id="cb3-111"><a href="#cb3-111" tabindex="-1"></a><span class="co">#     &quot;${input_base}/${srr}/${srr}_isoform-a_spliced.bam&quot;\</span></span>
<span id="cb3-112"><a href="#cb3-112" tabindex="-1"></a><span class="co">#     &quot;${input_base}/${srr}/${srr}_mRNA_spliced.bam&quot;</span></span>
<span id="cb3-113"><a href="#cb3-113" tabindex="-1"></a><span class="co">#  done</span></span></code></pre></div>
</div>
<div id="variance-calling" class="section level3">
<h3>variance calling</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">#### call variance</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> {srr_range}<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>    <span class="ex">bcftools</span> mpileup <span class="at">-f</span> /gpfs/work/bio/haozhewang17/data/VeloRM_data/mm39/mm39.fa<span class="dt">\</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>    <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_sorted.bam&quot;</span> <span class="kw">|</span> <span class="dt">\</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>    <span class="ex">bcftools</span> call <span class="at">-mv</span> <span class="at">-Oz</span> <span class="at">-o</span> <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">_calls.vcf&quot;</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
</div>
<div id="find-relevant-mutation" class="section level3">
<h3>find relevant mutation</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Extract SRR sample folder names into a character vector (skip the header line)</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>srr_info <span class="ot">&lt;-</span> <span class="fu">list.dirs</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR/&quot;</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>, <span class="at">full.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>srr_info <span class="ot">&lt;-</span> srr_info[<span class="fu">grepl</span>(<span class="st">&quot;SRR&quot;</span>, srr_info)]  <span class="co"># Keep only directories containing &quot;SRR&quot;</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="fu">library</span>(GenomicRanges)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="fu">library</span>(vcfR)</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="fu">library</span>(Biostrings)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="fu">library</span>(TxDb.Mmusculus.UCSC.mm39.knownGene)  <span class="co"># Changed to mouse mm39</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="fu">library</span>(BSgenome.Mmusculus.UCSC.mm39)        <span class="co"># Changed to mouse mm39</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co"># Loop over each SRR sample</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="cf">for</span> (srr <span class="cf">in</span> srr_info) {</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>  <span class="co"># Load VCF file</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">read.vcfR</span>(<span class="fu">paste0</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR/&quot;</span>, srr, <span class="st">&quot;/&quot;</span>, srr, <span class="st">&quot;_calls.vcf&quot;</span>))</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>  data2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data<span class="sc">@</span>fix)</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>  <span class="co"># Keep entries with valid nucleotide bases</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>  data2 <span class="ot">&lt;-</span> data2[data2<span class="sc">$</span>REF <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;G&#39;</span>, <span class="st">&#39;T&#39;</span>) <span class="sc">&amp;</span> data2<span class="sc">$</span>ALT <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;G&#39;</span>, <span class="st">&#39;T&#39;</span>), ]</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(data2) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>    <span class="co"># If no valid SNPs, save empty object</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>    <span class="fu">saveRDS</span>(<span class="cn">NULL</span>, <span class="fu">paste0</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR/&quot;</span>, srr, <span class="st">&quot;/&quot;</span>, srr, <span class="st">&quot;SNP.rds&quot;</span>))</span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>    <span class="co"># Create GRanges object for SNPs</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>    gr <span class="ot">&lt;-</span> <span class="fu">GRanges</span>(<span class="at">seqnames =</span> <span class="fu">paste0</span>(data2<span class="sc">$</span>CHROM),</span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>                  <span class="at">ranges =</span> <span class="fu">IRanges</span>(<span class="at">start =</span> <span class="fu">as.numeric</span>(data2<span class="sc">$</span>POS), <span class="at">width =</span> <span class="dv">1</span>),</span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>                  <span class="at">strand =</span> <span class="st">&#39;+&#39;</span>,</span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>                  <span class="at">ref =</span> data2<span class="sc">$</span>REF,</span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>                  <span class="at">alt =</span> data2<span class="sc">$</span>ALT,</span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a>                  <span class="at">quality =</span> <span class="fu">as.numeric</span>(data2<span class="sc">$</span>QUAL),</span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a>                  <span class="at">info =</span> data2<span class="sc">$</span>INFO)</span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a>    <span class="co"># Keep only standard chromosomes</span></span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a>    gr <span class="ot">&lt;-</span> <span class="fu">keepStandardChromosomes</span>(gr, <span class="at">pruning.mode =</span> <span class="st">&quot;coarse&quot;</span>)</span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a>    <span class="co"># Validate reference bases with genome</span></span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a>    ref <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">DNAStringSet</span>(<span class="fu">Views</span>(Mmusculus, gr)))</span>
<span id="cb5-39"><a href="#cb5-39" tabindex="-1"></a>    gr <span class="ot">&lt;-</span> gr[gr<span class="sc">$</span>ref <span class="sc">==</span> ref]</span>
<span id="cb5-40"><a href="#cb5-40" tabindex="-1"></a></span>
<span id="cb5-41"><a href="#cb5-41" tabindex="-1"></a>    <span class="fu">saveRDS</span>(gr, <span class="fu">paste0</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR/&quot;</span>, srr, <span class="st">&quot;/&quot;</span>, srr, <span class="st">&quot;SNP.rds&quot;</span>))</span>
<span id="cb5-42"><a href="#cb5-42" tabindex="-1"></a></span>
<span id="cb5-43"><a href="#cb5-43" tabindex="-1"></a>    <span class="co"># Load transcript annotation</span></span>
<span id="cb5-44"><a href="#cb5-44" tabindex="-1"></a>    transcript <span class="ot">&lt;-</span> <span class="fu">transcripts</span>(TxDb.Mmusculus.UCSC.mm39.knownGene)</span>
<span id="cb5-45"><a href="#cb5-45" tabindex="-1"></a>    transcript_plus <span class="ot">&lt;-</span> transcript[<span class="fu">strand</span>(transcript) <span class="sc">==</span> <span class="st">&quot;+&quot;</span>]</span>
<span id="cb5-46"><a href="#cb5-46" tabindex="-1"></a>    transcript_minus <span class="ot">&lt;-</span> transcript[<span class="fu">strand</span>(transcript) <span class="sc">==</span> <span class="st">&quot;-&quot;</span>]</span>
<span id="cb5-47"><a href="#cb5-47" tabindex="-1"></a></span>
<span id="cb5-48"><a href="#cb5-48" tabindex="-1"></a>    <span class="co"># Filter A&gt;G mutations on the + strand</span></span>
<span id="cb5-49"><a href="#cb5-49" tabindex="-1"></a>    gr_plus <span class="ot">&lt;-</span> gr</span>
<span id="cb5-50"><a href="#cb5-50" tabindex="-1"></a>    olp <span class="ot">&lt;-</span> <span class="fu">findOverlaps</span>(gr_plus, transcript_plus)</span>
<span id="cb5-51"><a href="#cb5-51" tabindex="-1"></a>    gr_plus <span class="ot">&lt;-</span> gr_plus[<span class="fu">queryHits</span>(olp)]</span>
<span id="cb5-52"><a href="#cb5-52" tabindex="-1"></a>    gr_plus<span class="sc">$</span>transcript_overlapped <span class="ot">&lt;-</span> transcript_plus[<span class="fu">subjectHits</span>(olp)]<span class="sc">$</span>tx_name</span>
<span id="cb5-53"><a href="#cb5-53" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(gr_plus) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb5-54"><a href="#cb5-54" tabindex="-1"></a>      gr_plus<span class="sc">$</span>transcript_strand <span class="ot">&lt;-</span> <span class="st">&#39;+&#39;</span></span>
<span id="cb5-55"><a href="#cb5-55" tabindex="-1"></a>      gr_plus <span class="ot">&lt;-</span> <span class="fu">unique</span>(gr_plus)</span>
<span id="cb5-56"><a href="#cb5-56" tabindex="-1"></a>      gr_plus <span class="ot">&lt;-</span> gr_plus[gr_plus<span class="sc">$</span>ref <span class="sc">==</span> <span class="st">&quot;A&quot;</span> <span class="sc">&amp;</span> gr_plus<span class="sc">$</span>alt <span class="sc">==</span> <span class="st">&quot;G&quot;</span>]</span>
<span id="cb5-57"><a href="#cb5-57" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb5-58"><a href="#cb5-58" tabindex="-1"></a>      gr_plus <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb5-59"><a href="#cb5-59" tabindex="-1"></a>    }</span>
<span id="cb5-60"><a href="#cb5-60" tabindex="-1"></a></span>
<span id="cb5-61"><a href="#cb5-61" tabindex="-1"></a>    <span class="co"># Filter T&gt;C mutations on the - strand (reverse-complement)</span></span>
<span id="cb5-62"><a href="#cb5-62" tabindex="-1"></a>    gr_minus <span class="ot">&lt;-</span> gr</span>
<span id="cb5-63"><a href="#cb5-63" tabindex="-1"></a>    <span class="fu">strand</span>(gr_minus) <span class="ot">&lt;-</span> <span class="st">&#39;-&#39;</span></span>
<span id="cb5-64"><a href="#cb5-64" tabindex="-1"></a>    olp <span class="ot">&lt;-</span> <span class="fu">findOverlaps</span>(gr_minus, transcript_minus)</span>
<span id="cb5-65"><a href="#cb5-65" tabindex="-1"></a>    gr_minus <span class="ot">&lt;-</span> gr_minus[<span class="fu">queryHits</span>(olp)]</span>
<span id="cb5-66"><a href="#cb5-66" tabindex="-1"></a>    gr_minus<span class="sc">$</span>transcript_overlapped <span class="ot">&lt;-</span> transcript_minus[<span class="fu">subjectHits</span>(olp)]<span class="sc">$</span>tx_name</span>
<span id="cb5-67"><a href="#cb5-67" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(gr_minus) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb5-68"><a href="#cb5-68" tabindex="-1"></a>      gr_minus<span class="sc">$</span>transcript_strand <span class="ot">&lt;-</span> <span class="st">&#39;-&#39;</span></span>
<span id="cb5-69"><a href="#cb5-69" tabindex="-1"></a>      gr_minus <span class="ot">&lt;-</span> <span class="fu">unique</span>(gr_minus)</span>
<span id="cb5-70"><a href="#cb5-70" tabindex="-1"></a>      <span class="fu">strand</span>(gr_minus) <span class="ot">&lt;-</span> <span class="st">&#39;+&#39;</span></span>
<span id="cb5-71"><a href="#cb5-71" tabindex="-1"></a>      gr_minus <span class="ot">&lt;-</span> gr_minus[gr_minus<span class="sc">$</span>ref <span class="sc">==</span> <span class="st">&quot;T&quot;</span> <span class="sc">&amp;</span> gr_minus<span class="sc">$</span>alt <span class="sc">==</span> <span class="st">&quot;C&quot;</span>]</span>
<span id="cb5-72"><a href="#cb5-72" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb5-73"><a href="#cb5-73" tabindex="-1"></a>      gr_minus <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb5-74"><a href="#cb5-74" tabindex="-1"></a>    }</span>
<span id="cb5-75"><a href="#cb5-75" tabindex="-1"></a></span>
<span id="cb5-76"><a href="#cb5-76" tabindex="-1"></a>    <span class="co"># Combine both strand results and save</span></span>
<span id="cb5-77"><a href="#cb5-77" tabindex="-1"></a>    gr_filtered <span class="ot">&lt;-</span> <span class="fu">c</span>(gr_plus, gr_minus)</span>
<span id="cb5-78"><a href="#cb5-78" tabindex="-1"></a>    <span class="fu">saveRDS</span>(gr_filtered, <span class="fu">paste0</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR/&quot;</span>, srr, <span class="st">&quot;/&quot;</span>, srr, <span class="st">&quot;SNP_filtered.rds&quot;</span>))</span>
<span id="cb5-79"><a href="#cb5-79" tabindex="-1"></a>  }</span>
<span id="cb5-80"><a href="#cb5-80" tabindex="-1"></a></span>
<span id="cb5-81"><a href="#cb5-81" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Finished processing &quot;</span>, srr))</span>
<span id="cb5-82"><a href="#cb5-82" tabindex="-1"></a>}</span>
<span id="cb5-83"><a href="#cb5-83" tabindex="-1"></a></span>
<span id="cb5-84"><a href="#cb5-84" tabindex="-1"></a><span class="co"># Combine all filtered SNPs across samples</span></span>
<span id="cb5-85"><a href="#cb5-85" tabindex="-1"></a>gr_all <span class="ot">&lt;-</span> <span class="fu">GRanges</span>()</span>
<span id="cb5-86"><a href="#cb5-86" tabindex="-1"></a><span class="cf">for</span> (srr <span class="cf">in</span> srr_info) {</span>
<span id="cb5-87"><a href="#cb5-87" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR/&quot;</span>, srr, <span class="st">&quot;/&quot;</span>, srr, <span class="st">&quot;SNP_filtered.rds&quot;</span>)</span>
<span id="cb5-88"><a href="#cb5-88" tabindex="-1"></a>  </span>
<span id="cb5-89"><a href="#cb5-89" tabindex="-1"></a>  <span class="co"># Check if file exists before reading</span></span>
<span id="cb5-90"><a href="#cb5-90" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">file.exists</span>(file_path)) {</span>
<span id="cb5-91"><a href="#cb5-91" tabindex="-1"></a>    gr <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(file_path)</span>
<span id="cb5-92"><a href="#cb5-92" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(gr)) {</span>
<span id="cb5-93"><a href="#cb5-93" tabindex="-1"></a>      gr_all <span class="ot">&lt;-</span> <span class="fu">c</span>(gr_all, gr)</span>
<span id="cb5-94"><a href="#cb5-94" tabindex="-1"></a>    }</span>
<span id="cb5-95"><a href="#cb5-95" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb5-96"><a href="#cb5-96" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">&quot;File not found:&quot;</span>, file_path))</span>
<span id="cb5-97"><a href="#cb5-97" tabindex="-1"></a>  }</span>
<span id="cb5-98"><a href="#cb5-98" tabindex="-1"></a>}</span>
<span id="cb5-99"><a href="#cb5-99" tabindex="-1"></a></span>
<span id="cb5-100"><a href="#cb5-100" tabindex="-1"></a><span class="co"># Remove duplicates if any samples were successfully loaded</span></span>
<span id="cb5-101"><a href="#cb5-101" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(gr_all) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb5-102"><a href="#cb5-102" tabindex="-1"></a>  gr_all <span class="ot">&lt;-</span> <span class="fu">unique</span>(gr_all)</span>
<span id="cb5-103"><a href="#cb5-103" tabindex="-1"></a>  </span>
<span id="cb5-104"><a href="#cb5-104" tabindex="-1"></a>  <span class="co"># Save combined SNP results</span></span>
<span id="cb5-105"><a href="#cb5-105" tabindex="-1"></a>  <span class="fu">saveRDS</span>(gr_all, <span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR/SNP_all.rds&quot;</span>)</span>
<span id="cb5-106"><a href="#cb5-106" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;Combined SNP file saved successfully.&quot;</span>)</span>
<span id="cb5-107"><a href="#cb5-107" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb5-108"><a href="#cb5-108" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;No SNP files were found and processed.&quot;</span>)</span>
<span id="cb5-109"><a href="#cb5-109" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="base-counting" class="section level3">
<h3>base counting</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Extract SRR sample folder names into a character vector (skip the header line)</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>srr_info <span class="ot">&lt;-</span> <span class="fu">list.dirs</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR&quot;</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>, <span class="at">full.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>srr_info <span class="ot">&lt;-</span> srr_info[<span class="fu">grepl</span>(<span class="st">&quot;SRR&quot;</span>, srr_info)]  <span class="co"># Keep only directories containing &quot;SRR&quot;</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">library</span>(GenomicRanges)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="fu">library</span>(Biostrings)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="fu">library</span>(GenomicAlignments)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="fu">library</span>(Rsamtools)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>gr_all<span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&#39;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SNP_all.rds&#39;</span>)</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>gr_all <span class="ot">&lt;-</span>gr_all[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)]</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="do">## base counting</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>j <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="cf">for</span> (srr <span class="cf">in</span> srr_info) {</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>  </span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>  time_0 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>  j <span class="ot">&lt;-</span> j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>  name <span class="ot">&lt;-</span> srr</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR/&quot;</span>,srr,<span class="st">&quot;/&quot;</span>)</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>  </span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>  <span class="do">################################## mRNA_spliced.bam</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>  <span class="do">##################################</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>  bamfilePath <span class="ot">&lt;-</span> <span class="fu">paste0</span>(path,srr,<span class="st">&#39;_mRNA_spliced.bam&#39;</span>)</span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a>  flag <span class="ot">&lt;-</span> <span class="fu">scanBamFlag</span>(<span class="at">isNotPassingQualityControls=</span><span class="cn">FALSE</span>,</span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a>                      <span class="at">isDuplicate=</span><span class="cn">FALSE</span>)</span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a>  param <span class="ot">&lt;-</span> <span class="fu">ScanBamParam</span>(<span class="at">flag=</span>flag, <span class="at">what=</span><span class="fu">c</span>(<span class="st">&quot;seq&quot;</span>,<span class="st">&quot;qual&quot;</span>),<span class="at">which=</span>gr_all)</span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a>  alns <span class="ot">&lt;-</span> <span class="fu">readGAlignments</span>(bamfilePath, <span class="at">param=</span>param)</span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a>  alns <span class="ot">&lt;-</span> <span class="fu">keepStandardChromosomes</span>(alns,<span class="at">pruning.mode =</span> <span class="st">&quot;coarse&quot;</span>)</span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a>  qseq <span class="ot">&lt;-</span> <span class="fu">mcols</span>(alns)<span class="sc">$</span>seq</span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a>  qual <span class="ot">&lt;-</span> <span class="fu">mcols</span>(alns)<span class="sc">$</span>qual</span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a>  <span class="fu">seqlevels</span>(alns) <span class="ot">&lt;-</span> <span class="fu">seqlevels</span>(gr_all)</span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a>  </span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a>  nucl_piles <span class="ot">&lt;-</span> <span class="fu">pileLettersAt</span>(qseq, <span class="fu">seqnames</span>(alns), <span class="fu">start</span>(alns),</span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a>                              <span class="fu">cigar</span>(alns), gr_all)</span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a>  frequency <span class="ot">&lt;-</span> <span class="fu">alphabetFrequency</span>(nucl_piles, <span class="at">baseOnly=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a>  </span>
<span id="cb6-42"><a href="#cb6-42" tabindex="-1"></a>  <span class="fu">saveRDS</span>(nucl_piles,<span class="fu">paste0</span>(bamfilePath,<span class="st">&#39;_nucl_piles_all.rds&#39;</span>))</span>
<span id="cb6-43"><a href="#cb6-43" tabindex="-1"></a>  <span class="fu">saveRDS</span>(frequency,<span class="fu">paste0</span>(bamfilePath,<span class="st">&#39;_frequency_all.rds&#39;</span>))</span>
<span id="cb6-44"><a href="#cb6-44" tabindex="-1"></a>  <span class="fu">rm</span>(param,alns,qseq,qual,nucl_piles,frequency,flag)</span>
<span id="cb6-45"><a href="#cb6-45" tabindex="-1"></a>  </span>
<span id="cb6-46"><a href="#cb6-46" tabindex="-1"></a>  time_1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb6-47"><a href="#cb6-47" tabindex="-1"></a>  <span class="do">################################## pre-mRNA.bam</span></span>
<span id="cb6-48"><a href="#cb6-48" tabindex="-1"></a>  <span class="do">##################################</span></span>
<span id="cb6-49"><a href="#cb6-49" tabindex="-1"></a>  bamfilePath <span class="ot">&lt;-</span> <span class="fu">paste0</span>(path,srr,<span class="st">&#39;_pre-mRNA.bam&#39;</span>)</span>
<span id="cb6-50"><a href="#cb6-50" tabindex="-1"></a>  flag <span class="ot">&lt;-</span> <span class="fu">scanBamFlag</span>(<span class="at">isNotPassingQualityControls=</span><span class="cn">FALSE</span>,</span>
<span id="cb6-51"><a href="#cb6-51" tabindex="-1"></a>                      <span class="at">isDuplicate=</span><span class="cn">FALSE</span>)</span>
<span id="cb6-52"><a href="#cb6-52" tabindex="-1"></a>  param <span class="ot">&lt;-</span> <span class="fu">ScanBamParam</span>(<span class="at">flag=</span>flag, <span class="at">what=</span><span class="fu">c</span>(<span class="st">&quot;seq&quot;</span>,<span class="st">&quot;qual&quot;</span>),<span class="at">which=</span>gr_all)</span>
<span id="cb6-53"><a href="#cb6-53" tabindex="-1"></a>  alns <span class="ot">&lt;-</span> <span class="fu">readGAlignments</span>(bamfilePath, <span class="at">param=</span>param)</span>
<span id="cb6-54"><a href="#cb6-54" tabindex="-1"></a>  alns <span class="ot">&lt;-</span> <span class="fu">keepStandardChromosomes</span>(alns,<span class="at">pruning.mode =</span> <span class="st">&quot;coarse&quot;</span>)</span>
<span id="cb6-55"><a href="#cb6-55" tabindex="-1"></a>  qseq <span class="ot">&lt;-</span> <span class="fu">mcols</span>(alns)<span class="sc">$</span>seq</span>
<span id="cb6-56"><a href="#cb6-56" tabindex="-1"></a>  qual <span class="ot">&lt;-</span> <span class="fu">mcols</span>(alns)<span class="sc">$</span>qual</span>
<span id="cb6-57"><a href="#cb6-57" tabindex="-1"></a>  <span class="fu">seqlevels</span>(alns) <span class="ot">&lt;-</span> <span class="fu">seqlevels</span>(gr_all)</span>
<span id="cb6-58"><a href="#cb6-58" tabindex="-1"></a>  </span>
<span id="cb6-59"><a href="#cb6-59" tabindex="-1"></a>  nucl_piles <span class="ot">&lt;-</span> <span class="fu">pileLettersAt</span>(qseq, <span class="fu">seqnames</span>(alns), <span class="fu">start</span>(alns),</span>
<span id="cb6-60"><a href="#cb6-60" tabindex="-1"></a>                              <span class="fu">cigar</span>(alns), gr_all)</span>
<span id="cb6-61"><a href="#cb6-61" tabindex="-1"></a>  frequency <span class="ot">&lt;-</span> <span class="fu">alphabetFrequency</span>(nucl_piles, <span class="at">baseOnly=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-62"><a href="#cb6-62" tabindex="-1"></a>  </span>
<span id="cb6-63"><a href="#cb6-63" tabindex="-1"></a>  <span class="fu">saveRDS</span>(nucl_piles,<span class="fu">paste0</span>(bamfilePath,<span class="st">&#39;_nucl_piles_all.rds&#39;</span>))</span>
<span id="cb6-64"><a href="#cb6-64" tabindex="-1"></a>  <span class="fu">saveRDS</span>(frequency,<span class="fu">paste0</span>(bamfilePath,<span class="st">&#39;_frequency_all.rds&#39;</span>))</span>
<span id="cb6-65"><a href="#cb6-65" tabindex="-1"></a>  <span class="fu">rm</span>(param,alns,qseq,qual,nucl_piles,frequency,flag)</span>
<span id="cb6-66"><a href="#cb6-66" tabindex="-1"></a>  </span>
<span id="cb6-67"><a href="#cb6-67" tabindex="-1"></a>  time_2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb6-68"><a href="#cb6-68" tabindex="-1"></a>  <span class="do">################################## isoform.bam</span></span>
<span id="cb6-69"><a href="#cb6-69" tabindex="-1"></a>  <span class="do">##################################</span></span>
<span id="cb6-70"><a href="#cb6-70" tabindex="-1"></a>  bamfilePath <span class="ot">&lt;-</span> <span class="fu">paste0</span>(path,srr,<span class="st">&#39;_isoform-a.bam&#39;</span>)</span>
<span id="cb6-71"><a href="#cb6-71" tabindex="-1"></a>  flag <span class="ot">&lt;-</span> <span class="fu">scanBamFlag</span>(<span class="at">isNotPassingQualityControls=</span><span class="cn">FALSE</span>,</span>
<span id="cb6-72"><a href="#cb6-72" tabindex="-1"></a>                      <span class="at">isDuplicate=</span><span class="cn">FALSE</span>)</span>
<span id="cb6-73"><a href="#cb6-73" tabindex="-1"></a>  param <span class="ot">&lt;-</span> <span class="fu">ScanBamParam</span>(<span class="at">flag=</span>flag, <span class="at">what=</span><span class="fu">c</span>(<span class="st">&quot;seq&quot;</span>,<span class="st">&quot;qual&quot;</span>),<span class="at">which=</span>gr_all)</span>
<span id="cb6-74"><a href="#cb6-74" tabindex="-1"></a>  alns <span class="ot">&lt;-</span> <span class="fu">readGAlignments</span>(bamfilePath, <span class="at">param=</span>param)</span>
<span id="cb6-75"><a href="#cb6-75" tabindex="-1"></a>  alns <span class="ot">&lt;-</span> <span class="fu">keepStandardChromosomes</span>(alns,<span class="at">pruning.mode =</span> <span class="st">&quot;coarse&quot;</span>)</span>
<span id="cb6-76"><a href="#cb6-76" tabindex="-1"></a>  qseq <span class="ot">&lt;-</span> <span class="fu">mcols</span>(alns)<span class="sc">$</span>seq</span>
<span id="cb6-77"><a href="#cb6-77" tabindex="-1"></a>  qual <span class="ot">&lt;-</span> <span class="fu">mcols</span>(alns)<span class="sc">$</span>qual</span>
<span id="cb6-78"><a href="#cb6-78" tabindex="-1"></a>  <span class="fu">seqlevels</span>(alns) <span class="ot">&lt;-</span> <span class="fu">seqlevels</span>(gr_all)</span>
<span id="cb6-79"><a href="#cb6-79" tabindex="-1"></a>  </span>
<span id="cb6-80"><a href="#cb6-80" tabindex="-1"></a>  nucl_piles <span class="ot">&lt;-</span> <span class="fu">pileLettersAt</span>(qseq, <span class="fu">seqnames</span>(alns), <span class="fu">start</span>(alns),</span>
<span id="cb6-81"><a href="#cb6-81" tabindex="-1"></a>                              <span class="fu">cigar</span>(alns), gr_all)</span>
<span id="cb6-82"><a href="#cb6-82" tabindex="-1"></a>  frequency <span class="ot">&lt;-</span> <span class="fu">alphabetFrequency</span>(nucl_piles, <span class="at">baseOnly=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-83"><a href="#cb6-83" tabindex="-1"></a>  </span>
<span id="cb6-84"><a href="#cb6-84" tabindex="-1"></a>  <span class="fu">saveRDS</span>(nucl_piles,<span class="fu">paste0</span>(bamfilePath,<span class="st">&#39;_nucl_piles_all.rds&#39;</span>))</span>
<span id="cb6-85"><a href="#cb6-85" tabindex="-1"></a>  <span class="fu">saveRDS</span>(frequency,<span class="fu">paste0</span>(bamfilePath,<span class="st">&#39;_frequency_all.rds&#39;</span>))</span>
<span id="cb6-86"><a href="#cb6-86" tabindex="-1"></a>  <span class="fu">rm</span>(param,alns,qseq,qual,nucl_piles,frequency,flag)</span>
<span id="cb6-87"><a href="#cb6-87" tabindex="-1"></a>    time_3 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb6-88"><a href="#cb6-88" tabindex="-1"></a>  </span>
<span id="cb6-89"><a href="#cb6-89" tabindex="-1"></a>  <span class="fu">print</span>(j)</span>
<span id="cb6-90"><a href="#cb6-90" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;spliced mRNA runing time&quot;</span>, time_1<span class="sc">-</span>time_0))</span>
<span id="cb6-91"><a href="#cb6-91" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;pre-mRNA runing time&quot;</span>, time_2<span class="sc">-</span>time_1))</span>
<span id="cb6-92"><a href="#cb6-92" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;isoform-mRNA runing time&quot;</span>, time_3<span class="sc">-</span>time_2))</span>
<span id="cb6-93"><a href="#cb6-93" tabindex="-1"></a>}</span>
<span id="cb6-94"><a href="#cb6-94" tabindex="-1"></a></span>
<span id="cb6-95"><a href="#cb6-95" tabindex="-1"></a><span class="co"># combine:</span></span>
<span id="cb6-96"><a href="#cb6-96" tabindex="-1"></a></span>
<span id="cb6-97"><a href="#cb6-97" tabindex="-1"></a><span class="co"># Extract SRR sample folder names into a character vector (skip the header line)</span></span>
<span id="cb6-98"><a href="#cb6-98" tabindex="-1"></a>srr_info <span class="ot">&lt;-</span> <span class="fu">list.dirs</span>(<span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR&quot;</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>, <span class="at">full.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-99"><a href="#cb6-99" tabindex="-1"></a>srr_info <span class="ot">&lt;-</span> srr_info[<span class="fu">grepl</span>(<span class="st">&quot;SRR&quot;</span>, srr_info)]  <span class="co"># Keep only directories containing &quot;SRR&quot;</span></span>
<span id="cb6-100"><a href="#cb6-100" tabindex="-1"></a></span>
<span id="cb6-101"><a href="#cb6-101" tabindex="-1"></a></span>
<span id="cb6-102"><a href="#cb6-102" tabindex="-1"></a></span>
<span id="cb6-103"><a href="#cb6-103" tabindex="-1"></a><span class="co"># Initialize the spliced_list</span></span>
<span id="cb6-104"><a href="#cb6-104" tabindex="-1"></a>spliced_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb6-105"><a href="#cb6-105" tabindex="-1"></a>j <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb6-106"><a href="#cb6-106" tabindex="-1"></a><span class="cf">for</span> (srr <span class="cf">in</span> srr_info) {</span>
<span id="cb6-107"><a href="#cb6-107" tabindex="-1"></a>  name <span class="ot">&lt;-</span> srr</span>
<span id="cb6-108"><a href="#cb6-108" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR/&#39;</span>, srr,<span class="st">&quot;/&quot;</span>)</span>
<span id="cb6-109"><a href="#cb6-109" tabindex="-1"></a>  spliced_list[[j]] <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(path, srr, <span class="st">&quot;_mRNA_spliced.bam_frequency_all.rds&quot;</span>))</span>
<span id="cb6-110"><a href="#cb6-110" tabindex="-1"></a>  j <span class="ot">=</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-111"><a href="#cb6-111" tabindex="-1"></a>}</span>
<span id="cb6-112"><a href="#cb6-112" tabindex="-1"></a></span>
<span id="cb6-113"><a href="#cb6-113" tabindex="-1"></a><span class="co"># Name the elements of spliced_list</span></span>
<span id="cb6-114"><a href="#cb6-114" tabindex="-1"></a><span class="fu">names</span>(spliced_list) <span class="ot">&lt;-</span> srr_info</span>
<span id="cb6-115"><a href="#cb6-115" tabindex="-1"></a><span class="fu">saveRDS</span>(spliced_list, <span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR/spliced_A_to_I.rds&quot;</span>)</span>
<span id="cb6-116"><a href="#cb6-116" tabindex="-1"></a></span>
<span id="cb6-117"><a href="#cb6-117" tabindex="-1"></a><span class="co"># Initialize the pre_list</span></span>
<span id="cb6-118"><a href="#cb6-118" tabindex="-1"></a>pre_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb6-119"><a href="#cb6-119" tabindex="-1"></a>j <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb6-120"><a href="#cb6-120" tabindex="-1"></a><span class="cf">for</span> (srr <span class="cf">in</span> srr_info) {</span>
<span id="cb6-121"><a href="#cb6-121" tabindex="-1"></a>  name <span class="ot">&lt;-</span> srr</span>
<span id="cb6-122"><a href="#cb6-122" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR/&#39;</span>, srr,<span class="st">&quot;/&quot;</span>)</span>
<span id="cb6-123"><a href="#cb6-123" tabindex="-1"></a>  pre_list[[j]] <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(path, srr, <span class="st">&quot;_pre-mRNA.bam_frequency_all.rds&quot;</span>))</span>
<span id="cb6-124"><a href="#cb6-124" tabindex="-1"></a>  j <span class="ot">=</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-125"><a href="#cb6-125" tabindex="-1"></a>}</span>
<span id="cb6-126"><a href="#cb6-126" tabindex="-1"></a></span>
<span id="cb6-127"><a href="#cb6-127" tabindex="-1"></a><span class="co"># Name the elements of isoform_list</span></span>
<span id="cb6-128"><a href="#cb6-128" tabindex="-1"></a><span class="fu">names</span>(pre_list) <span class="ot">&lt;-</span> srr_info</span>
<span id="cb6-129"><a href="#cb6-129" tabindex="-1"></a><span class="fu">saveRDS</span>(pre_list, <span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR/pre_A_to_I.rds&quot;</span>)</span>
<span id="cb6-130"><a href="#cb6-130" tabindex="-1"></a></span>
<span id="cb6-131"><a href="#cb6-131" tabindex="-1"></a></span>
<span id="cb6-132"><a href="#cb6-132" tabindex="-1"></a><span class="co"># Initialize the isoform_list</span></span>
<span id="cb6-133"><a href="#cb6-133" tabindex="-1"></a>isoform_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb6-134"><a href="#cb6-134" tabindex="-1"></a>j <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb6-135"><a href="#cb6-135" tabindex="-1"></a><span class="cf">for</span> (srr <span class="cf">in</span> srr_info) {</span>
<span id="cb6-136"><a href="#cb6-136" tabindex="-1"></a>  name <span class="ot">&lt;-</span> srr</span>
<span id="cb6-137"><a href="#cb6-137" tabindex="-1"></a>  path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR/&#39;</span>, srr,<span class="st">&quot;/&quot;</span>)</span>
<span id="cb6-138"><a href="#cb6-138" tabindex="-1"></a>  isoform_list[[j]] <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(path, srr, <span class="st">&quot;_isoform-a.bam_frequency_all.rds&quot;</span>))</span>
<span id="cb6-139"><a href="#cb6-139" tabindex="-1"></a>  j <span class="ot">=</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-140"><a href="#cb6-140" tabindex="-1"></a>}</span>
<span id="cb6-141"><a href="#cb6-141" tabindex="-1"></a></span>
<span id="cb6-142"><a href="#cb6-142" tabindex="-1"></a><span class="co"># Name the elements of pre_list</span></span>
<span id="cb6-143"><a href="#cb6-143" tabindex="-1"></a><span class="fu">names</span>(isoform_list) <span class="ot">&lt;-</span> srr_info</span>
<span id="cb6-144"><a href="#cb6-144" tabindex="-1"></a><span class="fu">saveRDS</span>(isoform_list, <span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR/isoform_A_to_I.rds&quot;</span>)</span></code></pre></div>
</div>
<div id="summary-the-count" class="section level3">
<h3>summary the count</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="ex">module</span> load samtools/1.16.1-gcc-8.5.0-teyetiz </span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="va">root_dir</span><span class="op">=</span><span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR&quot;</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="va">output_file</span><span class="op">=</span><span class="st">&quot;bam_read_counts.csv&quot;</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Folder,isoform-a.bam,mRNA_spliced.bam,pre-mRNA.bam&quot;</span> <span class="op">&gt;</span> <span class="st">&quot;</span><span class="va">$output_file</span><span class="st">&quot;</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="cf">for</span> folder <span class="kw">in</span> <span class="st">&quot;</span><span class="va">$root_dir</span><span class="st">&quot;</span>/SRR<span class="pp">*</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">[</span> <span class="ot">-d</span> <span class="st">&quot;</span><span class="va">$folder</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>        <span class="va">folder_name</span><span class="op">=</span><span class="va">$(</span><span class="fu">basename</span> <span class="st">&quot;</span><span class="va">$folder</span><span class="st">&quot;</span><span class="va">)</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;Processing folder: </span><span class="va">$folder_name</span><span class="st">&quot;</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>        </span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a>        </span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a>        <span class="va">isoform_a_count</span><span class="op">=</span><span class="st">&quot;Not found&quot;</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>        <span class="va">mrna_spliced_count</span><span class="op">=</span><span class="st">&quot;Not found&quot;</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a>        <span class="va">pre_mrna_count</span><span class="op">=</span><span class="st">&quot;Not found&quot;</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a>        </span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a>        <span class="co">#isoform-a.bam</span></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a>        <span class="va">isoform_a_file</span><span class="op">=</span><span class="va">$(</span><span class="fu">find</span> <span class="st">&quot;</span><span class="va">$folder</span><span class="st">&quot;</span> <span class="at">-name</span> <span class="st">&quot;*_isoform-a.bam&quot;</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 1<span class="va">)</span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">[</span> <span class="ot">-n</span> <span class="st">&quot;</span><span class="va">$isoform_a_file</span><span class="st">&quot;</span> <span class="bu">]</span> <span class="kw">&amp;&amp;</span> <span class="bu">[</span> <span class="ot">-f</span> <span class="st">&quot;</span><span class="va">$isoform_a_file</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a>            <span class="va">isoform_a_count</span><span class="op">=</span><span class="va">$(</span><span class="ex">samtools</span> view <span class="at">-c</span> <span class="st">&quot;</span><span class="va">$isoform_a_file</span><span class="st">&quot;</span><span class="va">)</span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a>        <span class="cf">fi</span></span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a>        </span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a>        <span class="co">#mRNA_spliced.bam</span></span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a>        <span class="va">mrna_spliced_file</span><span class="op">=</span><span class="va">$(</span><span class="fu">find</span> <span class="st">&quot;</span><span class="va">$folder</span><span class="st">&quot;</span> <span class="at">-name</span> <span class="st">&quot;*_mRNA_spliced.bam&quot;</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 1<span class="va">)</span></span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">[</span> <span class="ot">-n</span> <span class="st">&quot;</span><span class="va">$mrna_spliced_file</span><span class="st">&quot;</span> <span class="bu">]</span> <span class="kw">&amp;&amp;</span> <span class="bu">[</span> <span class="ot">-f</span> <span class="st">&quot;</span><span class="va">$mrna_spliced_file</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a>            <span class="va">mrna_spliced_count</span><span class="op">=</span><span class="va">$(</span><span class="ex">samtools</span> view <span class="at">-c</span> <span class="st">&quot;</span><span class="va">$mrna_spliced_file</span><span class="st">&quot;</span><span class="va">)</span></span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a>        <span class="cf">fi</span></span>
<span id="cb7-38"><a href="#cb7-38" tabindex="-1"></a>        </span>
<span id="cb7-39"><a href="#cb7-39" tabindex="-1"></a>        <span class="co">#pre-mRNA.bam</span></span>
<span id="cb7-40"><a href="#cb7-40" tabindex="-1"></a>        <span class="va">pre_mrna_file</span><span class="op">=</span><span class="va">$(</span><span class="fu">find</span> <span class="st">&quot;</span><span class="va">$folder</span><span class="st">&quot;</span> <span class="at">-name</span> <span class="st">&quot;*_pre-mRNA.bam&quot;</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 1<span class="va">)</span></span>
<span id="cb7-41"><a href="#cb7-41" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">[</span> <span class="ot">-n</span> <span class="st">&quot;</span><span class="va">$pre_mrna_file</span><span class="st">&quot;</span> <span class="bu">]</span> <span class="kw">&amp;&amp;</span> <span class="bu">[</span> <span class="ot">-f</span> <span class="st">&quot;</span><span class="va">$pre_mrna_file</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb7-42"><a href="#cb7-42" tabindex="-1"></a>            <span class="va">pre_mrna_count</span><span class="op">=</span><span class="va">$(</span><span class="ex">samtools</span> view <span class="at">-c</span> <span class="st">&quot;</span><span class="va">$pre_mrna_file</span><span class="st">&quot;</span><span class="va">)</span></span>
<span id="cb7-43"><a href="#cb7-43" tabindex="-1"></a>        <span class="cf">fi</span></span>
<span id="cb7-44"><a href="#cb7-44" tabindex="-1"></a>        </span>
<span id="cb7-45"><a href="#cb7-45" tabindex="-1"></a>        <span class="co">#</span></span>
<span id="cb7-46"><a href="#cb7-46" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$folder_name</span><span class="st">,</span><span class="va">$isoform_a_count</span><span class="st">,</span><span class="va">$mrna_spliced_count</span><span class="st">,</span><span class="va">$pre_mrna_count</span><span class="st">&quot;</span> <span class="op">&gt;&gt;</span> <span class="st">&quot;</span><span class="va">$output_file</span><span class="st">&quot;</span></span>
<span id="cb7-47"><a href="#cb7-47" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb7-48"><a href="#cb7-48" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb7-49"><a href="#cb7-49" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Processing complete. Results saved to </span><span class="va">$output_file</span><span class="st">&quot;</span></span></code></pre></div>
</div>
<div id="feature-counts" class="section level3">
<h3>feature counts</h3>
<p>extract expression for scVelo</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">module</span> load subread/2.0.2-gcc-8.5.0-gcsb2x2</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="va">input_base</span><span class="op">=</span><span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR&quot;</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="va">gtf_file</span><span class="op">=</span><span class="st">&quot;/gpfs/work/bio/haozhewang17/data/VeloRM_data/mm39/mm39.knownGene.gtf&quot;</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="va">srr_list</span><span class="op">=</span><span class="va">($(</span><span class="fu">find</span> <span class="st">&quot;</span><span class="va">$input_base</span><span class="st">&quot;</span> <span class="at">-maxdepth</span> 1 <span class="at">-type</span> d <span class="at">-name</span> <span class="st">&quot;SRR*&quot;</span> ! <span class="at">-name</span> <span class="st">&quot;SRR&quot;</span> <span class="at">-exec</span> basename {} <span class="dt">\;</span><span class="va">))</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="cf">for</span> srr <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${srr_list</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Processing sample: </span><span class="va">$srr</span><span class="st">&quot;</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>    <span class="va">output_dir</span><span class="op">=</span><span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/counts&quot;</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>    <span class="fu">mkdir</span> <span class="at">-p</span> <span class="st">&quot;</span><span class="va">$output_dir</span><span class="st">&quot;</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>    <span class="va">bam_files</span><span class="op">=</span><span class="va">(</span><span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/&quot;</span><span class="pp">*</span>_mRNA_spliced.bam <span class="dt">\</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>               <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/&quot;</span><span class="pp">*</span>_pre-mRNA.bam <span class="dt">\</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>               <span class="st">&quot;</span><span class="va">${input_base}</span><span class="st">/</span><span class="va">${srr}</span><span class="st">/&quot;</span><span class="pp">*</span>_isoform-a.bam<span class="va">)</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>    <span class="cf">for</span> bamfile <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${bam_files</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>        <span class="bu">[</span> <span class="ot">-f</span> <span class="st">&quot;</span><span class="va">$bamfile</span><span class="st">&quot;</span> <span class="bu">]</span> <span class="kw">||</span> <span class="cf">continue</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>        <span class="va">bam_name</span><span class="op">=</span><span class="va">$(</span><span class="fu">basename</span> <span class="st">&quot;</span><span class="va">$bamfile</span><span class="st">&quot;</span> .bam<span class="va">)</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;  Counting reads in </span><span class="va">$bam_name</span><span class="st">&quot;</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>        <span class="ex">featureCounts</span> <span class="at">-T</span> 4 <span class="at">-a</span> <span class="st">&quot;</span><span class="va">$gtf_file</span><span class="st">&quot;</span> <span class="at">-o</span> <span class="st">&quot;</span><span class="va">${output_dir}</span><span class="st">/</span><span class="va">${bam_name}</span><span class="st">_counts.txt&quot;</span> <span class="st">&quot;</span><span class="va">$bamfile</span><span class="st">&quot;</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>    <span class="cf">done</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;All read counts generated.&quot;</span></span></code></pre></div>
</div>
<div id="combine-the-gene-counts" class="section level3">
<h3>combine the gene counts</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="im">from</span> glob <span class="im">import</span> glob</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>base_dir <span class="op">=</span> <span class="st">&quot;/gpfs/work/bio/haozhewang17/data/RNA-Seq_A-to-I_SRR_GSE151334/Mus/SRR&quot;</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>types <span class="op">=</span> [<span class="st">&quot;mRNA_spliced&quot;</span>, <span class="st">&quot;pre-mRNA&quot;</span>, <span class="st">&quot;isoform-a&quot;</span>]</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> types:</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>    count_files <span class="op">=</span> glob(os.path.join(base_dir, <span class="st">&quot;SRR*&quot;</span>, <span class="st">&quot;counts&quot;</span>, <span class="ss">f&quot;*_</span><span class="sc">{</span>t<span class="sc">}</span><span class="ss">_counts.txt&quot;</span>))</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;[</span><span class="sc">{</span>t<span class="sc">}</span><span class="ss">] Found </span><span class="sc">{</span><span class="bu">len</span>(count_files)<span class="sc">}</span><span class="ss"> count files.&quot;</span>)</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>    dfs_counts <span class="op">=</span> []</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>    dfs_tpm <span class="op">=</span> []</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>    <span class="cf">for</span> f <span class="kw">in</span> count_files:</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>        df <span class="op">=</span> pd.read_csv(f, sep<span class="op">=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, comment<span class="op">=</span><span class="st">&quot;#&quot;</span>, header<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>        <span class="co"># Get key columns</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a>        gene_col <span class="op">=</span> <span class="st">&#39;Geneid&#39;</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a>        length_col <span class="op">=</span> <span class="st">&#39;Length&#39;</span>  <span class="co"># featureCounts output must include Length</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a>        count_col <span class="op">=</span> df.columns[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a>        df <span class="op">=</span> df[[gene_col, length_col, count_col]].copy()</span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a>        df.rename(columns<span class="op">=</span>{count_col: <span class="st">&#39;counts&#39;</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a>        <span class="co"># Calculate TPM</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a>        df[<span class="st">&quot;length_kb&quot;</span>] <span class="op">=</span> df[length_col] <span class="op">/</span> <span class="dv">1000</span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a>        df[<span class="st">&quot;RPK&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;counts&quot;</span>] <span class="op">/</span> df[<span class="st">&quot;length_kb&quot;</span>]</span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a>        scaling_factor <span class="op">=</span> df[<span class="st">&quot;RPK&quot;</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="fl">1e6</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a>        df[<span class="st">&quot;TPM&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;RPK&quot;</span>] <span class="op">/</span> scaling_factor</span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a>        <span class="co"># Sample name</span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a>        sample_name <span class="op">=</span> os.path.basename(f).replace(<span class="st">&quot;_counts.txt&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a>        <span class="co"># Add to lists</span></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a>        dfs_counts.append(df[[gene_col, <span class="st">&quot;counts&quot;</span>]].set_index(gene_col).rename(columns<span class="op">=</span>{<span class="st">&quot;counts&quot;</span>: sample_name}))</span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a>        dfs_tpm.append(df[[gene_col, <span class="st">&quot;TPM&quot;</span>]].set_index(gene_col).rename(columns<span class="op">=</span>{<span class="st">&quot;TPM&quot;</span>: sample_name}))</span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a></span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a>    <span class="cf">if</span> dfs_counts:</span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a>        <span class="co"># Merge all samples</span></span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a>        counts_matrix <span class="op">=</span> pd.concat(dfs_counts, axis<span class="op">=</span><span class="dv">1</span>).fillna(<span class="dv">0</span>)</span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a>        tpm_matrix <span class="op">=</span> pd.concat(dfs_tpm, axis<span class="op">=</span><span class="dv">1</span>).fillna(<span class="dv">0</span>)</span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a></span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a>        <span class="co"># Output files</span></span>
<span id="cb9-45"><a href="#cb9-45" tabindex="-1"></a>        counts_out <span class="op">=</span> os.path.join(base_dir, <span class="ss">f&quot;all_samples_counts_matrix_</span><span class="sc">{</span>t<span class="sc">}</span><span class="ss">.txt&quot;</span>)</span>
<span id="cb9-46"><a href="#cb9-46" tabindex="-1"></a>        tpm_out <span class="op">=</span> os.path.join(base_dir, <span class="ss">f&quot;all_samples_TPM_matrix_</span><span class="sc">{</span>t<span class="sc">}</span><span class="ss">.txt&quot;</span>)</span>
<span id="cb9-47"><a href="#cb9-47" tabindex="-1"></a></span>
<span id="cb9-48"><a href="#cb9-48" tabindex="-1"></a>        counts_matrix.to_csv(counts_out, sep<span class="op">=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</span>
<span id="cb9-49"><a href="#cb9-49" tabindex="-1"></a>        tpm_matrix.to_csv(tpm_out, sep<span class="op">=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</span>
<span id="cb9-50"><a href="#cb9-50" tabindex="-1"></a></span>
<span id="cb9-51"><a href="#cb9-51" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;[</span><span class="sc">{</span>t<span class="sc">}</span><span class="ss">] Saved merged counts matrix: </span><span class="sc">{</span>counts_out<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb9-52"><a href="#cb9-52" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;[</span><span class="sc">{</span>t<span class="sc">}</span><span class="ss">] Saved merged TPM matrix: </span><span class="sc">{</span>tpm_out<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
</div>
<div id="extract-both-have-reads" class="section level3">
<h3>extract both have reads</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co"># Read a tab-separated file (common for .txt exports)</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>isoform_TPM <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;C:/Users/Haozhe Wang/OneDrive/desktop/all_samples_TPM_matrix_isoform-a.txt&quot;</span>, </span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                      <span class="at">header =</span> <span class="cn">TRUE</span>,        <span class="co"># First row contains column names</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>                      <span class="at">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>                      <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)           <span class="co"># Separator is a tab</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co"># Read a tab-separated file (common for .txt exports)</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>spliced_TPM <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;C:/Users/Haozhe Wang/OneDrive/desktop/all_samples_TPM_matrix_mRNA_spliced.txt&quot;</span>, </span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>                          <span class="at">header =</span> <span class="cn">TRUE</span>,        <span class="co"># First row contains column names</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>                          <span class="at">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>                          <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)           <span class="co"># Separator is a tab</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co"># Read a tab-separated file (common for .txt exports)</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>pre_TPM <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;C:/Users/Haozhe Wang/OneDrive/desktop/all_samples_TPM_matrix_pre-mRNA.txt&quot;</span>, </span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>                          <span class="at">header =</span> <span class="cn">TRUE</span>,        <span class="co"># First row contains column names</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>                          <span class="at">row.names =</span> <span class="dv">1</span>,</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>                          <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)           <span class="co"># Separator is a tab</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="fu">colnames</span>(isoform_TPM) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;_isoform</span><span class="sc">\\</span><span class="st">.a&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">colnames</span>(isoform_TPM))</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="fu">colnames</span>(spliced_TPM) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;_mRNA_spliced&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">colnames</span>(spliced_TPM))</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="fu">colnames</span>(pre_TPM) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;_pre</span><span class="sc">\\</span><span class="st">.mRNA&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">colnames</span>(pre_TPM))</span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>index_isoform <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">rowSums</span>(isoform_TPM)<span class="sc">!=</span><span class="dv">0</span>)</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>index_spliced <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">rowSums</span>(spliced_TPM)<span class="sc">!=</span><span class="dv">0</span>)</span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>index_pre <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">rowSums</span>(pre_TPM)<span class="sc">!=</span><span class="dv">0</span>)</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>index_pre_spliced <span class="ot">&lt;-</span> <span class="fu">intersect</span>(index_pre,index_spliced)</span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a>isoform_TPM_index_pre_spliced <span class="ot">&lt;-</span> isoform_TPM[index_pre_spliced ,]</span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a>pre_TPM_index_pre_spliced <span class="ot">&lt;-</span> pre_TPM[index_pre_spliced ,]</span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a>spliced_TPM_index_pre_spliced <span class="ot">&lt;-</span> spliced_TPM[index_pre_spliced ,]</span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;C:/Users/Haozhe Wang/OneDrive/desktop&quot;</span>)</span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a><span class="fu">write.csv</span>(isoform_TPM_index_pre_spliced, <span class="st">&quot;isoform_TPM_index_pre_spliced.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a></span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a><span class="fu">write.csv</span>(pre_TPM_index_pre_spliced, <span class="st">&quot;pre_TPM_index_pre_spliced.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a></span>
<span id="cb10-40"><a href="#cb10-40" tabindex="-1"></a><span class="fu">write.csv</span>(spliced_TPM_index_pre_spliced, <span class="st">&quot;spliced_TPM_index_pre_spliced.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">TRUE</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>We will get the following data in
VeloRM_data/RNA-Seq_A-to-I_2/origin</p>
<p>Download Data</p>
<p>The following raw data files are required:</p>
<p>cell_name_info.csv and cell_to_SRR.csv</p>
<p>embedding.csv</p>
<p>SraRunTable.csv</p>
<p>Processed Data</p>
<p>The following datasets are generated after preprocessing:</p>
<p>SNP_all.rds</p>
<p>bam_read_counts.csv</p>
<p>Frequency Data</p>
<p>Frequency matrices used for downstream analysis:</p>
<p>isoform_A_to_I.rds</p>
<p>pre_A_to_I.rds</p>
<p>spliced_A_to_I.rds</p>
<p>isoform_TPM_index_pre_spliced.csv</p>
<p>pre_TPM_index_pre_spliced.csv</p>
<p>spliced_TPM_index_pre_spliced.csv</p>
</div>
</div>
<div id="pre-process" class="section level2">
<h2>pre-process</h2>
<div id="extract-the-modification-read-counts-and-un-modification-read-counts" class="section level3">
<h3>extract the modification read counts and un-modification read
counts</h3>
</div>
<div id="calculate-the-error-rate-for-site" class="section level3">
<h3>calculate the error rate for site</h3>
</div>
<div id="filter-the-site" class="section level3">
<h3>filter the site</h3>
<p>From the initial analysis of 1,152 cells, we identified 48,556
potential editing sites. After applying stringent quality filters that
excluded sites with error rates exceeding 1%, we retained 1,159
high-confidence A-to-I editing sites. To ensure data reliability, we
further filtered the dataset by removing cells with fewer than 200 reads
in either spliced or unspliced mRNA fractions, resulting in a final set
of 1,119 cells for downstream analysis.</p>
</div>
<div id="deseq2-to-test-the-differential-methylation-between-the-spliced-mrna-and-pre-mrna" class="section level3">
<h3>DESeq2 to test the differential methylation between the spliced mRNA
and pre-mRNA</h3>
<p>We will get the following data in
VeloRM_data/RNA-Seq_A-to-I_2/pre_process</p>
<p>Processed data:</p>
<p>SNP_1159: the SNP information for the A-to-I site for further
analysis.</p>
<p>test_list: the test cell reads counts
(spliced_meth_test,spliced_unmeth_test,pre_meth_test,pre_unmeth_test,
isoform_meth_test,isoform_unmeth_test)</p>
<p>control_list: NULL</p>
<p>res_preprocess: the list processed by VeloRM</p>
<p>res_DESeq2: the DESeq2 results</p>
</div>
</div>
<div id="analysis" class="section level2">
<h2>analysis</h2>
<div id="overall-reads-counts" class="section level3">
<h3>Overall reads counts</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>counts_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/origin/bam_read_counts.csv&quot;</span>, </span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>                       <span class="at">header =</span> <span class="cn">TRUE</span>,  <span class="co"># Assumes first row contains column names</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>                       <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)  <span class="co"># Prevents automatic conversion to factors</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co"># View the first few rows</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>index_cell_name <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/pre_process/index_cell_name.rds&quot;</span>)</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>counts_data <span class="ot">&lt;-</span>counts_data [counts_data<span class="sc">$</span>Folder<span class="sc">%in%</span> index_cell_name,]</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>counts_data_sum <span class="ot">&lt;-</span> <span class="fu">apply</span>(counts_data,<span class="dv">1</span>,<span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">as.numeric</span>(x[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])))</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>isoform_prop <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(counts_data[,<span class="dv">2</span>])<span class="sc">/</span>counts_data_sum</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>spliced_prop <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(counts_data[,<span class="dv">3</span>])<span class="sc">/</span>counts_data_sum</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>pre_prop <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(counts_data[,<span class="dv">4</span>])<span class="sc">/</span>counts_data_sum</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>  <span class="st">`</span><span class="at">mature RNA</span><span class="st">`</span> <span class="ot">=</span> spliced_prop,</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>  <span class="st">`</span><span class="at">pre RNA</span><span class="st">`</span> <span class="ot">=</span> pre_prop,</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>  <span class="st">`</span><span class="at">ambiguous</span><span class="st">`</span> <span class="ot">=</span> isoform_prop,</span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>)</span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(df, <span class="at">cols =</span> <span class="fu">everything</span>(), </span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>                       <span class="at">names_to =</span> <span class="st">&quot;Type&quot;</span>, </span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>                       <span class="at">values_to =</span> <span class="st">&quot;Probability&quot;</span>)</span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a><span class="fu">library</span>(ggh4x)</span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> Probability, <span class="at">fill =</span> Type)) <span class="sc">+</span>  </span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, </span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a>                 <span class="at">outlier.shape =</span> <span class="cn">NA</span>,</span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a>                 <span class="at">coef =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>Type, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a><span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))<span class="sc">+</span> <span class="fu">facetted_pos_scales</span>(</span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">list</span>(Type <span class="sc">==</span> <span class="st">&quot;mature RNA&quot;</span> <span class="sc">~</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.25</span>)),</span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a>           Type <span class="sc">==</span> <span class="st">&quot;pre RNA&quot;</span> <span class="sc">~</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.4</span>,<span class="dv">1</span>)),</span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a>           Type <span class="sc">==</span> <span class="st">&quot;ambiguous&quot;</span> <span class="sc">~</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>))))<span class="sc">+</span>  </span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a>        <span class="at">title =</span> <span class="cn">NULL</span>,</span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a>        <span class="at">x =</span> <span class="cn">NULL</span>,  </span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;Probability&quot;</span></span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a>    <span class="co"># Use theme_gray() which is the default ggplot2 theme</span></span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a>    <span class="fu">theme_gray</span>(<span class="at">base_size =</span> <span class="dv">14</span>)  <span class="sc">+</span></span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(</span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a>        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;mature RNA&quot;</span> <span class="ot">=</span> <span class="st">&quot;#FF9999&quot;</span>,  </span>
<span id="cb11-47"><a href="#cb11-47" tabindex="-1"></a>                   <span class="st">&quot;pre RNA&quot;</span> <span class="ot">=</span> <span class="st">&quot;#99CCFF&quot;</span>,     </span>
<span id="cb11-48"><a href="#cb11-48" tabindex="-1"></a>                   <span class="st">&quot;ambiguous&quot;</span> <span class="ot">=</span> <span class="st">&quot;#99CC99&quot;</span>),   </span>
<span id="cb11-49"><a href="#cb11-49" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;mature RNA&quot;</span>, <span class="st">&quot;pre RNA&quot;</span>, <span class="st">&quot;ambiguous&quot;</span>) </span>
<span id="cb11-50"><a href="#cb11-50" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb11-51"><a href="#cb11-51" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb11-52"><a href="#cb11-52" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb11-53"><a href="#cb11-53" tabindex="-1"></a>  )</span>
<span id="cb11-54"><a href="#cb11-54" tabindex="-1"></a></span>
<span id="cb11-55"><a href="#cb11-55" tabindex="-1"></a>box_plot</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABlVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrYZGT8ZGWIZP4EZYp8aGhozMzM6AAA6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kJA6kNs/GRk/GT8/GWI/P4E/gb1IGRlIl91NTU1NTW5NTY5Nbm5NbqtNjshiGRliGT9igYFin59in9lmAABmOgBmOjpmZjpmZmZmZpBmkLZmtv9uTU1uTW5uTY5ubm5ubqtuq+RxGRlxcXGBPxmBPz+BgT+BgWKBn4GBvZ+BvdmOTU2OTW6OyP+QOgCQZjqQZmaQkGaQtraQttuQ2/+X3f+fYhmfvYGfvdmf2b2f2dmp0qmp0vurbk2r5P+t1q2t1v+2ZgC2Zjq2kGa2tpC2tra2ttu229u22/+2/9u2//+63Ze9gT+92dnIjk3I5KvI///Zn2LZvYHZvZ/Z2Z/Z2b3Z2dnbkDrbtmbbtpDbtrbb27bb29vb2//b///d/93kq27k///r6+v7qan/ra3/tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///+bhavTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMX0lEQVR4nO2djX/cNhnHndKxpLkcNGyDtARubMkgWVlhFAqBjnTLyjbClpG9tnSUNOsdzYVuKdxgTbIkl/u7keQ32Zb9yJLsyKfn+Xya893VP1tfS49k6fFz3git0LyzPgHbDQEBhoAAQ0CAISDAEBBgCAgwBASYHqB+CatOWVJaTREBISC9k0VACEjvZBEQAtI7WQSEgPROFgEhIL2TNQKod2k18WoK0D/fzZfbWWkxm+/3H/62zMnmiSxO00+6Uxvk71Yr2ssoIMmLIqtcKLuzMs/+z9ySFqBYZLG1FALaWfldtFfTAfXXp/UBMZHFn/7wfgCod/kf0V56gOZ7cy0CvnfpRqt14T4rEbkSk69d3mCFo39oLZ6mm38upUyqPdWeD3V6l//QmtqgYqwNqAAi51cksri0Ph8AWr/wn2gvPUCUytbURm/uwv2dlWlakIeL8+RYUxEg+rH/VTlATJZoRIDmpvtMqL9FjhmXrduSbmLkJIpEFpd6lzcYIFKGeC89QKTt+mcfvF5aZVdgKwbE3nfp+5KAfDkO0FJweUlJ/LL5/nVJ2kkDIuSTrXn2bXdyNd5LD1BU//1jkk12aXpxE+uy97SwZZvYZBIQfd2K+pzg4vfm6LYkIHZ++SIE0MOX2AUlDS7ey1ZAmRrEyuY3DM59dEvUoBBQjgitU1vTBBDxoi1T3Tx/9lwT63JNbHJVrYl1BTWIiSU7oHXqM+QABVctT4QC2vn9jakNWoR4LzOAsk6avu6sTEZO+uHij0sp9+YmV1mtD3RY2XZWyNUPChgNYaR7sel+oQjzSt3W1HvUicd7GapBN4K+3O/myWXo0076Zy9F3Xy/96NSypN/JCe83poOdfwxERULKkDYQ2+15qXHQYUivtten/oL9eTxXpXci3W5Zh6ZEWWxmZeM9zINiNZdNtJAQDnHpL2oiA8CMlMKFWUEhID0lBEQAtJTthjQf4Um/tiEspa0miICQkB6J4uAEJDeySIgfUDbnc6LX0Xvjn71ge4xE5InNzudnzwguq92+OMoAzp5/QPBUaoENHjxq9PNhfDd6ebz+oA4yZOb5HWblGOfL4sGoO3o/JInXhmgk5tvjEb79Br7R31Bvwbxkvu0PLRWDriiqAMi9TEElDrxygCxJsUOxt5d+1wfUFIy+GD7uglA+wuRC8gcpSJA7BqExzndfCM8gRlq0M4SktRIEzu5+WvfFwXSasojzkfyR9E4WVlA/vUl7cCAk05IUlXSKo5eJW+PfqPvpNOA4opZQw06uvbAIKCwBg064RZXq4wBqryJ8U150GGme8ykd4i7HbOA6vJB6c7AQA1KSA6C3oxd73gMow+orl6MelB+OGFioMhJhnLE/Y/4sZA+oPSJVzqSXqAluG4MECcZtVo6oubGinqA/JP1j5IrOcOZFqACUy2FqrLRe7GZv1L7iP5BQCJJBARIIiBAEgEBkggIkERAgCQCAiQRECCJgABJBARIIiBAstmAKrDxAiRWxhoEKCMgQBkBAcqNA1SdjQkg86UoVkZA+cpyM8hlJMcN0P+ofU3/NBlQwXXWVR4TQO8T+5D+eR8BCYuBgIBiICCgGBYDStvMR5EVxA45BCijiDWoWNJmQIIw4FTQrtuARGHAqaBdpwGJwoDT4U5OAxKFAac/cxqQKAw4HbSbOdTM15EpBvQ2DlAiDDj9WVbZ3RrEwoDTtcppQKIwYPRBQBgw9mJAGHA6aLdJgLgh7ulmp8M/laMISBQGnArabRAgfoi7vZB4PATvxUZJ58Daw6Dwjsk9QJlhLwJKWnqAEm6Kn1Gb+TAy9WfiRKWxHlDgeIiXLnyQGGsQ8ISRg4AyPqjwGTUHASUmb8CnHMce0PHy7NspXW6Im37qzUFAw0/anvfs3SSh+IE6OpJ23kl/+abnTTz7mWIxHAA0Chg991ilGG4AOvwTaWikqf27fDFMAcqYPVOu33xK6MzeHR2ueU+XPeb416AhpXP+bVZ1jpfP3StdjHEHdLw88YvH0fb3oDZmH6DU5FVRl6tWgyQ8s82ABvygjdDZLhi0qdWgK7OsWQ3XwOZlI6DM5BWfBsEAoL29L5fP3d0j9qjdSED8jWMFgI6XvdieAvt4CwHxN4t8ExNOXikEUB3eud2eeOsOtb/J8LEVUDB5BWTBU3PSt65KkbEbEKtBNLDmdLNg8sridbHKAPE+iMEy6oPowDB2Q4100pnJK6OAaPMa3nolMKmmZhsgfvIqil0zBkjBrAPET16lUjYhoLKSCj6IGwbJ+aCMjfW6WOx/KvdBiRGKn/sOygZsASAFUwSUDPn1I6igbMAuAUoES4X5e6FswBYAqm0clFiLDPP3QtmALQBU2zgotf4Y8AKyAdszJ61zTKUwYH9eAsoGbEENqhtQogYxa0aU66OfX7yYWls1DCgVD3FmgJRSlQ7XPG+i7XnPVTgflAr5ZYDAbMC2ANr1nvpsNDp82ftBdYBSIb9BelogG7AlgIZrE+/Q14N2pVOuiQTDfhODsgFb4oPCxUKJRUMdQCrKdgAafVxLDVJRtgTQcI36oOHaeambebcARbcZ3/ou+TeLTYwZD+jKRc4QkG84o4iA8iRVAe2xldXbV7GJMUsDOmg3eV2slKTiOMibbU88c8Xzh0PMRHkknAV0vDzxDh0r7sb3YqI8Ei4DOndv1/slN5IW/pyc24CekNoT34sJf07OXUD0Xuyg/TSpQSEgUR4J+lLxA3VZZe056YyiUgaqJ965v695349jpEV5JCJzsAaN/vWdewcve150s5r7c3KuAmL2TRwNnPtzck4D4kyUR6KgGA4ASq9qiPJIOAxIsKohyiPhLqBaVjWUlO0AVNOqhoqyHYBwVQMAhKsaECBc1cgHhKsaECATqxqYsh0oBgICiiEHSBAG3JxswPRW45l0Ag9pQFI+SBQG3JRswOGthlQvbzAMuDF5FHe985XfaojCgJuSibOWWw1REGdTsgHXcqshCgNuSjZgui5GXw+qfCwcqkE2Axp97DufXTixiTogURhwU3wQXZuffet2YunZOCBRGHBjejHagRE7L5eBKmNy62KCMODGZAP+4vFouLcn++x8thhyN6uCMOCGZAOW7L10Aako2/ELdQgIADR60v52iRRC7gE6vtLwCDN+TqCa5CbNzryQSJ9+HTMvpKWrzkDVeECJ7C/J58zNAHp065Wrkg8bWgmIv6MbLOwnHhM2kIGKTpbJJufKK4YVgNj4c5uOO4tSF5evQWxd/nBNbq7MZkCsBjH/XJT8uvxz8/5kmeRcmZWAeB/EUjkYBRSMossMpm0DlE2f/rrBXmwMACXTp18v/hGQZgPKmOScdIn06c0GlFU+++mOYz9NaZCtVOqW1TVApVN0uQVo+MUdzqRylboFSMEQEDVRKEZuMRwEJArFyC+Ge4CEGdnyi+EeIGFGtvxiuAcoL58W/kJdYKJQjIJiYA1CQCnLzcgmLoZ7gEShGAXFcA+QMBQjvxgOAhKGYuQWQw6QYP0T0yVzu/GD83Ab0yXHe/FuLdpuQLrk2gBlfoGHbjcgXXJtgPihVbiN6ZJz4qTDbUyXDNQg9kUTwoDrACT0QQgo3kvUi51FumRrASUG58H2WaRLthdQYnAexEdXny45bWoJlsqZKiAVZadqkIoyAgKUERCgjIAAZQQEKCMgQLmRgDLm4LpYyWJgDQKKgYCAYiAgoBgICCiGKUAZc2nKVU0ZaxCgjIAAZQQEKCMgQNk8IKWf8NMtRoMABfuKP40MASGgXEkEBEgiIEASAQGSCAiQPBNADUp2eyaApI6ppIyAAGWLAZXIWSQLSCRpJl1yUiURtFwVIFHMriYgkSSYLlnqzimpcrpZ+FNWZgAJY3b1jimSBBNNSkmnVAYv1FCDcuPl1I8pkgRTlUpJJ1WOrn1eA6C8iEvxA3VSJpIE0yWXVqZBa6EP0jjZUg/UpXMaK14UkSSYLllKOqEyWKjFSefG7GoDyq1B2oD8xnvtQS2AGuuD4N/6MgOoyb1YPeMgQcyu5jGFklC6ZDnplEotgEQxu5qAhJJAumRJ6cTTfzUBKjBVQKrKWtIIqJKTRUCVAhKb4V95rlYaUkRAwPcICPgeAQHfVwForAwBAYaAAENAgCEgwBAQYAgIMAQEGAICDAEBhoAAQ0CAISDAEBBgCAgwBAQYAgIMAQGGgABDQIAhIMAQEGAICDAEBBgCAgwBAYaAAENAgCEgwP4PbQp+rVBmoagAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="at">category =</span> <span class="fu">c</span>(<span class="st">&quot;Ambiguous&quot;</span>,<span class="st">&quot;Spliced&quot;</span>, <span class="st">&quot;Unspliced&quot;</span>),</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="at">proportion =</span> <span class="fu">c</span>(<span class="fu">sum</span>(counts_data[,<span class="dv">2</span>]),<span class="fu">sum</span>(counts_data[,<span class="dv">3</span>]), <span class="fu">sum</span>(counts_data[,<span class="dv">4</span>]))</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>plot_data<span class="sc">$</span>fraction <span class="ot">&lt;-</span> plot_data<span class="sc">$</span>proportion <span class="sc">/</span> <span class="fu">sum</span>(plot_data<span class="sc">$</span>proportion)</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>plot_data<span class="sc">$</span>ypos <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(plot_data<span class="sc">$</span>fraction) <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> plot_data<span class="sc">$</span>fraction</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#  count </span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>plot_data<span class="sc">$</span>count <span class="ot">&lt;-</span> plot_data<span class="sc">$</span>proportion</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co"># pie</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>pie_chart <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> fraction, <span class="at">fill =</span> category)) <span class="sc">+</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>    <span class="at">y =</span> ypos,</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(category, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, count, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="fu">round</span>(fraction <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>)</span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>  ),</span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">lineheight =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="cn">NULL</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a>pie_chart</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABblBMVEUAujgAul4AuoAAxl4AxoAAxqIA0sI6ujg6xqI60qI60sI63eFhnP9hrf9hvv9mujhmxjhm3cJm3eFm6OFm6P9+nP9+rf9+vv9+z/+QxjiQ3cKQ6OGQ9OGQ9P+ZnP+Zrf+Zvv+Zz/+Z3/+0rf+0vv+0z/+03/+07/+20ji20l623V623YC29OG29P+2/+G2///Ovv/Oz//O3//O7//O///b3V7b3YDb6IDb6KLb9MLb9OHb9P/b///nz//n3//n7//n///4dm34dof4dqD4j4f4j6D4j7n4ptH5dm35j235j6D5j7n5prn5ptH5vdH5vej7dm37dof7j237pqD7vdH7vej71Oj71P/8j238pm38pof8vYf8vaD81Oj81P/86ej86f/8///+vYf+vaD+1KD+1Ln+1NH+6bn+6dH+6f/+////1KD/3///6ID/6bn/6dH/6ej/7///9KL/9ML/9OH//8L//9H//+H//+j///+luDyWAAAACXBIWXMAAA7DAAAOwwHHb6hkAAARQ0lEQVR4nO3djXsbtRkAcCfLxyCOYSNpDSyFuh+GdV1S4g7GkiZOVloGWxnbyFrGlnSwsdYZBEYT/ffTq69778PWSSfJd43e5yGRz3eO9UPS3UkntUViTIzWtL9A3SMCaSICaSICaSICaSICaSICaSICaSICaSICaSICaSICaSICaSICaSICaSICaSICaSICaSICaSICaSICaSICaSICaSICaSICaSICaSICaaJWQEMa7XZ72l8jFVMHGmainY5pf73pAmVxCoCmjjQ1oCKcMUBTRZoK0DicCUBTQwoPNElnMtBUjMICaXD0QOGRwgGVwCkHFBYpDFBJnPJA4YyCABn4lAcKRBQAyITHCCgIkWcgMxxjoABIfoHMfcyBPBP5BLLgsQLyKuQPyIrHDsgnkS8gSx5bIH9EnoCsfayBfBF5AbLnqQLkR8gHUBWfKkBeiNwDVeKpCORByDVQRZ6qQO6J3AJV5qkO5JrIKZADHwdAbokcArngcQPkUsgdkBsfN0AOhZwBOfJxBOROyBWQKx9XQM6EHAE583EG5IrICZA7HpdAboRcALn0cQnkRMgBkFMfp0AuhKoDufVxC+RAqDKQYx/HQNWFqgK59nENVFmo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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>res_preprocess <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/pre_process/res_preprocess.rds&quot;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>spliced_index <span class="ot">&lt;-</span> <span class="fu">which</span>(res_preprocess[[<span class="st">&quot;spliced_methylation_M_value_meta&quot;</span>]]<span class="sc">&gt;=</span><span class="dv">1</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>unspliced_index <span class="ot">&lt;-</span> <span class="fu">which</span>(res_preprocess[[<span class="st">&quot;unspliced_methylation_M_value_meta&quot;</span>]]<span class="sc">&gt;=</span><span class="dv">1</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>spliced_index_l <span class="ot">&lt;-</span> <span class="fu">length</span>(spliced_index)</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>unspliced_index_l <span class="ot">&lt;-</span> <span class="fu">length</span>(unspliced_index)</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>intersect_l <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">intersect</span>(spliced_index,unspliced_index))</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="fu">library</span>(VennDiagram)</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="fu">grid.newpage</span>()</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>venn <span class="ot">&lt;-</span><span class="fu">draw.pairwise.venn</span>(</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>  <span class="at">area1 =</span> spliced_index_l,</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>  <span class="at">area2 =</span> unspliced_index_l,</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>  <span class="at">cross.area =</span> intersect_l,</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>  <span class="at">category =</span> <span class="fu">c</span>(<span class="st">&quot;Spliced&quot;</span>, <span class="st">&quot;Unspliced&quot;</span>),</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>  <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;#E74C3C&quot;</span>,<span class="st">&quot;skyblue&quot;</span>),</span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>  <span class="at">lty =</span> <span class="st">&quot;blank&quot;</span>,</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>  <span class="at">cex =</span> <span class="dv">2</span>,</span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>  <span class="at">cat.cex =</span> <span class="fl">1.5</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="splicing-jucntion-distance" class="section level3">
<h3>splicing jucntion distance</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">library</span>(GenomicRanges)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">library</span>(rtracklayer)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>snp <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/pre_process/SNP_1931.rds&quot;</span>)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>snp_pos <span class="ot">&lt;-</span> snp<span class="sc">@</span>ranges<span class="sc">@</span>start</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>snp_chr_length <span class="ot">&lt;-</span> snp<span class="sc">@</span>seqnames<span class="sc">@</span>lengths</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>snp_chr_seq <span class="ot">&lt;-</span> snp<span class="sc">@</span>seqnames<span class="sc">@</span>values</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>snp_chr <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">rep</span>(snp_chr_seq,snp_chr_length)) </span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>snp_strand <span class="ot">&lt;-</span> snp<span class="sc">@</span>elementMetadata<span class="sc">@</span>listData[[<span class="st">&quot;transcript_strand&quot;</span>]]</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>snp_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(snp_chr,snp_pos,snp_strand))</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>snp_data<span class="sc">$</span>snp_pos <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(snp_data<span class="sc">$</span>snp_pos)</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co"># Read the GTF file from Ensembl</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>gtf_file <span class="ot">&lt;-</span> <span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I/origin/gencode.vM33.annotation.gtf&quot;</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>gtf_data <span class="ot">&lt;-</span> <span class="fu">import</span>(gtf_file)</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co"># Filter for exons</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>exons <span class="ot">&lt;-</span> gtf_data[gtf_data<span class="sc">$</span>type <span class="sc">==</span> <span class="st">&quot;exon&quot;</span>]</span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co"># Convert to data frame</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>exons_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="at">chr =</span> <span class="fu">as.character</span>(<span class="fu">seqnames</span>(exons)),</span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="at">start =</span> <span class="fu">start</span>(exons),</span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="at">end =</span> <span class="fu">end</span>(exons),</span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="at">strand =</span> <span class="fu">as.character</span>(<span class="fu">strand</span>(exons)),</span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a><span class="at">gene_id =</span> <span class="fu">mcols</span>(exons)<span class="sc">$</span>gene_id,</span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a><span class="at">transcript_id =</span> <span class="fu">mcols</span>(exons)<span class="sc">$</span>transcript_id</span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a>)</span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a></span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a><span class="co"># Sort exons by transcript and position</span></span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a>exons_df <span class="ot">&lt;-</span> exons_df <span class="sc">%&gt;%</span></span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a><span class="fu">arrange</span>(transcript_id, chr, start)</span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a><span class="co"># Extract splicing junctions using intron boundaries</span></span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a>junctions <span class="ot">&lt;-</span> exons_df <span class="sc">%&gt;%</span></span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a><span class="fu">group_by</span>(transcript_id) <span class="sc">%&gt;%</span></span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a><span class="fu">arrange</span>(<span class="fu">if_else</span>(strand <span class="sc">==</span> <span class="st">&quot;+&quot;</span>, start, <span class="sc">-</span>start)) <span class="sc">%&gt;%</span>  <span class="co"># Sort based on strand</span></span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb14-44"><a href="#cb14-44" tabindex="-1"></a>  <span class="at">donor_site =</span> end,                <span class="co"># End of the upstream exon</span></span>
<span id="cb14-45"><a href="#cb14-45" tabindex="-1"></a>  <span class="at">acceptor_site =</span> <span class="fu">lead</span>(start)      <span class="co"># Start of the downstream exon</span></span>
<span id="cb14-46"><a href="#cb14-46" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb14-47"><a href="#cb14-47" tabindex="-1"></a><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(acceptor_site)) <span class="sc">%&gt;%</span>   <span class="co"># Remove the last exon (no downstream exon)</span></span>
<span id="cb14-48"><a href="#cb14-48" tabindex="-1"></a><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-49"><a href="#cb14-49" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(chr, donor_site, acceptor_site, gene_id, transcript_id, strand)</span>
<span id="cb14-50"><a href="#cb14-50" tabindex="-1"></a></span>
<span id="cb14-51"><a href="#cb14-51" tabindex="-1"></a></span>
<span id="cb14-52"><a href="#cb14-52" tabindex="-1"></a>junctions_unique <span class="ot">&lt;-</span> junctions <span class="sc">%&gt;%</span></span>
<span id="cb14-53"><a href="#cb14-53" tabindex="-1"></a> <span class="fu">distinct</span>(chr, donor_site, acceptor_site, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-54"><a href="#cb14-54" tabindex="-1"></a></span>
<span id="cb14-55"><a href="#cb14-55" tabindex="-1"></a></span>
<span id="cb14-56"><a href="#cb14-56" tabindex="-1"></a></span>
<span id="cb14-57"><a href="#cb14-57" tabindex="-1"></a>junctions_long <span class="ot">&lt;-</span> junctions_unique <span class="sc">%&gt;%</span></span>
<span id="cb14-58"><a href="#cb14-58" tabindex="-1"></a> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(donor_site, acceptor_site), </span>
<span id="cb14-59"><a href="#cb14-59" tabindex="-1"></a>              <span class="at">names_to =</span> <span class="st">&quot;site_type&quot;</span>, </span>
<span id="cb14-60"><a href="#cb14-60" tabindex="-1"></a>              <span class="at">values_to =</span> <span class="st">&quot;site_position&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-61"><a href="#cb14-61" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(chr, site_position, site_type, gene_id, transcript_id, strand)</span>
<span id="cb14-62"><a href="#cb14-62" tabindex="-1"></a></span>
<span id="cb14-63"><a href="#cb14-63" tabindex="-1"></a></span>
<span id="cb14-64"><a href="#cb14-64" tabindex="-1"></a></span>
<span id="cb14-65"><a href="#cb14-65" tabindex="-1"></a><span class="co"># Calculate distance from each SNP to the nearest junction (matching chr and strand)</span></span>
<span id="cb14-66"><a href="#cb14-66" tabindex="-1"></a>snp_with_distance <span class="ot">&lt;-</span> snp_data <span class="sc">%&gt;%</span></span>
<span id="cb14-67"><a href="#cb14-67" tabindex="-1"></a> <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-68"><a href="#cb14-68" tabindex="-1"></a> <span class="fu">mutate</span>(</span>
<span id="cb14-69"><a href="#cb14-69" tabindex="-1"></a>   <span class="at">nearest_junction_distance =</span> <span class="fu">min</span>(</span>
<span id="cb14-70"><a href="#cb14-70" tabindex="-1"></a>     <span class="fu">abs</span>(junctions_long<span class="sc">$</span>site_position[junctions_long<span class="sc">$</span>chr <span class="sc">==</span> snp_chr <span class="sc">&amp;</span> junctions_long<span class="sc">$</span>strand <span class="sc">==</span> snp_strand] <span class="sc">-</span> snp_pos),</span>
<span id="cb14-71"><a href="#cb14-71" tabindex="-1"></a>     <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb14-72"><a href="#cb14-72" tabindex="-1"></a>   )</span>
<span id="cb14-73"><a href="#cb14-73" tabindex="-1"></a> )</span>
<span id="cb14-74"><a href="#cb14-74" tabindex="-1"></a></span>
<span id="cb14-75"><a href="#cb14-75" tabindex="-1"></a></span>
<span id="cb14-76"><a href="#cb14-76" tabindex="-1"></a><span class="co"># get normal chr</span></span>
<span id="cb14-77"><a href="#cb14-77" tabindex="-1"></a>standard_chromosomes <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;chr&quot;</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">22</span>, <span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>))</span>
<span id="cb14-78"><a href="#cb14-78" tabindex="-1"></a></span>
<span id="cb14-79"><a href="#cb14-79" tabindex="-1"></a><span class="co"># get the exon with the normal chr</span></span>
<span id="cb14-80"><a href="#cb14-80" tabindex="-1"></a>exons_filtered <span class="ot">&lt;-</span> exons[<span class="fu">seqnames</span>(exons) <span class="sc">%in%</span> standard_chromosomes]</span>
<span id="cb14-81"><a href="#cb14-81" tabindex="-1"></a></span>
<span id="cb14-82"><a href="#cb14-82" tabindex="-1"></a></span>
<span id="cb14-83"><a href="#cb14-83" tabindex="-1"></a></span>
<span id="cb14-84"><a href="#cb14-84" tabindex="-1"></a><span class="co"># calculate the distance </span></span>
<span id="cb14-85"><a href="#cb14-85" tabindex="-1"></a>exon_lengths <span class="ot">&lt;-</span> <span class="fu">width</span>(exons_filtered)</span>
<span id="cb14-86"><a href="#cb14-86" tabindex="-1"></a></span>
<span id="cb14-87"><a href="#cb14-87" tabindex="-1"></a><span class="co"># calculate the prob </span></span>
<span id="cb14-88"><a href="#cb14-88" tabindex="-1"></a>prob_weights <span class="ot">&lt;-</span> exon_lengths <span class="sc">/</span> <span class="fu">sum</span>(exon_lengths)</span>
<span id="cb14-89"><a href="#cb14-89" tabindex="-1"></a></span>
<span id="cb14-90"><a href="#cb14-90" tabindex="-1"></a><span class="co"># random sample</span></span>
<span id="cb14-91"><a href="#cb14-91" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb14-92"><a href="#cb14-92" tabindex="-1"></a></span>
<span id="cb14-93"><a href="#cb14-93" tabindex="-1"></a></span>
<span id="cb14-94"><a href="#cb14-94" tabindex="-1"></a><span class="co">#random_distances_list &lt;- list()</span></span>
<span id="cb14-95"><a href="#cb14-95" tabindex="-1"></a></span>
<span id="cb14-96"><a href="#cb14-96" tabindex="-1"></a><span class="co">#for (i in 1:10){</span></span>
<span id="cb14-97"><a href="#cb14-97" tabindex="-1"></a> selected_exons <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_along</span>(exons_filtered), <span class="at">size =</span> <span class="dv">1931</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> prob_weights)</span>
<span id="cb14-98"><a href="#cb14-98" tabindex="-1"></a> <span class="co"># choose the site in the select the exons</span></span>
<span id="cb14-99"><a href="#cb14-99" tabindex="-1"></a> random_positions <span class="ot">&lt;-</span> <span class="fu">start</span>(exons[selected_exons]) <span class="sc">+</span> </span>
<span id="cb14-100"><a href="#cb14-100" tabindex="-1"></a>   <span class="fu">floor</span>(<span class="fu">runif</span>(<span class="dv">1931</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> exon_lengths[selected_exons]))</span>
<span id="cb14-101"><a href="#cb14-101" tabindex="-1"></a> </span>
<span id="cb14-102"><a href="#cb14-102" tabindex="-1"></a> <span class="co"># create the data frame</span></span>
<span id="cb14-103"><a href="#cb14-103" tabindex="-1"></a> random_sites <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-104"><a href="#cb14-104" tabindex="-1"></a>   <span class="at">chr =</span> <span class="fu">as.character</span>(<span class="fu">seqnames</span>(exons[selected_exons])),</span>
<span id="cb14-105"><a href="#cb14-105" tabindex="-1"></a>   <span class="at">position =</span> random_positions,</span>
<span id="cb14-106"><a href="#cb14-106" tabindex="-1"></a>   <span class="at">strand =</span> <span class="fu">as.character</span>(<span class="fu">strand</span>(exons[selected_exons]))</span>
<span id="cb14-107"><a href="#cb14-107" tabindex="-1"></a> )</span>
<span id="cb14-108"><a href="#cb14-108" tabindex="-1"></a> </span>
<span id="cb14-109"><a href="#cb14-109" tabindex="-1"></a> </span>
<span id="cb14-110"><a href="#cb14-110" tabindex="-1"></a> <span class="co"># Calculate distance from each SNP to the nearest junction (matching chr and strand)</span></span>
<span id="cb14-111"><a href="#cb14-111" tabindex="-1"></a> random_sites_with_distance <span class="ot">&lt;-</span> random_sites <span class="sc">%&gt;%</span></span>
<span id="cb14-112"><a href="#cb14-112" tabindex="-1"></a>   <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-113"><a href="#cb14-113" tabindex="-1"></a>   <span class="fu">mutate</span>(</span>
<span id="cb14-114"><a href="#cb14-114" tabindex="-1"></a>     <span class="at">nearest_junction_distance =</span> <span class="fu">min</span>(</span>
<span id="cb14-115"><a href="#cb14-115" tabindex="-1"></a>       <span class="fu">abs</span>(junctions_long<span class="sc">$</span>site_position[junctions_long<span class="sc">$</span>chr <span class="sc">==</span> chr <span class="sc">&amp;</span> junctions_long<span class="sc">$</span>strand <span class="sc">==</span> strand] <span class="sc">-</span> position),</span>
<span id="cb14-116"><a href="#cb14-116" tabindex="-1"></a>       <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb14-117"><a href="#cb14-117" tabindex="-1"></a>     )</span>
<span id="cb14-118"><a href="#cb14-118" tabindex="-1"></a>   )</span>
<span id="cb14-119"><a href="#cb14-119" tabindex="-1"></a> random_distances_list  <span class="ot">&lt;-</span> random_sites_with_distance<span class="sc">$</span>nearest_junction_distance</span>
<span id="cb14-120"><a href="#cb14-120" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb14-121"><a href="#cb14-121" tabindex="-1"></a></span>
<span id="cb14-122"><a href="#cb14-122" tabindex="-1"></a></span>
<span id="cb14-123"><a href="#cb14-123" tabindex="-1"></a></span>
<span id="cb14-124"><a href="#cb14-124" tabindex="-1"></a>random_distances_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-125"><a href="#cb14-125" tabindex="-1"></a> <span class="at">distance =</span> random_distances_list,</span>
<span id="cb14-126"><a href="#cb14-126" tabindex="-1"></a> <span class="at">group =</span> <span class="st">&quot;Random&quot;</span></span>
<span id="cb14-127"><a href="#cb14-127" tabindex="-1"></a>)</span>
<span id="cb14-128"><a href="#cb14-128" tabindex="-1"></a></span>
<span id="cb14-129"><a href="#cb14-129" tabindex="-1"></a><span class="co"># merge the data frame</span></span>
<span id="cb14-130"><a href="#cb14-130" tabindex="-1"></a>real_distances_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-131"><a href="#cb14-131" tabindex="-1"></a> <span class="at">distance =</span> snp_with_distance<span class="sc">$</span>nearest_junction_distance,</span>
<span id="cb14-132"><a href="#cb14-132" tabindex="-1"></a> <span class="at">group =</span> <span class="st">&quot;Real&quot;</span></span>
<span id="cb14-133"><a href="#cb14-133" tabindex="-1"></a>)</span>
<span id="cb14-134"><a href="#cb14-134" tabindex="-1"></a></span>
<span id="cb14-135"><a href="#cb14-135" tabindex="-1"></a></span>
<span id="cb14-136"><a href="#cb14-136" tabindex="-1"></a>all_distances_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(random_distances_df, real_distances_df)</span>
<span id="cb14-137"><a href="#cb14-137" tabindex="-1"></a>group_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Real&quot;</span>,<span class="st">&quot;Random&quot;</span>)</span>
<span id="cb14-138"><a href="#cb14-138" tabindex="-1"></a>all_distances_df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(all_distances_df<span class="sc">$</span>group, <span class="at">levels =</span> group_order)</span>
<span id="cb14-139"><a href="#cb14-139" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb14-140"><a href="#cb14-140" tabindex="-1"></a><span class="co">#  Boxplot</span></span>
<span id="cb14-141"><a href="#cb14-141" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_distances_df, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> <span class="fu">log10</span>(distance<span class="sc">+</span><span class="dv">1</span>), <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb14-142"><a href="#cb14-142" tabindex="-1"></a> <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb14-143"><a href="#cb14-143" tabindex="-1"></a> <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb14-144"><a href="#cb14-144" tabindex="-1"></a> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="fu">rep</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="dv">10</span>))) <span class="sc">+</span></span>
<span id="cb14-145"><a href="#cb14-145" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">title =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-146"><a href="#cb14-146" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-147"><a href="#cb14-147" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;log10(Distance (bp)+1)&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-148"><a href="#cb14-148" tabindex="-1"></a> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-149"><a href="#cb14-149" tabindex="-1"></a> <span class="fu">theme</span>(</span>
<span id="cb14-150"><a href="#cb14-150" tabindex="-1"></a>       <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb14-151"><a href="#cb14-151" tabindex="-1"></a>       <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span><span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">7</span>))</span>
<span id="cb14-152"><a href="#cb14-152" tabindex="-1"></a></span>
<span id="cb14-153"><a href="#cb14-153" tabindex="-1"></a></span>
<span id="cb14-154"><a href="#cb14-154" tabindex="-1"></a><span class="fu">saveRDS</span>(all_distances_df,<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/results/splicing_junction_analysis/all_distances_df.rds&quot;</span>)</span></code></pre></div>
<div id="vis" class="section level4">
<h4>vis</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a> all_distances_df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/results/splicing_junction_analysis/all_distances_df.rds&quot;</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#  Boxplot</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_distances_df, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> <span class="fu">log10</span>(distance<span class="sc">+</span><span class="dv">1</span>), <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a> <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a> <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="fu">rep</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="dv">10</span>))) <span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">title =</span> <span class="cn">NULL</span>,</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;log10(Distance (bp)+1)&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a> <span class="fu">theme_grey</span>() <span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>       <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span><span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">7</span>))</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>plot</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="read-the-deseq2-results" class="section level3">
<h3>read the DESeq2 results</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>res_DESeq2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/pre_process/res_DESeq2.rds&quot;</span>)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>log2FC <span class="ot">&lt;-</span>res_DESeq2<span class="sc">@</span>listData[[<span class="st">&quot;log2FoldChange&quot;</span>]]</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>pvals <span class="ot">&lt;-</span> res_DESeq2<span class="sc">@</span>listData[[<span class="st">&quot;pvalue&quot;</span>]]</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">log2FC =</span> log2FC, </span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>                       <span class="at">pvalue =</span> pvals,</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>                       <span class="at">neg_log10_p =</span> <span class="sc">-</span><span class="fu">log10</span>(pvals))</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>volcano_plot_DESeq2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> log2FC, <span class="at">y =</span> neg_log10_p)) <span class="sc">+</span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>  <span class="co"># Add light gray background for -1 &lt; log2FC &lt; 1 (non-significant FC region)</span></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">1</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="dv">30</span>, </span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;gray90&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a>  </span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a>  <span class="co"># Color points based on significance and log2FC:</span></span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a>  <span class="co"># - Red: log2FC &gt; 1 &amp; p &lt; 0.05 (significantly up-regulated)</span></span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a>  <span class="co"># - Blue: log2FC &lt; -1 &amp; p &lt; 0.05 (significantly down-regulated)</span></span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a>  <span class="co"># - Gray: Not significant or |log2FC|  1</span></span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">case_when</span>(</span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a>    log2FC <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">&quot;Unspliced&quot;</span>,</span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a>    log2FC <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">&quot;Spliced&quot;</span>,</span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Not significant&quot;</span></span>
<span id="cb16-29"><a href="#cb16-29" tabindex="-1"></a>  )), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb16-30"><a href="#cb16-30" tabindex="-1"></a>  </span>
<span id="cb16-31"><a href="#cb16-31" tabindex="-1"></a>  <span class="co"># Manual color scale (red, blue, gray)</span></span>
<span id="cb16-32"><a href="#cb16-32" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb16-33"><a href="#cb16-33" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb16-34"><a href="#cb16-34" tabindex="-1"></a>      <span class="st">&quot;Spliced&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb16-35"><a href="#cb16-35" tabindex="-1"></a>      <span class="st">&quot;Unspliced&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb16-36"><a href="#cb16-36" tabindex="-1"></a>      <span class="st">&quot;Not significant&quot;</span> <span class="ot">=</span> <span class="st">&quot;gray50&quot;</span></span>
<span id="cb16-37"><a href="#cb16-37" tabindex="-1"></a>    ),</span>
<span id="cb16-38"><a href="#cb16-38" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Regulation&quot;</span>  <span class="co"># Legend title</span></span>
<span id="cb16-39"><a href="#cb16-39" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-40"><a href="#cb16-40" tabindex="-1"></a>  </span>
<span id="cb16-41"><a href="#cb16-41" tabindex="-1"></a>  <span class="co"># Add dashed lines for thresholds:</span></span>
<span id="cb16-42"><a href="#cb16-42" tabindex="-1"></a>  <span class="co"># - Vertical: log2FC = 1</span></span>
<span id="cb16-43"><a href="#cb16-43" tabindex="-1"></a>  <span class="co"># - Horizontal: p-value = 0.05 (-log10(0.05)  1.3)</span></span>
<span id="cb16-44"><a href="#cb16-44" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-45"><a href="#cb16-45" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fu">log10</span>(<span class="fl">0.05</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-46"><a href="#cb16-46" tabindex="-1"></a>  </span>
<span id="cb16-47"><a href="#cb16-47" tabindex="-1"></a>  <span class="co"># Axis labels and theme</span></span>
<span id="cb16-48"><a href="#cb16-48" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-49"><a href="#cb16-49" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;log2 Fold Change&quot;</span>, </span>
<span id="cb16-50"><a href="#cb16-50" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;-log10(p-value)&quot;</span>,</span>
<span id="cb16-51"><a href="#cb16-51" tabindex="-1"></a>    <span class="at">title =</span> <span class="cn">NULL</span></span>
<span id="cb16-52"><a href="#cb16-52" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-53"><a href="#cb16-53" tabindex="-1"></a>   <span class="fu">theme_grey</span>() <span class="sc">+</span></span>
<span id="cb16-54"><a href="#cb16-54" tabindex="-1"></a>   <span class="co"># Set axis limits (zoomed-in view)</span></span>
<span id="cb16-55"><a href="#cb16-55" tabindex="-1"></a>   <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb16-56"><a href="#cb16-56" tabindex="-1"></a>volcano_plot_DESeq2</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>n_unspliced <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(log2FC <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> pvals <span class="sc">&lt;=</span> <span class="fl">0.05</span>))  </span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>n_spliced <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(log2FC <span class="sc">&lt;=</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> pvals <span class="sc">&lt;=</span> <span class="fl">0.05</span>))  </span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>n_nonsig <span class="ot">&lt;-</span> <span class="fu">sum</span>(pvals <span class="sc">&gt;</span> <span class="fl">0.05</span> <span class="sc">|</span> (log2FC <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> log2FC <span class="sc">&lt;</span> <span class="dv">1</span>))</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>total <span class="ot">&lt;-</span> n_unspliced <span class="sc">+</span> n_spliced <span class="sc">+</span> n_nonsig</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>Percentage <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(n_unspliced, n_spliced, n_nonsig) <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>  <span class="at">Category =</span> <span class="fu">c</span>(<span class="st">&quot;Unspliced&quot;</span>, <span class="st">&quot;Spliced&quot;</span>, <span class="st">&quot;Insignificant&quot;</span>),</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>  <span class="at">Count =</span> <span class="fu">c</span>(n_unspliced, n_spliced, n_nonsig)</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>)</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>pie_chart_DESeq2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> Count, <span class="at">fill =</span> Category)) <span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(Count, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">(&quot;</span>, Percentage, <span class="st">&quot;%)&quot;</span>)), </span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Unspliced&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;Spliced&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>,<span class="st">&quot;Insignificant&quot;</span><span class="ot">=</span><span class="st">&quot;gray50&quot;</span>)) <span class="sc">+</span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a>    <span class="at">title =</span> <span class="cn">NULL</span>,</span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>  </span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a>  )</span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a>pie_chart_DESeq2</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="meth-density" class="section level3">
<h3>meth density</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co"># Load input data</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>test.list <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/pre_process/test.list.rds&quot;</span>)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co"># Extract different parts of the data</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>spliced.meth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">1</span>]]  <span class="co"># Methylated spliced data</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>spliced.unmeth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">2</span>]]  <span class="co"># Unmethylated spliced data</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>unspliced.meth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">3</span>]]  <span class="co"># Methylated unspliced data</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>unspliced.unmeth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">4</span>]]  <span class="co"># Unmethylated unspliced data</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>isoform.meth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">5</span>]]  <span class="co"># Methylated isoform data</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>isoform.unmeth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">6</span>]]  <span class="co"># Unmethylated isoform data</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>spliced.meth.sum.cell <span class="ot">&lt;-</span> <span class="fu">apply</span>(spliced.meth.test,<span class="dv">2</span>,sum)<span class="co">#,apply(spliced.meth.control,2,sum))</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>spliced.unmeth.sum.cell <span class="ot">&lt;-</span> <span class="fu">apply</span>(spliced.unmeth.test,<span class="dv">2</span>,sum)<span class="co">#,apply(spliced.unmeth.control,2,sum))</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>unspliced.meth.sum.cell <span class="ot">&lt;-</span> <span class="fu">apply</span>(unspliced.meth.test,<span class="dv">2</span>,sum)<span class="co">#,apply(unspliced.meth.control,2,sum))</span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>unspliced.unmeth.sum.cell <span class="ot">&lt;-</span> <span class="fu">apply</span>(unspliced.unmeth.test,<span class="dv">2</span>,sum)<span class="co">#,apply(unspliced.unmeth.control,2,sum))</span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a>isoform.meth.sum.cell <span class="ot">&lt;-</span> <span class="fu">apply</span>(isoform.meth.test,<span class="dv">2</span>,sum)<span class="co">#,apply(unspliced.meth.control,2,sum))</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a>isoform.unmeth.sum.cell <span class="ot">&lt;-</span> <span class="fu">apply</span>(isoform.unmeth.test,<span class="dv">2</span>,sum)<span class="co">#,apply(unspliced.unmeth.control,2,sum))</span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a>spliced.sum.cell <span class="ot">&lt;-</span> spliced.meth.sum.cell <span class="sc">+</span> spliced.unmeth.sum.cell</span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a>unspliced.sum.cell <span class="ot">&lt;-</span> unspliced.meth.sum.cell <span class="sc">+</span> unspliced.unmeth.sum.cell</span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a>isoform.sum.cell <span class="ot">&lt;-</span> isoform.meth.sum.cell <span class="sc">+</span> isoform.unmeth.sum.cell</span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a>spliced.prob.cell <span class="ot">&lt;-</span> spliced.sum.cell<span class="sc">/</span>(spliced.sum.cell<span class="sc">+</span>unspliced.sum.cell<span class="sc">+</span>isoform.sum.cell)</span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a>unspliced.prob.cell <span class="ot">&lt;-</span> unspliced.sum.cell<span class="sc">/</span>(spliced.sum.cell<span class="sc">+</span>unspliced.sum.cell<span class="sc">+</span>isoform.sum.cell)</span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a>isoform.prob.cell <span class="ot">&lt;-</span> isoform.sum.cell<span class="sc">/</span>(spliced.sum.cell<span class="sc">+</span>unspliced.sum.cell<span class="sc">+</span>isoform.sum.cell)</span>
<span id="cb18-31"><a href="#cb18-31" tabindex="-1"></a></span>
<span id="cb18-32"><a href="#cb18-32" tabindex="-1"></a></span>
<span id="cb18-33"><a href="#cb18-33" tabindex="-1"></a>spliced.cell.prob <span class="ot">&lt;-</span> spliced.meth.sum.cell<span class="sc">/</span>(spliced.unmeth.sum.cell<span class="sc">+</span>spliced.meth.sum.cell)</span>
<span id="cb18-34"><a href="#cb18-34" tabindex="-1"></a>unspliced.cell.prob <span class="ot">&lt;-</span> unspliced.meth.sum.cell<span class="sc">/</span>(unspliced.unmeth.sum.cell<span class="sc">+</span>unspliced.meth.sum.cell)</span>
<span id="cb18-35"><a href="#cb18-35" tabindex="-1"></a></span>
<span id="cb18-36"><a href="#cb18-36" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-37"><a href="#cb18-37" tabindex="-1"></a>  <span class="at">Probability =</span> <span class="fu">c</span>(spliced.cell.prob, unspliced.cell.prob),</span>
<span id="cb18-38"><a href="#cb18-38" tabindex="-1"></a>  <span class="at">Type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;mature RNA&quot;</span>, <span class="st">&quot;pre RNA&quot;</span>), </span>
<span id="cb18-39"><a href="#cb18-39" tabindex="-1"></a>             <span class="fu">c</span>(<span class="fu">length</span>(spliced.cell.prob), <span class="fu">length</span>(unspliced.cell.prob)))</span>
<span id="cb18-40"><a href="#cb18-40" tabindex="-1"></a>)</span>
<span id="cb18-41"><a href="#cb18-41" tabindex="-1"></a></span>
<span id="cb18-42"><a href="#cb18-42" tabindex="-1"></a><span class="co"># Create the density plot</span></span>
<span id="cb18-43"><a href="#cb18-43" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> Probability, <span class="at">fill =</span> Type)) <span class="sc">+</span></span>
<span id="cb18-44"><a href="#cb18-44" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb18-45"><a href="#cb18-45" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Density Plot of Methylation Probabilities&quot;</span>,</span>
<span id="cb18-46"><a href="#cb18-46" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Methylation Probability&quot;</span>,</span>
<span id="cb18-47"><a href="#cb18-47" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-48"><a href="#cb18-48" tabindex="-1"></a>  <span class="fu">theme_grey</span>()<span class="sc">+</span></span>
<span id="cb18-49"><a href="#cb18-49" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb18-50"><a href="#cb18-50" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb18-51"><a href="#cb18-51" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.7</span>),</span>
<span id="cb18-52"><a href="#cb18-52" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_blank</span>())<span class="sc">+</span><span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="regulatory-mechanisms" class="section level3">
<h3>Regulatory mechanisms</h3>
<div id="finding-sites-where-methylation-levels-are-high-in-pre-mrna-but-low-in-spliced-mrna-as-well-as-sites-where-methylation-levels-are-high-in-spliced-mrna-but-low-in-pre-mrna." class="section level4">
<h4>Finding sites where methylation levels are high in pre-mRNA but low
in spliced mRNA, as well as sites where methylation levels are high in
spliced mRNA but low in pre-mRNA.</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">library</span>(TxDb.Mmusculus.UCSC.mm39.knownGene)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">library</span>(MetaTX)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>res_preprocess <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/pre_process/res_preprocess.rds&quot;</span>)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>spliced_methylation_M_value_meta <span class="ot">&lt;-</span> res_preprocess<span class="sc">$</span>spliced_methylation_M_value_meta</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>unspliced_methylation_M_value_meta <span class="ot">&lt;-</span> res_preprocess<span class="sc">$</span>unspliced_methylation_M_value_meta</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>index_pre_high_spliced_low <span class="ot">&lt;-</span> <span class="fu">which</span>(unspliced_methylation_M_value_meta<span class="sc">-</span>spliced_methylation_M_value_meta<span class="sc">&gt;=</span><span class="dv">1</span>)</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>index_spliced_high_pre_low <span class="ot">&lt;-</span> <span class="fu">which</span>(spliced_methylation_M_value_meta<span class="sc">-</span>unspliced_methylation_M_value_meta<span class="sc">&gt;=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="metatx-plot" class="section level4">
<h4>metaTX plot</h4>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>intersect_pre_dominate <span class="ot">&lt;-</span>index_pre_high_spliced_low</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>intersect_spliced_dominate <span class="ot">&lt;-</span>index_spliced_high_pre_low</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>reads_counts_isoform <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/pre_process/reads_counts_isoform.rds&quot;</span>)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>reads_counts_pre <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/pre_process/reads_counts_pre.rds&quot;</span>)</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>reads_counts_spliced <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/pre_process/reads_counts_spliced.rds&quot;</span>)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>reads_counts_meth <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(reads_counts_isoform,<span class="cf">function</span>(x)x[[<span class="st">&quot;methylated_reads&quot;</span>]]))<span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(reads_counts_pre,<span class="cf">function</span>(x)x[[<span class="st">&quot;methylated_reads&quot;</span>]]))<span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(reads_counts_spliced,<span class="cf">function</span>(x)x[[<span class="st">&quot;methylated_reads&quot;</span>]]))</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>reads_counts_unmeth <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(reads_counts_isoform,<span class="cf">function</span>(x)x[[<span class="st">&quot;unmethylated_reads&quot;</span>]]))<span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(reads_counts_pre,<span class="cf">function</span>(x)x[[<span class="st">&quot;unmethylated_reads&quot;</span>]]))<span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(reads_counts_spliced,<span class="cf">function</span>(x)x[[<span class="st">&quot;unmethylated_reads&quot;</span>]]))</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>reads_counts_M_overall <span class="ot">&lt;-</span> ((<span class="fu">rowSums</span>(reads_counts_meth)<span class="sc">+</span><span class="fl">1e-7</span>)<span class="sc">/</span>(<span class="fu">rowSums</span>(reads_counts_unmeth)<span class="sc">+</span><span class="fu">rowSums</span>(reads_counts_meth)<span class="sc">+</span><span class="fl">1e-7</span>))</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>index_not_dominate <span class="ot">&lt;-</span> <span class="fu">order</span>(reads_counts_M_overall,<span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>]</span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a><span class="co"># metaTX</span></span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a></span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a>SNP_all <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/origin/SNP_all.rds&quot;</span>)</span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a>SNP_1931 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/pre_process/SNP_1931.rds&quot;</span>)</span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a>txdb <span class="ot">&lt;-</span> TxDb.Mmusculus.UCSC.mm39.knownGene</span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a></span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a></span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a>SNP_intersect_pre_dominate <span class="ot">&lt;-</span> SNP_1931[intersect_pre_dominate]</span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a>SNP_intersect_spliced_dominate <span class="ot">&lt;-</span> SNP_1931[intersect_spliced_dominate]</span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a>SNP_intersect_not_dominate <span class="ot">&lt;-</span> SNP_all[index_not_dominate]</span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a>SNP_background <span class="ot">&lt;-</span> SNP_1931</span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a></span>
<span id="cb20-33"><a href="#cb20-33" tabindex="-1"></a>SNP_to_exclude <span class="ot">&lt;-</span> <span class="fu">c</span>(SNP_intersect_pre_dominate, SNP_intersect_spliced_dominate)</span>
<span id="cb20-34"><a href="#cb20-34" tabindex="-1"></a></span>
<span id="cb20-35"><a href="#cb20-35" tabindex="-1"></a><span class="fu">library</span>(GenomicRanges)</span>
<span id="cb20-36"><a href="#cb20-36" tabindex="-1"></a>hits <span class="ot">&lt;-</span> <span class="fu">findOverlaps</span>(SNP_intersect_not_dominate, SNP_to_exclude)</span>
<span id="cb20-37"><a href="#cb20-37" tabindex="-1"></a></span>
<span id="cb20-38"><a href="#cb20-38" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(hits)<span class="sc">!=</span><span class="dv">0</span>){</span>
<span id="cb20-39"><a href="#cb20-39" tabindex="-1"></a>  SNP_intersect_not_dominate<span class="ot">&lt;-</span> SNP_intersect_not_dominate[<span class="sc">-</span><span class="fu">queryHits</span>(hits)]</span>
<span id="cb20-40"><a href="#cb20-40" tabindex="-1"></a>}</span>
<span id="cb20-41"><a href="#cb20-41" tabindex="-1"></a></span>
<span id="cb20-42"><a href="#cb20-42" tabindex="-1"></a>remap_results_pre_dominate <span class="ot">&lt;-</span> <span class="fu">remapCoord</span>(<span class="at">features =</span> SNP_1931[intersect_pre_dominate], <span class="at">txdb =</span> txdb)</span>
<span id="cb20-43"><a href="#cb20-43" tabindex="-1"></a>remap_results_spliced_dominate <span class="ot">&lt;-</span> <span class="fu">remapCoord</span>(<span class="at">features =</span> SNP_1931[intersect_spliced_dominate], <span class="at">txdb =</span> txdb)</span>
<span id="cb20-44"><a href="#cb20-44" tabindex="-1"></a>remap_results_not_dominate <span class="ot">&lt;-</span> <span class="fu">remapCoord</span>(<span class="at">features =</span> SNP_intersect_not_dominate, <span class="at">txdb =</span> txdb)</span>
<span id="cb20-45"><a href="#cb20-45" tabindex="-1"></a>remap_results_background <span class="ot">&lt;-</span> <span class="fu">remapCoord</span>(<span class="at">features =</span> SNP_background, <span class="at">txdb =</span> txdb)</span>
<span id="cb20-46"><a href="#cb20-46" tabindex="-1"></a></span>
<span id="cb20-47"><a href="#cb20-47" tabindex="-1"></a></span>
<span id="cb20-48"><a href="#cb20-48" tabindex="-1"></a><span class="co"># Step 2: Create plots for each subset</span></span>
<span id="cb20-49"><a href="#cb20-49" tabindex="-1"></a>plot_pre_dominate <span class="ot">&lt;-</span> <span class="fu">directPlot</span>(remap_results_pre_dominate)</span>
<span id="cb20-50"><a href="#cb20-50" tabindex="-1"></a>plot_spliced_dominate <span class="ot">&lt;-</span> <span class="fu">directPlot</span>(remap_results_spliced_dominate)</span>
<span id="cb20-51"><a href="#cb20-51" tabindex="-1"></a>plot_not_dominate <span class="ot">&lt;-</span> <span class="fu">directPlot</span>(remap_results_not_dominate)</span>
<span id="cb20-52"><a href="#cb20-52" tabindex="-1"></a>plot_background <span class="ot">&lt;-</span> <span class="fu">directPlot</span>(remap_results_background)</span>
<span id="cb20-53"><a href="#cb20-53" tabindex="-1"></a></span>
<span id="cb20-54"><a href="#cb20-54" tabindex="-1"></a>data_a <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(plot_pre_dominate)<span class="sc">$</span>data[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Group =</span> <span class="st">&quot;Precursor&quot;</span>)</span>
<span id="cb20-55"><a href="#cb20-55" tabindex="-1"></a>data_b <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(plot_spliced_dominate)<span class="sc">$</span>data[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Group =</span> <span class="st">&quot;Mature&quot;</span>)</span>
<span id="cb20-56"><a href="#cb20-56" tabindex="-1"></a>data_c <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(plot_not_dominate)<span class="sc">$</span>data[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Group =</span> <span class="st">&quot;Other&quot;</span>)</span>
<span id="cb20-57"><a href="#cb20-57" tabindex="-1"></a>data_d <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(plot_background)<span class="sc">$</span>data[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Group =</span> <span class="st">&quot;Real&quot;</span>)</span>
<span id="cb20-58"><a href="#cb20-58" tabindex="-1"></a></span>
<span id="cb20-59"><a href="#cb20-59" tabindex="-1"></a><span class="co"># Combine all datasets</span></span>
<span id="cb20-60"><a href="#cb20-60" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(data_a, data_b, data_c, data_d)<span class="co">#, data_intersect)</span></span>
<span id="cb20-61"><a href="#cb20-61" tabindex="-1"></a></span>
<span id="cb20-62"><a href="#cb20-62" tabindex="-1"></a>region_rects <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-63"><a href="#cb20-63" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>),  <span class="co"># Start positions of each region</span></span>
<span id="cb20-64"><a href="#cb20-64" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>),  <span class="co"># End positions of each region</span></span>
<span id="cb20-65"><a href="#cb20-65" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="fu">min</span>(combined_data<span class="sc">$</span>y, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fl">0.1</span>,  <span class="co"># Adjust below data range</span></span>
<span id="cb20-66"><a href="#cb20-66" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="fu">min</span>(combined_data<span class="sc">$</span>y, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fl">0.05</span>, <span class="co"># Slightly higher to make room</span></span>
<span id="cb20-67"><a href="#cb20-67" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">c</span>(<span class="st">&quot;5&#39; UTR&quot;</span>, <span class="st">&quot;CDS&quot;</span>, <span class="st">&quot;3&#39; UTR&quot;</span>)</span>
<span id="cb20-68"><a href="#cb20-68" tabindex="-1"></a>)</span>
<span id="cb20-69"><a href="#cb20-69" tabindex="-1"></a></span>
<span id="cb20-70"><a href="#cb20-70" tabindex="-1"></a><span class="co"># Calculate the height of 5&#39; UTR and 3&#39; UTR regions</span></span>
<span id="cb20-71"><a href="#cb20-71" tabindex="-1"></a>utr_height <span class="ot">&lt;-</span> region_rects<span class="sc">$</span>ymax[region_rects<span class="sc">$</span>Region <span class="sc">==</span> <span class="st">&quot;5&#39; UTR&quot;</span>] <span class="sc">-</span> region_rects<span class="sc">$</span>ymin[region_rects<span class="sc">$</span>Region <span class="sc">==</span> <span class="st">&quot;5&#39; UTR&quot;</span>]</span>
<span id="cb20-72"><a href="#cb20-72" tabindex="-1"></a></span>
<span id="cb20-73"><a href="#cb20-73" tabindex="-1"></a><span class="co"># Increase the height of CDS region by 20% (can be adjusted as needed)</span></span>
<span id="cb20-74"><a href="#cb20-74" tabindex="-1"></a>cds_height <span class="ot">&lt;-</span> utr_height <span class="sc">*</span> <span class="dv">2</span> <span class="co"># Increase height by 30%</span></span>
<span id="cb20-75"><a href="#cb20-75" tabindex="-1"></a></span>
<span id="cb20-76"><a href="#cb20-76" tabindex="-1"></a><span class="co"># Set ymin and ymax for CDS so that it is centered with respect to 5&#39; UTR and 3&#39; UTR</span></span>
<span id="cb20-77"><a href="#cb20-77" tabindex="-1"></a>region_rects<span class="sc">$</span>ymin[region_rects<span class="sc">$</span>Region <span class="sc">==</span> <span class="st">&quot;CDS&quot;</span>] <span class="ot">&lt;-</span> region_rects<span class="sc">$</span>ymin[region_rects<span class="sc">$</span>Region <span class="sc">==</span> <span class="st">&quot;CDS&quot;</span>] <span class="sc">-</span> <span class="fl">0.5</span><span class="sc">*</span>utr_height  <span class="co"># Decrease ymin for CDS</span></span>
<span id="cb20-78"><a href="#cb20-78" tabindex="-1"></a>region_rects<span class="sc">$</span>ymax[region_rects<span class="sc">$</span>Region <span class="sc">==</span> <span class="st">&quot;CDS&quot;</span>] <span class="ot">&lt;-</span> region_rects<span class="sc">$</span>ymin[region_rects<span class="sc">$</span>Region <span class="sc">==</span> <span class="st">&quot;CDS&quot;</span>] <span class="sc">+</span> cds_height  <span class="co"># Increase ymax for CDS</span></span>
<span id="cb20-79"><a href="#cb20-79" tabindex="-1"></a></span>
<span id="cb20-80"><a href="#cb20-80" tabindex="-1"></a></span>
<span id="cb20-81"><a href="#cb20-81" tabindex="-1"></a>compare_metaTX_plot <span class="ot">&lt;-</span><span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> Group))<span class="sc">+</span></span>
<span id="cb20-82"><a href="#cb20-82" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb20-83"><a href="#cb20-83" tabindex="-1"></a>    <span class="co"># Add region highlights using geom_rect, with consistent positioning across all facets</span></span>
<span id="cb20-84"><a href="#cb20-84" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="at">data =</span> region_rects, <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax, <span class="at">fill =</span> Region),</span>
<span id="cb20-85"><a href="#cb20-85" tabindex="-1"></a>              <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, </span>
<span id="cb20-86"><a href="#cb20-86" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Default linewidth for all regions</span></span>
<span id="cb20-87"><a href="#cb20-87" tabindex="-1"></a>    <span class="co"># Set fill for CDS region to grey (lighter than black)</span></span>
<span id="cb20-88"><a href="#cb20-88" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">subset</span>(region_rects, Region <span class="sc">==</span> <span class="st">&quot;CDS&quot;</span>), <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax),</span>
<span id="cb20-89"><a href="#cb20-89" tabindex="-1"></a>              <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Grey fill for CDS</span></span>
<span id="cb20-90"><a href="#cb20-90" tabindex="-1"></a>    <span class="co"># Adjust 5&#39; UTR and 3&#39; UTR fills to a very dark grey, closer to black</span></span>
<span id="cb20-91"><a href="#cb20-91" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="at">data =</span> <span class="fu">subset</span>(region_rects, Region <span class="sc">!=</span> <span class="st">&quot;CDS&quot;</span>), <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax,</span>
<span id="cb20-92"><a href="#cb20-92" tabindex="-1"></a>                                                                <span class="at">fill =</span> <span class="fu">factor</span>(Region, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;5&#39; UTR&quot;</span>, <span class="st">&quot;3&#39; UTR&quot;</span>))), </span>
<span id="cb20-93"><a href="#cb20-93" tabindex="-1"></a>              <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb20-94"><a href="#cb20-94" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;5&#39; UTR&quot;</span> <span class="ot">=</span> <span class="fu">grey</span>(<span class="fl">0.15</span>),  <span class="co"># Very dark grey for 5&#39; UTR, closer to black</span></span>
<span id="cb20-95"><a href="#cb20-95" tabindex="-1"></a>                                <span class="st">&quot;CDS&quot;</span> <span class="ot">=</span> <span class="st">&quot;grey&quot;</span>,           <span class="co"># Grey for CDS</span></span>
<span id="cb20-96"><a href="#cb20-96" tabindex="-1"></a>                                <span class="st">&quot;3&#39; UTR&quot;</span> <span class="ot">=</span> <span class="fu">grey</span>(<span class="fl">0.15</span>))) <span class="sc">+</span>  <span class="co"># Very dark grey for 3&#39; UTR</span></span>
<span id="cb20-97"><a href="#cb20-97" tabindex="-1"></a>    <span class="co"># Adjust y position for the text annotations to place them above the rectangles</span></span>
<span id="cb20-98"><a href="#cb20-98" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> region_rects, <span class="fu">aes</span>(<span class="at">x =</span> (xmin <span class="sc">+</span> xmax) <span class="sc">/</span> <span class="dv">2</span>, <span class="at">y =</span> ymax <span class="sc">-</span> <span class="fl">0.5</span>, <span class="at">label =</span> Region),</span>
<span id="cb20-99"><a href="#cb20-99" tabindex="-1"></a>              <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-100"><a href="#cb20-100" tabindex="-1"></a>    <span class="co"># Remove Region fill legend</span></span>
<span id="cb20-101"><a href="#cb20-101" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span><span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb20-102"><a href="#cb20-102" tabindex="-1"></a>  <span class="st">&quot;Other&quot;</span> <span class="ot">=</span> <span class="st">&quot;#00ba38&quot;</span>,      </span>
<span id="cb20-103"><a href="#cb20-103" tabindex="-1"></a>  <span class="st">&quot;Mature&quot;</span> <span class="ot">=</span> <span class="st">&quot;#619cff&quot;</span>,     </span>
<span id="cb20-104"><a href="#cb20-104" tabindex="-1"></a>  <span class="st">&quot;Precursor&quot;</span> <span class="ot">=</span> <span class="st">&quot;#F8766d&quot;</span> ,</span>
<span id="cb20-105"><a href="#cb20-105" tabindex="-1"></a>  <span class="st">&quot;Real&quot;</span> <span class="ot">=</span> <span class="st">&quot;#4D4D4D&quot;</span>  </span>
<span id="cb20-106"><a href="#cb20-106" tabindex="-1"></a>),<span class="at">name =</span> <span class="st">&quot;Higher on&quot;</span>)<span class="sc">+</span><span class="fu">theme_grey</span>()<span class="sc">+</span></span>
<span id="cb20-107"><a href="#cb20-107" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb20-108"><a href="#cb20-108" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.7</span>) ,<span class="at">legend.background =</span> <span class="fu">element_blank</span>() )<span class="sc">+</span><span class="fu">xlab</span>(<span class="cn">NULL</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="cn">NULL</span>)</span>
<span id="cb20-109"><a href="#cb20-109" tabindex="-1"></a></span>
<span id="cb20-110"><a href="#cb20-110" tabindex="-1"></a>compare_metaTX_plot</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="find-the-index-of-site-only-detect-methylated-reads-in-spliced-or-pre-mrna" class="section level4">
<h4>find the index of site only detect methylated reads in spliced or
pre mRNA</h4>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>index_meth_only_detect_pre <span class="ot">&lt;-</span>  <span class="fu">which</span>(res_preprocess[[<span class="st">&quot;vg.test&quot;</span>]] <span class="sc">%in%</span> res_preprocess[[<span class="st">&quot;index&quot;</span>]][[<span class="st">&quot;methylation only occurs at unspliced RNA&quot;</span>]])</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>index_meth_only_detect_spliced <span class="ot">&lt;-</span>  <span class="fu">which</span>(res_preprocess[[<span class="st">&quot;vg.test&quot;</span>]] <span class="sc">%in%</span>res_preprocess[[<span class="st">&quot;index&quot;</span>]][[<span class="st">&quot;methylation only occurs at spliced RNA&quot;</span>]])</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co"># only detect at spliced</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>index_meth_only_detect_spliced_int <span class="ot">&lt;-</span>  <span class="fu">intersect</span>(index_meth_only_detect_spliced,intersect_spliced_dominate)</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>SNP_1931[index_meth_only_detect_spliced_int]</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co">#&gt; GRanges object with 428 ranges and 6 metadata columns:</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt;         seqnames    ranges strand |         ref         alt   quality</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co">#&gt;            &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt; &lt;numeric&gt;</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co">#&gt;     [1]     chr2   3305880      + |           A           G   7.30814</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="co">#&gt;     [2]    chr13  86193008      + |           T           C  62.00000</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="co">#&gt;     [3]    chr13  92668203      + |           A           G  36.41540</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="co">#&gt;     [4]    chr18  63804710      + |           T           C 139.00000</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="co">#&gt;     [5]     chr5 135904577      + |           A           G  51.00000</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="co">#&gt;     ...      ...       ...    ... .         ...         ...       ...</span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a><span class="co">#&gt;   [424]    chr17  26486202      + |           A           G  19.46360</span></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a><span class="co">#&gt;   [425]     chr4 152416756      + |           A           G  56.00000</span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a><span class="co">#&gt;   [426]    chr19  57369826      + |           A           G  57.00000</span></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a><span class="co">#&gt;   [427]     chr2  84876608      + |           A           G  58.00000</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a><span class="co">#&gt;   [428]     chr2 179900230      + |           A           G   7.30814</span></span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a><span class="co">#&gt;                           info transcript_overlapped transcript_strand</span></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a><span class="co">#&gt;                    &lt;character&gt;           &lt;character&gt;       &lt;character&gt;</span></span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a><span class="co">#&gt;     [1] DP=2;VDB=0.02;SGB=-0.. ENSMUST00000081932.13                 +</span></span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a><span class="co">#&gt;     [2] DP=14;VDB=2.26006e-0..  ENSMUST00000078764.9                 -</span></span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a><span class="co">#&gt;     [3] DP=38;VDB=7.99768e-0..  ENSMUST00000246744.1                 +</span></span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a><span class="co">#&gt;     [4] DP=253;VDB=0;SGB=-0...  ENSMUST00000237004.2                 -</span></span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a><span class="co">#&gt;     [5] DP=10;VDB=9.5542e-05..  ENSMUST00001239528.1                 +</span></span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a><span class="co">#&gt;     ...                    ...                   ...               ...</span></span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a><span class="co">#&gt;   [424] DP=3;VDB=0.0221621;S.. ENSMUST00000025023.15                 +</span></span>
<span id="cb21-31"><a href="#cb21-31" tabindex="-1"></a><span class="co">#&gt;   [425] DP=9;VDB=5.52906e-06..  ENSMUST00000142735.8                 +</span></span>
<span id="cb21-32"><a href="#cb21-32" tabindex="-1"></a><span class="co">#&gt;   [426] DP=33;VDB=3.75937e-2..  ENSMUST00000036407.6                 +</span></span>
<span id="cb21-33"><a href="#cb21-33" tabindex="-1"></a><span class="co">#&gt;   [427] DP=10;VDB=6.99472e-0.. ENSMUST00000077798.13                 +</span></span>
<span id="cb21-34"><a href="#cb21-34" tabindex="-1"></a><span class="co">#&gt;   [428] DP=3;VDB=0.02;SGB=-0..  ENSMUST00000059080.7                 +</span></span>
<span id="cb21-35"><a href="#cb21-35" tabindex="-1"></a><span class="co">#&gt;   -------</span></span>
<span id="cb21-36"><a href="#cb21-36" tabindex="-1"></a><span class="co">#&gt;   seqinfo: 22 sequences from an unspecified genome; no seqlengths</span></span>
<span id="cb21-37"><a href="#cb21-37" tabindex="-1"></a></span>
<span id="cb21-38"><a href="#cb21-38" tabindex="-1"></a></span>
<span id="cb21-39"><a href="#cb21-39" tabindex="-1"></a></span>
<span id="cb21-40"><a href="#cb21-40" tabindex="-1"></a><span class="fu">library</span>(biomaRt)</span>
<span id="cb21-41"><a href="#cb21-41" tabindex="-1"></a></span>
<span id="cb21-42"><a href="#cb21-42" tabindex="-1"></a><span class="co"># Ensembl (Mouse)</span></span>
<span id="cb21-43"><a href="#cb21-43" tabindex="-1"></a>ensembl <span class="ot">&lt;-</span> <span class="fu">useEnsembl</span>(<span class="at">biomart =</span> <span class="st">&quot;genes&quot;</span>, <span class="at">dataset =</span> <span class="st">&quot;mmusculus_gene_ensembl&quot;</span>)</span>
<span id="cb21-44"><a href="#cb21-44" tabindex="-1"></a></span>
<span id="cb21-45"><a href="#cb21-45" tabindex="-1"></a><span class="co"># ENST </span></span>
<span id="cb21-46"><a href="#cb21-46" tabindex="-1"></a>transcript_ids <span class="ot">&lt;-</span> SNP_1931[index_meth_only_detect_spliced_int]<span class="sc">$</span>transcript_overlapped</span>
<span id="cb21-47"><a href="#cb21-47" tabindex="-1"></a></span>
<span id="cb21-48"><a href="#cb21-48" tabindex="-1"></a><span class="co"># clean</span></span>
<span id="cb21-49"><a href="#cb21-49" tabindex="-1"></a>transcript_ids_clean <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">..*&quot;</span>, <span class="st">&quot;&quot;</span>, transcript_ids)</span>
<span id="cb21-50"><a href="#cb21-50" tabindex="-1"></a></span>
<span id="cb21-51"><a href="#cb21-51" tabindex="-1"></a><span class="co"># find</span></span>
<span id="cb21-52"><a href="#cb21-52" tabindex="-1"></a>transcript_info <span class="ot">&lt;-</span> <span class="fu">getBM</span>(</span>
<span id="cb21-53"><a href="#cb21-53" tabindex="-1"></a>  <span class="at">attributes =</span> <span class="fu">c</span>(<span class="st">&quot;ensembl_transcript_id&quot;</span>, <span class="st">&quot;ensembl_gene_id&quot;</span>, <span class="st">&quot;external_gene_name&quot;</span>, </span>
<span id="cb21-54"><a href="#cb21-54" tabindex="-1"></a>                 <span class="st">&quot;chromosome_name&quot;</span>, <span class="st">&quot;start_position&quot;</span>, <span class="st">&quot;end_position&quot;</span>, <span class="st">&quot;strand&quot;</span>),</span>
<span id="cb21-55"><a href="#cb21-55" tabindex="-1"></a>  <span class="at">filters =</span> <span class="st">&quot;ensembl_transcript_id&quot;</span>,</span>
<span id="cb21-56"><a href="#cb21-56" tabindex="-1"></a>  <span class="at">values =</span> transcript_ids_clean,</span>
<span id="cb21-57"><a href="#cb21-57" tabindex="-1"></a>  <span class="at">mart =</span> ensembl</span>
<span id="cb21-58"><a href="#cb21-58" tabindex="-1"></a>)</span>
<span id="cb21-59"><a href="#cb21-59" tabindex="-1"></a></span>
<span id="cb21-60"><a href="#cb21-60" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">match</span>(transcript_ids_clean, transcript_info<span class="sc">$</span>ensembl_transcript_id)</span>
<span id="cb21-61"><a href="#cb21-61" tabindex="-1"></a>transcript_info_ordered <span class="ot">&lt;-</span> transcript_info[idx, ]</span>
<span id="cb21-62"><a href="#cb21-62" tabindex="-1"></a>transcript_info_ordered <span class="ot">&lt;-</span>transcript_info_ordered [,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">7</span>)]</span>
<span id="cb21-63"><a href="#cb21-63" tabindex="-1"></a>transcript_info_ordered<span class="sc">$</span>position <span class="ot">&lt;-</span> SNP_1931[index_meth_only_detect_spliced_int]<span class="sc">@</span>ranges<span class="sc">@</span>start</span>
<span id="cb21-64"><a href="#cb21-64" tabindex="-1"></a>transcript_info_ordered<span class="sc">$</span>position <span class="ot">&lt;-</span> transcript_info_ordered<span class="sc">$</span>position<span class="sc">-</span>transcript_info_ordered<span class="sc">$</span>strand</span>
<span id="cb21-65"><a href="#cb21-65" tabindex="-1"></a></span>
<span id="cb21-66"><a href="#cb21-66" tabindex="-1"></a></span>
<span id="cb21-67"><a href="#cb21-67" tabindex="-1"></a>transcript_info_ordered<span class="sc">$</span>meta_M <span class="ot">&lt;-</span> </span>
<span id="cb21-68"><a href="#cb21-68" tabindex="-1"></a>spliced_methylation_M_value_meta[index_meth_only_detect_spliced_int]<span class="sc">-</span>unspliced_methylation_M_value_meta[index_meth_only_detect_spliced_int]</span>
<span id="cb21-69"><a href="#cb21-69" tabindex="-1"></a></span>
<span id="cb21-70"><a href="#cb21-70" tabindex="-1"></a>transcript_info_ordered_spliced <span class="ot">&lt;-</span>transcript_info_ordered</span>
<span id="cb21-71"><a href="#cb21-71" tabindex="-1"></a></span>
<span id="cb21-72"><a href="#cb21-72" tabindex="-1"></a><span class="co"># only detect at pre</span></span>
<span id="cb21-73"><a href="#cb21-73" tabindex="-1"></a>index_meth_only_detect_pre_int <span class="ot">&lt;-</span> <span class="fu">intersect</span>(index_meth_only_detect_pre,intersect_pre_dominate)</span>
<span id="cb21-74"><a href="#cb21-74" tabindex="-1"></a>SNP_1931[index_meth_only_detect_pre_int]</span>
<span id="cb21-75"><a href="#cb21-75" tabindex="-1"></a><span class="co">#&gt; GRanges object with 81 ranges and 6 metadata columns:</span></span>
<span id="cb21-76"><a href="#cb21-76" tabindex="-1"></a><span class="co">#&gt;        seqnames    ranges strand |         ref         alt   quality</span></span>
<span id="cb21-77"><a href="#cb21-77" tabindex="-1"></a><span class="co">#&gt;           &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt; &lt;numeric&gt;</span></span>
<span id="cb21-78"><a href="#cb21-78" tabindex="-1"></a><span class="co">#&gt;    [1]    chr13  41790848      + |           A           G  38.41500</span></span>
<span id="cb21-79"><a href="#cb21-79" tabindex="-1"></a><span class="co">#&gt;    [2]     chr9 123358529      + |           T           C  56.00000</span></span>
<span id="cb21-80"><a href="#cb21-80" tabindex="-1"></a><span class="co">#&gt;    [3]    chr12  69206299      + |           A           G   5.65054</span></span>
<span id="cb21-81"><a href="#cb21-81" tabindex="-1"></a><span class="co">#&gt;    [4]    chr14  79709901      + |           T           C  27.42220</span></span>
<span id="cb21-82"><a href="#cb21-82" tabindex="-1"></a><span class="co">#&gt;    [5]    chr10  54187361      + |           T           C  56.00000</span></span>
<span id="cb21-83"><a href="#cb21-83" tabindex="-1"></a><span class="co">#&gt;    ...      ...       ...    ... .         ...         ...       ...</span></span>
<span id="cb21-84"><a href="#cb21-84" tabindex="-1"></a><span class="co">#&gt;   [77]    chr14  66103985      + |           A           G  62.00000</span></span>
<span id="cb21-85"><a href="#cb21-85" tabindex="-1"></a><span class="co">#&gt;   [78]    chr11  80278664      + |           A           G  38.41500</span></span>
<span id="cb21-86"><a href="#cb21-86" tabindex="-1"></a><span class="co">#&gt;   [79]     chr9  78275380      + |           A           G  12.65660</span></span>
<span id="cb21-87"><a href="#cb21-87" tabindex="-1"></a><span class="co">#&gt;   [80]     chr7 101662831      + |           A           G  53.00000</span></span>
<span id="cb21-88"><a href="#cb21-88" tabindex="-1"></a><span class="co">#&gt;   [81]     chr2  32678448      + |           T           C   7.30814</span></span>
<span id="cb21-89"><a href="#cb21-89" tabindex="-1"></a><span class="co">#&gt;                          info transcript_overlapped transcript_strand</span></span>
<span id="cb21-90"><a href="#cb21-90" tabindex="-1"></a><span class="co">#&gt;                   &lt;character&gt;           &lt;character&gt;       &lt;character&gt;</span></span>
<span id="cb21-91"><a href="#cb21-91" tabindex="-1"></a><span class="co">#&gt;    [1] DP=5;VDB=0.00215942;..  ENSMUST00000129449.3                 +</span></span>
<span id="cb21-92"><a href="#cb21-92" tabindex="-1"></a><span class="co">#&gt;    [2] DP=42;VDB=7.12062e-2..  ENSMUST00000246416.1                 -</span></span>
<span id="cb21-93"><a href="#cb21-93" tabindex="-1"></a><span class="co">#&gt;    [3] DP=14;VDB=0.0058656;..  ENSMUST00000292750.1                 +</span></span>
<span id="cb21-94"><a href="#cb21-94" tabindex="-1"></a><span class="co">#&gt;    [4] DP=5;VDB=0.0058656;S..  ENSMUST00000022601.7                 -</span></span>
<span id="cb21-95"><a href="#cb21-95" tabindex="-1"></a><span class="co">#&gt;    [5] DP=10;VDB=2.63415e-0..  ENSMUST00000239711.1                 -</span></span>
<span id="cb21-96"><a href="#cb21-96" tabindex="-1"></a><span class="co">#&gt;    ...                    ...                   ...               ...</span></span>
<span id="cb21-97"><a href="#cb21-97" tabindex="-1"></a><span class="co">#&gt;   [77] DP=34;VDB=3.3258e-08..  ENSMUST00000022614.7                 +</span></span>
<span id="cb21-98"><a href="#cb21-98" tabindex="-1"></a><span class="co">#&gt;   [78] DP=5;VDB=0.00187095;..  ENSMUST00000165565.8                 +</span></span>
<span id="cb21-99"><a href="#cb21-99" tabindex="-1"></a><span class="co">#&gt;   [79] DP=3;VDB=0.0221621;S..  ENSMUST00000321650.1                 +</span></span>
<span id="cb21-100"><a href="#cb21-100" tabindex="-1"></a><span class="co">#&gt;   [80] DP=8;VDB=1.33331e-05.. ENSMUST00000084852.13                 +</span></span>
<span id="cb21-101"><a href="#cb21-101" tabindex="-1"></a><span class="co">#&gt;   [81] DP=168;VDB=0.02;SGB=.. ENSMUST00000050000.16                 -</span></span>
<span id="cb21-102"><a href="#cb21-102" tabindex="-1"></a><span class="co">#&gt;   -------</span></span>
<span id="cb21-103"><a href="#cb21-103" tabindex="-1"></a><span class="co">#&gt;   seqinfo: 22 sequences from an unspecified genome; no seqlengths</span></span>
<span id="cb21-104"><a href="#cb21-104" tabindex="-1"></a></span>
<span id="cb21-105"><a href="#cb21-105" tabindex="-1"></a></span>
<span id="cb21-106"><a href="#cb21-106" tabindex="-1"></a><span class="co"># ENST </span></span>
<span id="cb21-107"><a href="#cb21-107" tabindex="-1"></a>transcript_ids <span class="ot">&lt;-</span> SNP_1931[index_meth_only_detect_pre_int]<span class="sc">$</span>transcript_overlapped</span>
<span id="cb21-108"><a href="#cb21-108" tabindex="-1"></a></span>
<span id="cb21-109"><a href="#cb21-109" tabindex="-1"></a><span class="co"># clean</span></span>
<span id="cb21-110"><a href="#cb21-110" tabindex="-1"></a>transcript_ids_clean <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">..*&quot;</span>, <span class="st">&quot;&quot;</span>, transcript_ids)</span>
<span id="cb21-111"><a href="#cb21-111" tabindex="-1"></a></span>
<span id="cb21-112"><a href="#cb21-112" tabindex="-1"></a><span class="co"># find</span></span>
<span id="cb21-113"><a href="#cb21-113" tabindex="-1"></a>transcript_info <span class="ot">&lt;-</span> <span class="fu">getBM</span>(</span>
<span id="cb21-114"><a href="#cb21-114" tabindex="-1"></a>  <span class="at">attributes =</span> <span class="fu">c</span>(<span class="st">&quot;ensembl_transcript_id&quot;</span>, <span class="st">&quot;ensembl_gene_id&quot;</span>, <span class="st">&quot;external_gene_name&quot;</span>, </span>
<span id="cb21-115"><a href="#cb21-115" tabindex="-1"></a>                 <span class="st">&quot;chromosome_name&quot;</span>, <span class="st">&quot;start_position&quot;</span>, <span class="st">&quot;end_position&quot;</span>, <span class="st">&quot;strand&quot;</span>),</span>
<span id="cb21-116"><a href="#cb21-116" tabindex="-1"></a>  <span class="at">filters =</span> <span class="st">&quot;ensembl_transcript_id&quot;</span>,</span>
<span id="cb21-117"><a href="#cb21-117" tabindex="-1"></a>  <span class="at">values =</span> transcript_ids_clean,</span>
<span id="cb21-118"><a href="#cb21-118" tabindex="-1"></a>  <span class="at">mart =</span> ensembl</span>
<span id="cb21-119"><a href="#cb21-119" tabindex="-1"></a>)</span>
<span id="cb21-120"><a href="#cb21-120" tabindex="-1"></a></span>
<span id="cb21-121"><a href="#cb21-121" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">match</span>(transcript_ids_clean, transcript_info<span class="sc">$</span>ensembl_transcript_id)</span>
<span id="cb21-122"><a href="#cb21-122" tabindex="-1"></a>transcript_info_ordered <span class="ot">&lt;-</span> transcript_info[idx, ]</span>
<span id="cb21-123"><a href="#cb21-123" tabindex="-1"></a>transcript_info_ordered <span class="ot">&lt;-</span>transcript_info_ordered [,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">7</span>)]</span>
<span id="cb21-124"><a href="#cb21-124" tabindex="-1"></a>transcript_info_ordered<span class="sc">$</span>position <span class="ot">&lt;-</span> SNP_1931[index_meth_only_detect_pre_int]<span class="sc">@</span>ranges<span class="sc">@</span>start</span>
<span id="cb21-125"><a href="#cb21-125" tabindex="-1"></a>transcript_info_ordered<span class="sc">$</span>position <span class="ot">&lt;-</span> transcript_info_ordered<span class="sc">$</span>position<span class="sc">-</span>transcript_info_ordered<span class="sc">$</span>strand</span>
<span id="cb21-126"><a href="#cb21-126" tabindex="-1"></a></span>
<span id="cb21-127"><a href="#cb21-127" tabindex="-1"></a></span>
<span id="cb21-128"><a href="#cb21-128" tabindex="-1"></a>transcript_info_ordered<span class="sc">$</span>meta_M <span class="ot">&lt;-</span> </span>
<span id="cb21-129"><a href="#cb21-129" tabindex="-1"></a>unspliced_methylation_M_value_meta[index_meth_only_detect_pre_int]<span class="sc">-</span>spliced_methylation_M_value_meta[index_meth_only_detect_pre_int]</span>
<span id="cb21-130"><a href="#cb21-130" tabindex="-1"></a></span>
<span id="cb21-131"><a href="#cb21-131" tabindex="-1"></a>transcript_info_ordered_pre <span class="ot">&lt;-</span>transcript_info_ordered</span></code></pre></div>
</div>
</div>
</div>
<div id="run-velocity" class="section level2">
<h2>run velocity</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>res_preprocess <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/pre_process/res_preprocess.rds&quot;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="co"># the input data</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>test.list <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/pre_process/test.list.rds&quot;</span>)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>control.list <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/pre_process/control.list.rds&quot;</span>)</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>spliced.meth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">1</span>]]</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>spliced.unmeth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">2</span>]]</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>unspliced.meth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">3</span>]]</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>unspliced.unmeth.test <span class="ot">&lt;-</span> test.list[[<span class="dv">4</span>]]</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>kCells <span class="ot">=</span> <span class="dv">1</span>; deltaT <span class="ot">=</span><span class="dv">1</span>; kSites <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="fu">library</span>(VeloRM)</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="co"># calculate the emat_size and nmat_size</span></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a>emat_size <span class="ot">&lt;-</span> <span class="fu">colSums</span>(spliced.meth.test <span class="sc">+</span> spliced.unmeth.test)</span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a>nmat_size <span class="ot">&lt;-</span> <span class="fu">colSums</span>(unspliced.meth.test <span class="sc">+</span> unspliced.unmeth.test)</span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">methylation.site.relative.velocity.estimates</span>(res_preprocess<span class="sc">$</span>test, res_preprocess<span class="sc">$</span>control,</span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a>                                                    <span class="at">kCells =</span> kCells, <span class="at">deltaT =</span> deltaT, <span class="at">kSites =</span> kSites, </span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a>                                                    <span class="at">fit.quantile =</span> <span class="fl">0.05</span>, <span class="at">n.cores =</span> <span class="dv">1</span>, <span class="at">emat.size =</span> emat_size, </span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a>                                                    <span class="at">nmat.size =</span> nmat_size)</span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a><span class="co">#&gt; fitting gamma coefficients ... done. succesfful fit for 217 sites</span></span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a><span class="co">#&gt; filtered out 87 out of 217 sites due to low nmat-emat correlation</span></span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a><span class="co">#&gt; filtered out 37 out of 130 sites due to low nmat-emat slope</span></span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a><span class="co">#&gt; calculating RNA velocity shift ... calculating delta use model 2 ... done</span></span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a><span class="co">#&gt; calculating extrapolated cell state ... done</span></span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a><span class="co">#&gt; fitting gamma coefficients ... done. succesfful fit for 217 sites</span></span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a><span class="co">#&gt; filtered out 82 out of 217 sites due to low nmat-emat correlation</span></span>
<span id="cb22-31"><a href="#cb22-31" tabindex="-1"></a><span class="co">#&gt; filtered out 54 out of 135 sites due to low nmat-emat slope</span></span>
<span id="cb22-32"><a href="#cb22-32" tabindex="-1"></a><span class="co">#&gt; calculating RNA velocity shift ... calculating delta use model 2 ... done</span></span>
<span id="cb22-33"><a href="#cb22-33" tabindex="-1"></a><span class="co">#&gt; calculating extrapolated cell state ... done</span></span>
<span id="cb22-34"><a href="#cb22-34" tabindex="-1"></a><span class="co">#&gt; calculating P-value ... done</span></span>
<span id="cb22-35"><a href="#cb22-35" tabindex="-1"></a><span class="co">#&gt; calculating methylation level ... done</span></span>
<span id="cb22-36"><a href="#cb22-36" tabindex="-1"></a></span>
<span id="cb22-37"><a href="#cb22-37" tabindex="-1"></a><span class="fu">saveRDS</span>(res, <span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/results/res_A_to_I_velocity.rds&quot;</span>)</span></code></pre></div>
<div id="load-the-embedding" class="section level3">
<h3>load the embedding</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># 1. Read in the data</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>sra_table <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/origin/SraRunTable.csv&quot;</span>)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>embedding <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/origin/embedding.csv&quot;</span>, </span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>                      <span class="at">row.names =</span> <span class="dv">1</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>cell_to_SRR <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/origin/cell_to_SRR.csv&quot;</span>, </span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>                        <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co"># 2. Create a mapping from cell IDs to SRR IDs</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>cell_to_srr_dict <span class="ot">&lt;-</span> <span class="fu">setNames</span>(cell_to_SRR<span class="sc">$</span>names_SRR, cell_to_SRR<span class="sc">$</span>V1)</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="co"># 3. Replace the row names of the embedding matrix with corresponding SRR IDs</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="fu">rownames</span>(embedding) <span class="ot">&lt;-</span> cell_to_srr_dict[<span class="fu">rownames</span>(embedding)]</span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="co"># 4. Create a mapping from Run IDs to day of differentiation using the SRA table</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>run_to_day <span class="ot">&lt;-</span> <span class="fu">setNames</span>(sra_table<span class="sc">$</span>day_of_differentiation, sra_table<span class="sc">$</span>Run)</span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="co"># 5. Generate a vector of differentiation days corresponding to each column in spliced.meth.test</span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a>sample_days <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">colnames</span>(spliced.meth.test), <span class="cf">function</span>(x) {</span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a>  <span class="cf">if</span>(x <span class="sc">%in%</span> <span class="fu">names</span>(run_to_day)) {</span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a>    run_to_day[[x]]</span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a>    <span class="st">&#39;unknown&#39;</span>  <span class="co"># assign &#39;unknown&#39; if the column name does not exist in the mapping</span></span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a>  }</span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a>})</span></code></pre></div>
<div id="filter" class="section level4">
<h4>filter</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>SNP_1931 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;D:/data/VeloRM_data/RNA-Seq_A-to-I_2/pre_process/SNP_1931.rds&quot;</span>)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="fu">names</span>(SNP_1931) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(test.list[[<span class="dv">1</span>]])</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>spliced_methylation_Beta_value_meta_index <span class="ot">&lt;-</span> res_preprocess[[<span class="st">&quot;spliced_methylation_Beta_value_meta&quot;</span>]]</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>unspliced_methylation_Beta_value_meta_index <span class="ot">&lt;-</span>res_preprocess[[<span class="st">&quot;unspliced_methylation_Beta_value_meta&quot;</span>]]</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>Beta_not_1or0 <span class="ot">&lt;-</span> <span class="fu">apply</span>(res[[<span class="dv">3</span>]][[<span class="st">&quot;current&quot;</span>]]<span class="sc">$</span>Beta,<span class="dv">1</span>,<span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">which</span>(x<span class="sc">!=</span><span class="dv">0</span><span class="sc">&amp;</span>x<span class="sc">!=</span><span class="dv">1</span>)))</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>index_site_name_int_intersect <span class="ot">&lt;-</span>   <span class="fu">names</span>(<span class="fu">which</span>(Beta_not_1or0<span class="sc">&gt;=</span><span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="trajectory-beta" class="section level4">
<h4>trajectory Beta</h4>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(spliced.meth.test) <span class="sc">%in%</span> <span class="fu">intersect</span>(<span class="fu">colnames</span>(spliced.meth.test),<span class="fu">rownames</span>(embedding)))</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>umap_results <span class="ot">&lt;-</span> embedding[<span class="fu">rownames</span>(embedding)<span class="sc">%in%</span> <span class="fu">intersect</span>(<span class="fu">colnames</span>(spliced.meth.test),<span class="fu">rownames</span>(embedding)),]</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>umap_results <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(umap_results)</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>cell.colors <span class="ot">=</span> <span class="fu">as.factor</span>(sample_days[<span class="fu">rownames</span>(umap_results)])</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>umap_results<span class="sc">$</span>color <span class="ot">&lt;-</span> cell.colors</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>    <span class="at">data =</span> umap_results,</span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> umap_1, <span class="at">y =</span> umap_2, <span class="at">color =</span> color),</span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a>    <span class="at">size=</span><span class="dv">2</span></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;PC1&quot;</span>, <span class="at">y =</span> <span class="st">&quot;PC2&quot;</span>) <span class="sc">+</span>  <span class="co"># Change axis labels</span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_blank</span>()</span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#F28F8F&quot;</span>, <span class="st">&quot;#E6B84C&quot;</span>, <span class="st">&quot;#8BCF8C&quot;</span>, <span class="st">&quot;#6BAED6&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>arrow.scale<span class="ot">=</span><span class="fl">0.5</span>; cell.alpha<span class="ot">=</span><span class="fl">0.4</span>; cell.cex<span class="ot">=</span><span class="dv">1</span>; fig.height<span class="ot">=</span><span class="dv">4</span>;</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>vis_umap_Beta_emb_Beta_linear_index  <span class="ot">&lt;-</span> <span class="fu">show.velocity.on.embedding.cor</span>(umap_results[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>             res[[<span class="dv">3</span>]][[<span class="st">&quot;current&quot;</span>]]<span class="sc">$</span>Beta[index_site_name_int_intersect,index],</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>             res[[<span class="dv">3</span>]][[<span class="st">&quot;projected&quot;</span>]]<span class="sc">$</span>Beta[index_site_name_int_intersect,index],</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>             res[[<span class="dv">3</span>]][[<span class="st">&quot;delta&quot;</span>]]<span class="sc">$</span>Beta[index_site_name_int_intersect,index],</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>             <span class="at">cell.colors=</span>cell.colors,<span class="at">n=</span><span class="dv">50</span>,<span class="at">scale=</span><span class="st">&#39;linear&#39;</span>,</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>             <span class="at">cex=</span>cell.cex,<span class="at">arrow.scale=</span>arrow.scale,<span class="at">arrow.lwd=</span><span class="fl">0.5</span>,<span class="at">rm_uniform=</span><span class="st">&quot;mode1&quot;</span>)</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a><span class="co">#&gt; delta projections ... linear knn ... transition probs ... done</span></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a><span class="co">#&gt; calculating arrows ... done</span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>vis_umap_Beta_emb_Beta_linear_index[[<span class="dv">1</span>]]<span class="sc">$</span>layers[[<span class="dv">1</span>]]<span class="sc">$</span>aes_params<span class="sc">$</span>shape <span class="ot">&lt;-</span> <span class="dv">16</span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a>vis_umap_Beta_emb_Beta_linear_index[[<span class="dv">1</span>]]<span class="sc">$</span>mapping<span class="sc">$</span>color <span class="ot">&lt;-</span>cell.colors</span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a>vis_umap_Beta_emb_Beta_linear_index[[<span class="dv">1</span>]]<span class="sc">$</span>mapping<span class="sc">$</span>fill <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a>vis_umap_Beta_emb_Beta_linear_index[[<span class="dv">1</span>]]<span class="sc">+</span></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#F28F8F&quot;</span>, <span class="st">&quot;#E6B84C&quot;</span>, <span class="st">&quot;#8BCF8C&quot;</span>, <span class="st">&quot;#6BAED6&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>arrow.scale<span class="ot">=</span><span class="dv">1</span>; cell.alpha<span class="ot">=</span><span class="fl">0.4</span>; cell.cex<span class="ot">=</span><span class="dv">1</span>; fig.height<span class="ot">=</span><span class="dv">4</span>;</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>vis_umap_Beta_emb_Beta_linear_index_grid <span class="ot">&lt;-</span> <span class="fu">show.velocity.on.embedding.cor</span>(umap_results[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>             res[[<span class="dv">3</span>]][[<span class="st">&quot;current&quot;</span>]]<span class="sc">$</span>Beta[index_site_name_int_intersect,index],</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>             res[[<span class="dv">3</span>]][[<span class="st">&quot;projected&quot;</span>]]<span class="sc">$</span>Beta[index_site_name_int_intersect,index],</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>             res[[<span class="dv">3</span>]][[<span class="st">&quot;delta&quot;</span>]]<span class="sc">$</span>Beta[index_site_name_int_intersect,index],</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>             <span class="at">cell.colors=</span>cell.colors,<span class="at">n=</span><span class="dv">50</span>,<span class="at">scale=</span><span class="st">&#39;linear&#39;</span>,</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>             <span class="at">cex=</span>cell.cex,<span class="at">arrow.scale=</span>arrow.scale,<span class="at">arrow.lwd=</span><span class="fl">0.5</span>,<span class="at">show.grid.flow =</span> <span class="cn">TRUE</span>,<span class="at">grid.n =</span> <span class="dv">25</span>,<span class="at">rm_uniform=</span><span class="st">&quot;mode1&quot;</span>)</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a><span class="co">#&gt; delta projections ... linear knn ... transition probs ... done</span></span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a><span class="co">#&gt; calculating arrows ... done</span></span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a><span class="co">#&gt; grid estimates ... grid.sd= 0.5393528  min.arrow.size= 0.01078706  max.grid.arrow.length= 0.02107888  done</span></span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>vis_umap_Beta_emb_Beta_linear_index_grid[[<span class="dv">1</span>]]<span class="sc">$</span>layers[[<span class="dv">1</span>]]<span class="sc">$</span>aes_params<span class="sc">$</span>shape <span class="ot">&lt;-</span> <span class="dv">16</span></span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>vis_umap_Beta_emb_Beta_linear_index_grid[[<span class="dv">1</span>]]<span class="sc">$</span>mapping<span class="sc">$</span>color <span class="ot">&lt;-</span>cell.colors</span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a>vis_umap_Beta_emb_Beta_linear_index_grid[[<span class="dv">1</span>]]<span class="sc">$</span>mapping<span class="sc">$</span>fill <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>vis_umap_Beta_emb_Beta_linear_index_grid[[<span class="dv">1</span>]]<span class="sc">+</span></span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#F28F8F&quot;</span>, <span class="st">&quot;#E6B84C&quot;</span>, <span class="st">&quot;#8BCF8C&quot;</span>, <span class="st">&quot;#6BAED6&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="scvelo" class="section level2">
<h2>scVelo</h2>
<p>jupyter notebook is in figshare: <a href="https://doi.org/10.6084/m9.figshare.28955183" class="uri">https://doi.org/10.6084/m9.figshare.28955183</a> or <a href="https://github.com/whz991026/VeloRM" class="uri">https://github.com/whz991026/VeloRM</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
